Review,Predicted Label,Actual Label
nan,0,2
"FP733 - Filiale - Recouvrement ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
je suis payeur d’un contrat iRS résilié gestionnaire avec une dette|
|*QUAND*
cela fait 335 jours que mon contrat a été résilié|
|*ALORS*
je reçois un courriel pour m’avertir que mon contrat va passer en recouvrement dans 30 jours et à défaut d’une adresse mail sur ma fiche client, je reçois un courrier postal|
|{panel:bgColor=#deebff}
*Scénario 2 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
je suis payeur d’un contrat iRS résilié gestionnaire sans dette|
|*QUAND*
cela fait 335 jours que mon contrat a été résilié|
|*ALORS*
je ne reçois ni courriel ni courrier postal|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
je suis payeur d’un contrat iRS résilié gestionnaire avec dette|
|*QUAND*
cela fait 336 jours ou plus que mon contrat a été résilié|
|*ALORS*
je ne reçois ni courriel ni courrier postal|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
je suis payeur d’un contrat iRS résilié gestionnaire avec dette|
|*QUAND*
cela fait 334 jours ou moins que mon contrat a été résilié|
|*ALORS*
je ne reçois ni courriel ni courrier postal| {panel:bgColor=#e3fcef}
*Contexte* : 

Dans le cadre de la mise en place de la filiale, qui a pour vocation à reprendre la gestion de l’ensemble des services billettiques franciliens, il a été décidé de mettre en place le processus de « Recouvrement Forcé ». Il s’agit d’un nouvel état du contrat commercial qui intervient après l’état « Résilié gestionnaire » et sera mis en place au mois juin 2023.  

 Le passage en « Recouvrement Forcé » suit le passage d’un contrat en « Résilié Gestionnaire » en cas de la persistance de la dette due par le Payeur du contrat.
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

Envoyer un courriel au client payeur, 30 jours avant le passage en recouvrement forcé

A défaut, si le client payeur ne possède pas d’adresse mail, lui envoyer un courrier postal
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|Ref 1|Fonctionnelle|Envoyer un courriel à un client payeur d’un contrat iRS résilié gestionnaire avec une dette (identification des contrats identique au batch de recouvrement) depuis 335 jours|
|Ref 2|Fonctionnelle|Si le client payeur du contrat ne dispose pas d’une adresse mail ou si celle-ci n’est pas valide, lui envoyer un courrier postal|",0,2
nan,0,1
"FP875 - Sujet metier SIG 2023 S2 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE* je suis un utilisateur de l’IHMC,|
|*QUAND* je suis sur la page *IHMC-CON-320 - Suspendre un contrat commercial non reconduit*|
|*ALORS* chaque champ de formulaire doit avoir un “i” qui indique le format de saisie du champ|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*  je suis un utilisateur de l’IHMC,|
|*QUAND* je suis sur la page *IHMC-CON-105 - Saisir un contrat commercial*|
|*ALORS* le caractère obligatoire est indiqué sur les champs concernés par une “*”| {panel:bgColor=#e3fcef}
*Contexte* : Un audit a été réalisé sur l’IHMC concernant le respect des règlementations d’accessibilité RGAA et les conclusions de cet audit ont mis en évidence plusieurs axes d’amélioration pour faire progresser la note d’accessibilité du site.

L’une des évolutions recommandées concerne le contrôle de saisie dans les formulaire au niveau des pages web. En effet même si le caractère obligatoire est globalement respecté, les autres exigences complémentaires telles que la complexité du mot de passe, l’indication des formats attendus, du format textuel et des champs invalides, ne le sont pas. Une étude [https://comutitres.atlassian.net/browse/SIG-12952|https://comutitres.atlassian.net/browse/SIG-12952|smart-link] a été réalisée afin d'identifier au niveau des pages web les champs de saisie pour lesquelles les exigences complémentaires sur le contrôle de saisie au niveau de chaque formulaire de saisie ne sont pas utilisés de manière pertinente.
{panel}

{panel:bgColor=#deebff}
*Besoin* : En tant qu’utilisateur de l’IHMC, je souhaite que soient ajoutés des contrôles de saisie et des indications sur le type et le format des données sur les champs des formulaires.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|13329_001|Fonctionnelle|Pour chacune des pages de l’IHMC ci-dessous, il faut ajouter via une icone {color:#0747a6}*_i_*{color} une indication sur le format attendu sur les champs des formulaires pour lesquels le contrôle de saisie n’est pas présent et le format du champ n’est pas indiqué.|
|13329_002|Fonctionnelle|Pour chacune des pages de l’IHMC ci-dessous, il faut ajouter une balise {{<sig:obligatoire/>}} dans le label des champs de formulaire pour lesquels le caractère obligatoire n’est pas indiqué|

Pages IHMC concernées : 

|IHMC-CON-430- Enregistrer un rejet de virement|
|IHMC-CON-280 - Affecter un contrat tiers payant|
|IHMC-CON-300 - réévaluer subvention|
|IHMC-CON-320 - Suspendre un contrat commercial non reconduit|
|IHMC-CON-321 - Clôturer un contrat commercial|
|IHMC-CON-330 - Changer de payeur|
|IHMC-CON-335 - Changer de domiciliation bancaire|
|IHMC-CON-340 - Changer de mode de paiement|
|IHMC-CON-380 - Enregistrer une demande de remboursement|
|IHMC-CON-385 - Enregistrer un geste commercial|
|IHMC-CON-390 - Demander un remboursement|
|IHMC-CON-EV-140b - Modification de financement d'un contrat cadre|
|IHMC-IRE-CON-600 - Modifier l'établissement scolaire du contrat commercial|
|IHMC-IRS-CON-105 - Saisir contrat commercial|
|IHMC-CON-001 - Rechercher un contrat commercial|
|IHMC-CON-002 - Recherche avancée un contrat commercial|
|IHMC-CON-105 - Saisir un contrat commercial|
|IHMC-CON-405 - Saisie d'un paiement comptant|
|IHMC-CON-900 - Rechercher mandat SEPA|",0,2
"FP920 - Ma Mobilité 1.2 MVP ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Modification d’un client par WS*
{panel}|
|*ÉTANT DONNE QUE*
Je suis SEL|
|*QUAND*
Je modifie une fiche client avec des données ne correspondant pas {color:#00b8d9}-aux règles du CU CLI-010-{color}{color:#00b8d9} à l’exigence 001{color}|
|*ALORS*
Je suis informé des {color:#00b8d9}-motifs remontés par le SIG-{color}{color:#00b8d9} erreurs en entrée du WS.{color}| {panel:bgColor=#e3fcef}
*Contexte* : 

Le projet Ma Mobilité lot 1.2 concerne les adaptations des assets SIG et APP à la version R5 du SIS et de la brique Tap2Use permettant de gérer les comptes IDFM Connect, ce qui entraine des changements pour l’asset APP (qui doit discuter avec SIS et non plus IDFM Connect) ainsi que l’asset SIG car les règles de gestion concernant les données des clients appairés évoluent.

Une étude a été réalisée [https://comutitres.atlassian.net/wiki/spaces/EP/pages/2843804246/MC+SIG-11405+Macro-chiffrage+tude+MM1.2+MVP|https://comutitres.atlassian.net/wiki/spaces/EP/pages/2843804246/MC+SIG-11405+Macro-chiffrage+tude+MM1.2+MVP|smart-link] afin d’identifier les impacts APP et SIG liés au MVP. Un nettoyage des données clients (nom, prénom, civilité et mobile) est notamment nécessaire afin de véhiculer des données conformes dans le processus de synchronisation entre SIG et SIS, via APP et est traité dans la [https://comutitres.atlassian.net/browse/SIG-12029|https://comutitres.atlassian.net/browse/SIG-12029|smart-link] .

Suite à ce nettoyage, il est indispensable de sécuriser le SIG afin de ne plus permettre l’intégration de données non conformes : une première US [https://comutitres.atlassian.net/browse/SIG-12031|https://comutitres.atlassian.net/browse/SIG-12031|smart-link] a été réalisée dans ce sens, ainsi qu’une étude [https://comutitres.atlassian.net/browse/SIG-12496|https://comutitres.atlassian.net/browse/SIG-12496|smart-link] pour compléter.

Cette dernière étude a permis d’identifier 4 impacts : 

* Modification du [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1730418737|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1730418737|smart-link]
* Modification du [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762532220/BATCH-CON-920+-+Traitement+des+justificatifs+RIB-APA+multi+produit|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762532220/BATCH-CON-920+-+Traitement+des+justificatifs+RIB-APA+multi+produit|smart-link]
* Modification du [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1730419014/CLI-010+-+Modifier+les+donn+es+d+un+client|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1730419014/CLI-010+-+Modifier+les+donn+es+d+un+client|smart-link]
* Modification du WS [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1746144751/REST-API-CLI-130-V1+-+Modifier+un+client|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1746144751/REST-API-CLI-130-V1+-+Modifier+un+client|smart-link]

Cette US va traiter des évolutions nécessaires dans le REST-API-CLI-130.
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

*En tant que Service en ligne, je veux pouvoir traiter les motifs remontant du SIG afin d’adapter mes parcours.*

Le besoin consiste à ajouter une gestion des {color:#00b8d9}-motifs bloquants-{color}{color:#00b8d9} codes erreur {color}dans le REST-API-CLI-130.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* :{color:#00b8d9} N/A{color}
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|12933_001|Fonctionnel|Il est nécessaire d’ajouter la gestion des {color:#00b8d9}erreurs {color}{color:#00b8d9}-motifs bloquants remontés du CU CLI-010 dans le REST-API-CLI-130,-{color}{color:#00b8d9} {color}afin d’alimenter le code retour 400 - _Bad request_.
{color:#00b8d9}Pour tous les éléments suivants, s’ils sont renseignés : {color}
* {color:#00b8d9}socioProfessionalCategoryCode doit être numérique{color}
* {color:#00b8d9}mobilePhoneNumber doit être composé de 10 caractères numériques et commencer par “06” ou “07”{color}
* {color:#00b8d9}businessPhoneNumber doit être composé de 10 caractères numériques et commencer par “01”, “02”, “03”, “04”, “05”, “08” ou “09”{color}|
|12933_002|Fonctionnel|Prévoir l’utilisation du code 500 - _Internal server error_, en cas d’erreur remontée.|",0,1
nan,0,2
nan,0,1
"FP875 - Sujet metier SIG 2023 S2 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 3 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 4 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : 

Un client effectuant une demande de SAV (ex: changement de zone, suspension, reprise ou reprise sur contentieux, résiliation), en canal non face à face (ex : SEL ou téléphone), devra par la suite mettre à jour son passe pour finaliser sa demande en rechargeant le droit sur son passe.

Suite à la demande de SAV, un droit à l'état “A recharger” est alors créé et envoyé en liste verte puis mis à disposition sur les équipements de rechargement transporteurs, généralement dans les 48h après la demande. 

Une fois le passe mis à jour sur un équipement de rechargement transporteur, un fichier de rechargement est transmis depuis les transporteurs vers le SIG, habituellement le lendemain du rechargement. 

Ainsi, si jamais : 

* le client met à jour son passe et qu’avant l’intégration du fichier de rechargement dans le SIG 
* une opération vient altérer l'état du droit “à recharger” (ex : [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762532065/BATCH-PASSE-690+-+Annulation+automatique+des+droits+non+recharg+s|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762532065/BATCH-PASSE-690+-+Annulation+automatique+des+droits+non+recharg+s|smart-link], résiliation du contrat.. )

Alors l’intégration du rechargement du droit est rejetée par le SIG avec un message d’erreur dans le CR du type : 

* {{""Rechargement en échec : Aucun droit au transport à l'état à recharger n'a été trouvé pour le passe XXXX"". }}

Exemple : 

* !image-20231019-125652.png|width=1252,height=317!

Cette erreur génère une désynchronisation entre les données sur le passe du client et les données dans le SIG, ce qui peut avoir des impacts pour le client et d’un point de vue financier (exemple : prélèvement à tort, ou circulant gratuit). 
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

Nous souhaitons une étude pour trouver et évaluer une solution permettant d'éviter cette problématique, en permettant par exemple au SIG d'intégrer les rechargements de droit même si celui-ci n’est plus à l'état “à recharger”.    
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* :

N/A 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|001|Etude|Faire une étude pour déterminer le ou les US que nous allons devoir mettre en œuvre ainsi qu’un macro-chiffrage de ces tickets, permettant de résoudre cette problématique.|
|002|Etude|L’idée serait de permettre au SIG d'intégrer les rechargements de droit même si celui-ci n’est plus à l'état “à recharger”.
Toutefois, certains cas de rechargement ne devraient pas être intégrés. Par exemple : 
* Le client fait une demande de résiliation NL+ par SEL 
* Il met à jour son passe 
* Puis se rend en agence immédiatement après la mise à jour de son passe, et fait une demande de suspension de son contrat NL+ en agence|",0,1
nan,0,2
nan,0,1
"FP847 - IR C23 |{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client souscrivant à un contrat iRE au prélèvement, le 25 décembre de l’année de campagne en cours avec un début de contrat au 01/01 de l’année N+1|
|*QUAND*
Le traitement des prélèvements est exécuté|
|*ALORS*
Un courriel m’est envoyé pour m’informer que ma première mensualité sera majorée|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client souscrivant à un contrat iRE au prélèvement, le 15 novembre de l’année de campagne en cours avec un début de contrat au 01/11|
|*QUAND*
Le traitement des prélèvements est exécuté|
|*ALORS*
Un courriel m’est envoyé pour m’informer que ma première mensualité sera majorée|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client souscrivant à un contrat iRE au prélèvement, le 15 novembre de l’année de campagne en cours avec un début de contrat au 01/12|
|*QUAND*
Le traitement des prélèvements est exécuté|
|*ALORS*
Je ne reçois pas de courriel spécifique (une seule mensualité sur le premier prélèvement)|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis une client payeur d’un contrat iRE avec un impayé sur le mois précédent|
|*QUAND*
Le traitement de prélèvements est exécuté|
|*ALORS*
Je ne reçois pas de courriel spécifique|
|{panel:bgColor=#deebff}
*Scénario 5 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client souscrivant à un contrat iRE au prélèvement avec un Tiers payant prenant en charge 100% du forfait, le 15 novembre de l’année de campagne en cours|
|*QUAND*
Le traitement de prélèvements est exécuté|
|*ALORS*
Je ne reçois pas de courriel spécifique| {panel:bgColor=#e3fcef}
*Contexte* : Lorsqu’un client souscrit un contrat iRE au prélèvement en cours de campagne (après que les premiers prélèvements aient été exécutés) il se retrouve à devoir payer plusieurs mensualités lors de son premier prélèvement
{panel}

{panel:bgColor=#deebff}
*Besoin* : Identifier et envoyer à ces client un courriel pour leur expliquer le détail de leur prochain prélèvement 
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|Ref 1|Fonctionnelle|En cas de prélèvement incluant la prise en compte des mensualités annulées lors de la souscription, un courriel est envoyé au client pour lui expliquer le détail de ce prélèvement|
|Ref 2|Fonctionnelle|Le prélèvement en question est le premier prélèvement du contrat commercial|
|Ref 3|Fonctionnelle|Le montant du prélèvement est supérieur à la somme des frais de souscription et du montant de la mensualité|
|Ref 4|Fonctionnelle|Le traitement doit être exécuté juste après la constitution des prélèvements|
|Ref 5|Fonctionnelle|Le template du courriel est fourni sur l'épic|

Exemple d’identification d’un prélèvement incluant des mensualités annulées pour un contrat iRE

!image-20230321-152041.png|width=801,height=657!

!image-20230321-152117.png|width=829,height=472!

!image-20230321-152207.png|width=1132,height=400!",0,1
nan,0,2
nan,0,2
nan,0,1
nan,0,2
"FP393 - Amélioration de l’IHMC SIG ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Consulter*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un agent RATP utilisant l’IHMC|
|*QUAND*
Je clique sur un contrat tiers payant depuis le résultat de recherche
Et je clique sur Consulter|
|*ALORS*
L'écran Synthèse Contrat tiers payant est affiché en respectant la nouvelle charte graphique de l’IHMC SIG| {panel:bgColor=#e3fcef}
Contexte :

Le but de cette US est de mettre à jour l’aspect visuel des écrans « Contrat tiers payant» en se basant sur les éléments graphiques de la nouvelle charte de l’IHMC SIG.

+*Le périmètre de la modernisation visuelle :*+

* Consulter
* Recherche Mandat SEPA
{panel}

{panel:bgColor=#deebff}
Besoin :

En tant qu’utilisateur de l’IHMC

Je souhaite que les écrans “Contrat tiers payant” soient mis à la nouvelle charte graphique IHMC SIG

Afin d’améliorer l’IHMC.
{panel}

{panel:bgColor=#ffebe6}
Prérequis :

* Adapter la disposition des éléments graphiques aux différentes résolutions des écrans utilisées par les transporteurs à savoir 1024 x 769, 1280 X 1024 et 1920 X1080 en minimisant le scroll vers le bas d’écran.
* La nouvelle IHMC est supportée uniquement par Firefox 38+.
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|001|Fonctionnelle|Mettre l'Écran Contrat tiers payant à la nouvelle charte graphique|
|002|Fonctionnelle|Adapter l'écran aux différentes résolutions des écrans utilisées par les transporteurs à savoir 1024 x 769, 1280 X 1024 et 1920 X1080 en réduisant le scroll vertical.|",0,1
"FP605 - sujet metier SIG S1 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un agent|
|*QUAND*
J’effectue un changement de payeur.
Je passe d’un payeur possédant un IBAN français à un payeur qui a un IBAN étranger|
|*ALORS*
Le bon BIC/IBAN est affiché dans le pavé Domiciliations bancaires sur la partie Nouveau payeur
Le changement de payeur s’effectue avec succès|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un agent|
|*QUAND*
J’effectue un changement de payeur avec IBAN français à un autre avec IBAN français|
|*ALORS*
Le bon BIC/IBAN est affiché dans le pavé Domiciliations bancaires sur la partie Nouveau payeur
Le changement de payeur s’effectue avec succès| {panel:bgColor=#e3fcef}
*Contexte :*

L’anomalie [https://comutitres.atlassian.net/browse/SIG-8291|https://comutitres.atlassian.net/browse/SIG-8291|smart-link] évoque un trou fonctionnel dans la gestion des IBAN étrangers

Depuis la 22.3, on permet au client de changer de payeur possédant un IBAN étranger via les SEL. Sur le SIG, cette action est techniquement faisable mais on continue d’afficher l’IBAN générique au lieu de l’IBAN étranger
{panel}

{panel:bgColor=#deebff}
*Besoin :*

En tant que membre de la DAF, du SC ou agent, je souhaite que l’IHMC affiche les données bancaires réelles du client lorsque ce dernier effectue un changement de payeur d’un IBAN français à un IBAN étranger.

Il faut modifier l’écran nouveau payeur au niveau de la synthèse contrat commercial afin d’aller chercher le BIC/IBAN en accord avec la modification de la base.
{panel}

||Référence||Type||Exigences||
|REF 1|Fonctionnelle|La rubrique Nouveau Payeur de la page synthèse contrat commercial doit désormais afficher les véritables valeurs BIC & IBAN|
|REF 2|Fonctionnelle|Le changement de payeur est fonctionnel à l’IHM quelque soit les produits (NA, NL+ et iR) que l’IBAN du client soit français ou étranger|",0,1
nan,0,2
nan,0,1
nan,0,1
nan,0,1
nan,0,2
nan,0,1
"FP866 - Petits sujets techniques SIG 2023 S1 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Recherche d’un contrat tiers payant*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un opérateur ACE|
|*QUAND*
J’interroge le SIG avec une référence client tiers payant|
|*ALORS*
Je peux consulter les données de ce contrat.| {panel:bgColor=#e3fcef}
*Contexte* : 

Dans le cadre du renouvellement du marché de l'acquisition des courriers entrants (ACE), une harmonisation des web services est souhaitée afin que le nouveau prestataire utilise exclusivement des API REST (et non plus SOAP).
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

*En tant que prestataire ACE, je veux pouvoir rechercher un contrat tiers payant par sa référence client afin de pouvoir consulter ses données.*

Le but de cette US est de migrer en REST le service [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762532621/API-CAD-002+-+Rechercher+un+contrat+TP+par+r+f+rence+client|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762532621/API-CAD-002+-+Rechercher+un+contrat+TP+par+r+f+rence+client|smart-link].
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Exigences*||
|11976_001|Un nouveau WS doit être développé pour le WS cité.|
|11976_002|Le WS doit être en REST.|
|11976_003|Le WS doit avoir les mêmes caractéristiques que le WS SOAP (sauf ce qui est précisé explicitement dans les exigences).|
|11976_004|Une authentification BASIC doit être mise en place.|
|11976_005|Le nouveau WS doit respecter les normes de développement de WS REST.|",0,2
nan,0,1
"FE916 - Visualisation prélèvement ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 3 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 4 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : Dans la continuité de la  FE916 - [Etude] Améliorer la visualisation/compréhension des prélèvements. 

Comutitres souhaiterait pouvoir informer en amont du prélèvement les payeurs qui ont un prélèvement futur qui s'éloigne du tarif nominal (ex. 1 mensualité NA ou iR).

L’objectif étant d'éviter le refus de prélèvement de la part du Payeur faute de comprendre le montant de son prélèvement.
{panel}

{panel:bgColor=#deebff}
*Besoin* : Création d’une communication mensuelle automatique ciblant les payeurs ayant un futur prélèvement différent d’un prélèvement nominal (Notion à définir - ex. 1 mensualité NA ou iR).

Le SIG devra constituer l’email et porter le calcul du montant et la date du futur prélèvement qui devront être précisé dans la communication sur la base des informations contenues dans le SIG.

L’email devra être constitué et envoyé après le passage du batch de constitution des prélèvements.

*Existant :* Une communication avec un fonctionnement similaire (sans récurrence) existe déjà pour la première mensualité iR : [[SIG-11999] FP847 - iR C23 - Mail prélèvement iRS - Jira (atlassian.net)|https://comutitres.atlassian.net/browse/SIG-11999]
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|01|Fonctionnel|Fournir un Macro chiffrage de la solution|
|02|Fonctionnel|La faisabilité de mettre en place le besoin|",0,1
nan,0,1
"FP688 - Interfaces fraude palier 3.1 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :* 
{panel}|
|*ÉTANT DONNE QUE* 
Je suis l’exploitant|
|*QUAND* 
Je lance le batch de liste blanche différentielle SIS avec le code partenaire 1432|
|*ALORS* 
Un fichier de liste blanche différentielle est généré selon le format défini dans le contrat d’interface SIS ci-joint.| {panel:bgColor=#e3fcef}
*Contexte* : 

Dans le cadre de la mise en œuvre du SIS, nous avons besoin de générer un nouveau flux de liste blanche différentielle qui sera diffusée vers le SIS.

Cette liste blanche différentielle sera similaire à celle actuellement transmise aux 3T, à quelques différences près au niveau des données qui composent ce fichier.

A terme les flux historiques de listes blanches différentielles diffusés depuis le SIG => 3T seront décommissionnés et remplacés par ce nouveau flux unique : SIG => SIS. 

A noter enfin qu'un fichier d’acquittement sera transmis du SIS vers le SIG en retour de la transmission de cette nouvelle liste blanche, mais celui-ci ne sera pas traité côté SIG (il sera traité par la cellule d’exploitation du SIG).
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

En tant que responsable du projet SIS, je souhaite que le SIG puisse transmettre un nouveau flux de liste blanche différentielle au SIS, afin de leur permettre d’effectuer une gestion de la fraude.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 

N/A
{panel}

h2. Exigences : 

||Type||Exigences||
|Fonctionnel|Le SIG doit permettre de générer et diffuser une liste blanche différentielle au partenaire SIS dont le code est 1432.|
|Fonctionnel|Le format de la liste blanche différentielle SIS doit être identique à celui de la liste blanche différentielle 3T actuelle, à l’exception des exigences qui suivent.|
|Fonctionnel|Le champ “RUF” de la ligne d’entête doit être défini sur une taille de 31 caractères.
{panel:bgColor=#fffae6}
La ligne d’entête aura donc une taille totale de 70 caractères au lieu de 130 caractères.  
{panel}|
|Fonctionnel|Les champs suivants doivent être retirés de cette interface : 
* “Entreprise émettrice”
* “Lieu de l’opération”
* “Exploitant”
* “Horodate opération”
* “SAM-CL”
* “Numéro ligne origine”
* “Position origine”
* “Numéro ligne destination”
* “Position destination”
* “Compteur”|
|Fonctionnel|Un nouveau champ “Numéro de contrat”, sur 10 caractères, doit être ajouté à la suite du champ “Type de contrat”.|
|Fonctionnel|Ce nouveau champ “Numéro de contrat” doit être valorisé avec l’identifiant du contrat de transport concerné et complété à gauche avec des 0 si besoin.|
|Fonctionnel|Le champ “Zones” doit être valorisé avec 2 espaces pour les produits non zonaux (i.e. Navigo Liberté +).|
|Fonctionnel|Le champ “RUF” des lignes de détails doivent être définis sur une taille de {color:#ff5630}-9-{color}{color:#ff5630} 13{color} caractères.
{panel:bgColor=#fffae6}
Les lignes de détails auront donc une taille totale de 70 caractères au lieu de 130 caractères.  
{panel}|
|Fonctionnel|Cette nouvelle liste blanche différentielle doit venir en complément de la liste blanche différentielle actuelle (donc duplication des batchs) pour permettre de continuer de générer et diffuser les listes blanches différentielles actuelles à destination des 3T.|",0,1
nan,0,2
nan,0,1
nan,0,1
nan,0,2
nan,0,2
nan,0,2
"FE931 - Passe Universel ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 3 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 4 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : 

Une première étude a été réalisée visant à chiffrer la mise en place d’un passe unique (i.e. appelé également passe universel). Le passe unique en question devait être le passe NMS. 

L'étude réalisée se trouve sur ce ticket : [https://comutitres.atlassian.net/browse/SIG-11774|https://comutitres.atlassian.net/browse/SIG-11774|smart-link] 

En conclusion de cette étude, un macro-chiffrage a été fourni indiquant : 

* Des impacts et une complexité très importante du sujet 
* Un cout de réalisation donc très important (entre *200 jrs et 600 jrs* de développement SIG)

Ces impacts et complexité sont dus notamment au fait que le comportement du SIG est différent selon le type de passe (NA / NMS / IR). De ce fait, avoir un comportement SIG qui reste iso fonctionnel mais avec un seul type de passe est compliqué. 

Nous souhaitons poursuivre ce sujet, mais à partir de nouvelles hypothèse permettant normalement de réduire cette complexité de mise en œuvre du passe universel. 

L’idée serait que tous les passes (NA, NMS et IR) soient considérés comme des passes universels. Ainsi, un client ayant un passe imagine R, pourrait souscrire et charger un contrat Navigo Annuel dessus. 
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

Nous souhaitons avoir un nouveau macro chiffrage pour la mise en œuvre du passe universel à partir de ces nouvelles hypothèses.  
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 

N/A
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|001|Fonctionnelle|Fournir un macrochiffrage des impacts SIG pour la mise en œuvre d’un passe universel, sachant que tous les types de passes (NA, NMS et IR) doivent être considérés comme un même type de passe (le passe universel).|
|002|Fonctionnelle|Il ne sera plus demandé d’avoir aucune différence ou distinction de comportement SIG selon le type de passe.|
|003|Fonctionnelle|On pourra donc charger sur n’importe quel passe, n’importe quel type de contrat (tout en respectant les règles de cohabitation actuelles).|
|004|Fonctionnelle|Fournir si cela est opportun différents scénarios de macro-chiffrages. 
Exemple : un macro-chiffrage “minimum” contenant uniquement les modifications obligatoires et un “complet” contenant la solution “idéale” (exemple : nettoyage de code, nettoyage du paramétrage, etc.. ).|",0,2
"FP754 - Recherche multi SI ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Recherche avec l’identité client - Cas nominal avec succès*
{panel}|
|*ÉTANT DONNE QUE* j’ai appelé l’API de recherche client avec 
* Identité de client valide
* Retour photo valide
* Nombre maximum de résultat valide|
|*QUAND* l’API recherche avec ces paramètres le ou les clients 
* personnes physiques (E_CLT_CLIENT.CLT_RAISON_SOCIALE = NULL)
* non appairés (E_CLT_CLIENT.CLT_SEL_IND = NULL)
* dont le nom ou le prénom ne sont pas vides (E_CLT_CLIENT.CLT_NOM <> NULL OR E_CLT_CLIENT.CLT_PRENOM <> NULL)
* \[1 <= *nombre de clients trouvés* <= “Nombre maximum de résultats”]|
|*ALORS* je lis  
# Code : HTTP 200 - Success
# Liste des clients
Dans la liste des clients je ne vois pas 
* les personnes morales
* Les clients ayant un nom et un prénom vides
* Les clients appairés|
|{panel:bgColor=#ffebe6}
*Scénario 2 :  Identité client non conforme*
{panel}|
|*ÉTANT DONNE QUE* j’appel l’API avec l’IBAN et que l’une des règles suivantes n’est pas respectée
* le champ “Nom” a une longueur comprise dans \[1..20]
* le champ “Prénom” a une longueur comprise dans \[0..20]
* le champ “Nom” n’est pas vide
* le champ “Date de naissance” de format “AAAA/MM/JJ” et une longueur de 10 ou  de 0 caractères
* le champ “Code postal” a une longueur comprise dans \[0..5]|
|*QUAND* l’API répond|
|*ALORS* je lis 
# Code erreur : HTTP 400 - Bad request
# Description de l’erreur : Le format de l’un des champs suivants n’est pas respecté : 
## le champ “Nom” a une longueur comprise dans \[1..20]
## le champ “Prénom” a une longueur comprise dans \[0..20]
## le champ “Nom” n’est pas vide
## le champ “Date de naissance” de format “AAAA/MM/JJ” et une longueur de 10 ou  de 0 caractères
## le champ “Code postal” a une longueur comprise dans \[0..5]|
|{panel:bgColor=#ffebe6}
*Scénario 3 :  Paramètres insuffisants*
{panel}|
|*ÉTANT DONNE QUE* J’ai appelé l’API en valorisant les champs “Retour photo” et “Nombre maximum de résultats” mais aucun autre paramètre n’est présent|
|*QUAND* l’API répond|
|*ALORS* je lis 
# Code erreur : HTTP 400 - Bad request
# Description de l’erreur : Un et un seul des paramètres \[Référence client; Email de contact; Référence du passe ; Numéro mobile du client ;IBAN; Identité client] est attendu en entrée en plus des paramètres “Retour photo” et “Nombre maximum de résultat”|
|{panel:bgColor=#e3fcef}
*Scénario 4 : Recherche avec l’identité client - Caractères spéciaux*
{panel}|
|*ÉTANT DONNE QUE* j’ai appelé l’API de recherche client avec 
* Identité de client avec un nom et un prénom comportant des caractères spéciaux
* Retour photo valide
* Nombre maximum de résultat valide|
|*QUAND* l’API recherche avec ces paramètres le ou les clients 
* personnes physiques (E_CLT_CLIENT.CLT_RAISON_SOCIALE = NULL)
* non appairés (E_CLT_CLIENT.CLT_SEL_IND = NULL)
* dont le nom ou le prénom ne sont pas vides (E_CLT_CLIENT.CLT_NOM <> NULL OR E_CLT_CLIENT.CLT_PRENOM <> NULL)
* \[1 <= *nombre de clients trouvés* <= “Nombre maximum de résultats”]|
|*ALORS* 
# SIG supprime les caractères spéciaux du nom et du prénom
# la recherche me renvoi les clients portant le nom et le prénom sans caractères spéciaux| {panel:bgColor=#e3fcef}
*Contexte* :  Dans le cadre de la mise en place de l’API de recherche multi SI (voir l’US [\[SIG-10154] \[FP-754] API recherche client par référence client - Jira (atlassian.net)|https://comutitres.atlassian.net/browse/SIG-10154]), un mode de recherche par identité client doit rendre possible la recherche des clients dans le SIG.
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

*En tant que* API SIS Chapeau

*je veux* appeler l’API de recherche de client avec l’identité du client

*Afin* d’obtenir les données du client
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : [https://comutitres.atlassian.net/browse/SIG-10154|https://comutitres.atlassian.net/browse/SIG-10154]
{panel}

h2. Exigences : 

||Type||Exigences||
|Technique|*Paramètres d’entrée et formats*
* Identité client
** Nom : 1 minimum et 20 caractères max
** Prénom : 20 caractères max
** Date de naissance : AAAA-MM-JJ (format iso 8601)
** Code postal : 5 caractères max
* Retour photo : binaire (oui/non)
* Nombre maximum de résultats attendus :  2 chiffres max|
|Technique|*Pas plus d’un paramètre de recherche en même temps*
Renvoyer une erreur lorsqu'à part “Retour photo” et “Nombre maximum de résultat” plus d’un paramètre est présent
+Réponse :+
# Code erreur : HTTP 400 - Bad request
# Description de l’erreur : Un et un seul des paramètres \[Référence client; Email de contact; Référence du passe ; Numéro mobile du client ;IBAN; Identité client] est attendu en entrée en plus des paramètres “Retour photo” et “Nombre maximum de résultat”|
|Fonctionnel|*Identité client*
Renvoyer une erreur lorsqu’une ou plusieurs des conditions suivantes ne sont pas vérifiées
* le champ “Nom” a une longueur comprise dans \[1..20]
* le champ “Prénom” a une longueur comprise dans \[0..20]
* le champ “Nom” n’est pas vide
* le champ “Date de naissance” de format “AAAA-MM-JJ” (format iso 8601) et une longueur de 10 ou  de 0 caractères
* le champ “Code postal” a une longueur comprise dans \[0..5]
+Réponse :+
# Code erreur : HTTP 400 - Bad request
# Description de l’erreur : Le format de l’un des champs suivants n’est pas respecté : 
## le champ “Nom” a une longueur comprise dans \[1..20]
## le champ “Prénom” a une longueur comprise dans \[0..20]
## le champ “Nom” n’est pas vide
## le champ “Date de naissance” de format “AAAA-MM-JJ” et une longueur de 10 ou  de 0 caractères
## le champ “Code postal” a une longueur comprise dans \[0..5]|
|Fonctionnel|*Critères d’une recherche avec “Identité client”*
Quand l’API reçoit un appel avec l’*identité client*
Alors elle transforme le nom, le prénom et l’email caractères majuscules non accentués et procède à une recherche avec l’identité client selon les modes de recherche décrits dans l'exigence 4 et avec l’opérateur logique défini dans l’exigence 5 et renvoie tous les clients qui répondent aux conditions suivantes :
# Clients personne physique (E_CLT_CLIENT.CLT_RAISON_SOCIALE = NULL)
# Clients dont le nom ou le prénom est non vide (E_CLT_CLIENT.CLT_NOM <> NULL OR E_CLT_CLIENT.CLT_PRENOM <> NULL)
# Clients +non appairés+ (E_CLT_CLIENT.CLT_SEL_IND = NULL)
L’API renvoie une réponse suite à la recherche|
|Fonctionnel|*Mode de recherche*
Lors d’un appel à l’API avec l’identité client, l’API procède à une recherche 
* Exacte (opérateur =) : 
** Pour les champs Nom et ¨Prénom lorsqu’il n’y a pas de caractère “*” au début et/ou à la fin 
** Pour les champs Date de naissance et code postale
* Partielle 
** Pour les champs Nom et Prénom : 
*** lorsqu’il y a un caractère “*” au début (opérateur “Like '%ABC'” ) ==>chercher les Noms et/ou Prénom qui finissent par la valeur qui vient après le caractère “*”
*** lorsqu’il y a un caractère à la fin (opérateur “Like 'ABC%'” ) ==> chercher les Noms et/ou Prénoms qui commencent par la valeur qui vient avant le caractère “*”
*** Lorsqu’il y a un caractère “*” au début et à la fin (opérateur “Like '%ABC%'” ) ==> chercher les Noms et/ou les Prénoms qui contiennent la valeur qui se trouve entre les deux caractères “*”|
|Fonctionnel|*Opérateur logique du filtre de recherche*
Lors de la sélection des données, il faut appliquer l’opérateur logique “ET” pour que le client trouvé corresponde à tous les critères fournis en entrée|
|Fonctionnel|*Espaces et caractères spéciaux*
Lors d’une recherche et à l’image du traitement que fait SIG lors d’une recherche. il faut traiter les champs nom et prénom : 
* Supprimer les espaces en début et fin de chaine
* Supprimer les caractères spéciaux non autorisés (sauf dans le cas du * au début et ou à la fin du texte)|",0,2
"FP609 - petits sujets NL+ 2022 +*Consignes pour le cadrage :*+ 

* Faire des mix
** entre client *porteur = payeur* et *porteur différent de payeur* (scénario 1, 2, 3 et 4)
** entre Résilié Client, Résilié Gestionnaire, Résilié Comutitres, Clôturé (scénarios 3 et 4)
** entre < et = (scénarios 1 et 3)

||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Souscription en Agence/SEL - primo - Date jour < date paramètre*
{panel}|
|*ÉTANT DONNE QUE* je n’ai jamais été titulaire d’un contrat NL+ ET que *Date jour <= date paramètre*|
|*QUAND* je souscris pour moi un nouveau contrat NL+ en Agence 
*QUAND* je souscris pour moi un nouveau contrat NL+ sur les SEL|
|*ALORS* 
* sur ma facture à venir, je n’aurai pas à payer de frais de souscription 
* sur le contrat NL+ édité en Agence, la phrase mentionnant les frais de souscription est la suivante : 
** être informés que des frais de souscription sont perçus sur la première facture, selon la tarification en vigueur au moment de la souscription. Une gratuité de ces frais peut être accordée dans le cas où le Titulaire n’en aurait pas déjà bénéficié antérieurement.|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Souscription en Agence/SEL - primo - Date jour >= date paramètre*
{panel}|
|*ÉTANT DONNE QUE* je n’ai jamais été titulaire d’un contrat NL+ ET que Date jour > date paramètre|
|*QUAND* je souscris pour moi un nouveau contrat NL+ en Agence 
OU
*QUAND* je souscris pour moi un nouveau contrat NL+ sur les SEL|
|*ALORS* 
* sur ma facture à venir, j’aurai à payer des frais de souscription 
* sur le contrat NL+ édité en Agence, la phrase mentionnant les frais de souscription est la suivante : 
** être informés que des frais de souscription sont perçus sur la première facture, selon la tarification en vigueur au moment de la souscription. Une gratuité de ces frais peut être accordée dans le cas où le Titulaire n’en aurait pas déjà bénéficié antérieurement.|
|{panel:bgColor=#e3fcef}
*Scénario 3 : Souscription en Agence/SEL - non primo - Date jour < date paramètre*
{panel}|
|*ÉTANT DONNE QUE* je suis titulaire d’un contrat NL+ résilié Comutitres ET que Date jour <= date paramètre|
|*QUAND* je souscris pour moi un nouveau contrat NL+ en Agence
OU
*QUAND* je souscris pour moi un nouveau contrat NL+ sur les SEL|
|*ALORS*
* sur ma facture à venir, j’aurai à payer des frais de souscription 
* sur le contrat NL+ édité en Agence, la phrase mentionnant les frais de souscription est la suivante : 
** être informés que des frais de souscription sont perçus sur la première facture, selon la tarification en vigueur au moment de la souscription. Une gratuité de ces frais peut être accordée dans le cas où le Titulaire n’en aurait pas déjà bénéficié antérieurement.|
|{panel:bgColor=#e3fcef}
*Scénario 4  : Souscription en Agence/SEL - non primo - Date jour >= date paramètre*
{panel}|
|*ÉTANT DONNE QUE* je suis titulaire d’un contrat NL+ résilié Comutitres ET que Date jour > date paramètre|
|*QUAND* je souscris pour moi un nouveau contrat NL+ en Agence
OU
*QUAND* je souscris pour moi un nouveau contrat NL+ sur les SEL|
|*ALORS*
* sur ma facture à venir, j’aurai à payer des frais de souscription 
* sur le contrat NL+ édité en Agence, la phrase mentionnant les frais de souscription est la suivante : 
** être informés que des frais de souscription sont perçus sur la première facture, selon la tarification en vigueur au moment de la souscription. Une gratuité de ces frais peut être accordée dans le cas où le Titulaire n’en aurait pas déjà bénéficié antérieurement.| {panel:bgColor=#e3fcef}
*Contexte* : 

* En cas de souscription d’un client à un contrat NL+, des frais de souscription peuvent s’appliquer ou non.
* Ce mécanisme a été mis en œuvre suite à une demande d’IdFM pour que les frais de souscription NL+ soient offerts uniquement lors de la 1^ère^ souscription (et non par exemple suite à une résiliation système ou client, ou pour bénéficier plusieurs fois d’une offre promotionnelle à la souscription) et effectif depuis le 01/01/2020.
* Si le client titulaire n’a pas de contrat NL+ en état Résilié (les 3 états de résiliation) ou clôturé alors le SIG va créer une régul allant compenser le frais de souscription.
* Projet FP391 -NL+ - Limitation frais de gratuite frais de souscription
** [https://comutitres.atlassian.net/browse/SIG-2247|https://comutitres.atlassian.net/browse/SIG-2247|smart-link]
** [https://comutitres.atlassian.net/browse/SIG-2248|https://comutitres.atlassian.net/browse/SIG-2248|smart-link]
** [https://comutitres.atlassian.net/browse/SIG-2267|https://comutitres.atlassian.net/browse/SIG-2267|smart-link]
** [https://comutitres.atlassian.net/browse/SIG-2322|https://comutitres.atlassian.net/browse/SIG-2322|smart-link]
{panel}

{panel:bgColor=#deebff}
*Besoin* : Il est demandé de mettre en œuvre un mécanisme de feature flipping qui pourrait activer/désactiver la mécanique de compensation. En d’autres termes, de ne plus créer de régularisation automatiquement pour les cas de client n’ayant jamais eu de contrat NL+ vivant.
{panel}

{panel:bgColor=#eae6ff}
En tant qu’*Exploitant*, je veux *programmer une date* à partir de laquelle on va *désactiver l’annulation* des frais de souscription NL+ afin de les *facturer dans tous les cas*.
{panel}

h2. Exigences : 



||*Référence*||*Exigences*||
|9176-01|Un nouveau paramètre doit être créé pour indiquer à partir de *quelle date on ne doit plus appliquer l’annulation des frais de souscription NL+*.|
|9176-02|Le paramètre doit être persisté dans une table du SIG|
|9176-03|Le paramètre doit être pris en compte immédiatement en cas de modification, sans redémarrage du serveur WebLogic|
|9176-04|Lors de la souscription d’un contrat NL+ et quel que soit le canal, cette date doit être prise en compte par le SIG|
|9176-05|Si la date système est inférieure {color:#ff5630}strictement {color}{color:#ff5630}-ou égale-{color}{color:#ff5630} {color}au *nouveau paramètre*, alors le SIG doit :
* lever un motif d’annulation des frais de souscription
* et créer une régularisation pour compenser exactement le frais
* uniquement si le titulaire n’a jamais eu de contrat NL+ résilié ou clôturé
*_NB1 : Comparaison à effectuer sans notion d’heure_*
*_NB2 : en d’autres termes : le fonctionnement encore effectif en 22.4_*|
|9176-06|Si la date système est supérieure {color:#ff5630}-strictement-{color}{color:#ff5630} ou égale{color} au *nouveau paramètre*, alors le SIG ne doit pas :
* lever de motif d’annulation des frais de souscription
* créer de régularisation automatiquement
*_NB1 : Comparaison à effectuer sans notion d’heure_*|
|9176-07|La valeur par défaut du paramètre doit être initialisée au{color:#ff5630} *31/12/2099*{color}
(date sans heure étant donné que la vérification doit se faire sur la date uniquement)|
|9176-08|{color:#00b8d9}La phrase mentionnant la gratuité des frais doit être modifiée dans le contrat NL+ stocké dans le SIG.{color}
Avant : 
* être informés que des frais de souscription de 8€ TTC en Plein Tarif ou 4€ TTC en Tarif Réduit pourront être prélevés sur la première facture dans le cas où le titulaire aurait déjà bénéficié d’une gratuité des frais de souscription NL+.
Après : 
* être informés que des frais de souscription sont perçus sur la première facture, selon la tarification en vigueur au moment de la souscription. Une gratuité de ces frais peut être accordée dans le cas où le Titulaire n’en aurait pas déjà bénéficié antérieurement.|",0,1
"FP866 - Petits sujets techniques SIG 2023 S1 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Cas Webservice*
{panel}|
|*ÉTANT DONNE QUE* Cli-400 avec ref SIG qui n’existe pas|
|*QUAND* j’appel le webservice|
|*ALORS* j’obtiens des logs applicatifs avec ID corr.|
|{panel:bgColor=#e3fcef}
*Scénario 2 :* IHM
{panel}|
|*ÉTANT DONNE QUE* j’ai lancé une action dans IHMC|
|*QUAND* je consulte les logs applicatifs|
|*ALORS* tous les logs relatifs à mon action portent le même ID corr.|
|{panel:bgColor=#e3fcef}
*Scénario 3 :* Batch
{panel}|
|*ÉTANT DONNE QUE* j’ai lancé le batch BATCH-COU-530|
|*QUAND* je consulte les logs applicatifs|
|*ALORS* tous les logs relatifs à l’exécution de mon batch portent le même ID corr.|
|{panel:bgColor=#e3fcef}
*Scénario 4 :* Rabbit MQ
{panel}|
|*ÉTANT DONNE QUE* SIG consomme une action du Rabbit MQ|
|*QUAND* je consulte les logs applicatifs|
|*ALORS* tous les logs relatifs à l’exécution de l’action portent le même ID corr.|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) : tous les cas (IHM / Batch / web service / Rabbit MQ)*
{panel}|
|*ÉTANT DONNE QUE* j’ai lancé les cas de figures du sénario|
|*QUAND* je consulte les logs applicatifs|
|*ALORS* tous les logs relatifs à l’exécution de mon batch portent le même ID corr.| {panel:bgColor=#e3fcef}
*Contexte* : L’exploitation des logs SIG ne permet pas de corréler plusieurs logs qui découlent du même processus.
{panel}

{panel:bgColor=#deebff}
*Besoin* : afin de pouvoir corréler les logs d’un même processus, Nous mettons en place l’[ID de corrélation |https://comutitres.atlassian.net/wiki/spaces/EP/pages/2812183031/SIG-10874+ETUDE+Ajouter+un+identifiant+de+corr+lation+dans+SIG]afin de faciliter la lecture et l’exploitation des logs applicatifs de SIG
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : [~accountid:615c3716048360006a464b54] , dans la configuration 

==> ajouter *%X{TRACKER_SIG}* dans toutes les lignes [<PatternLayout pattern=""%d %-5p %*X{TRACKER_SIG}* %C{2} (%F:%L) - %m%n""/>]
{panel}

h2. Exigences : 

||*Type*||*Exigences*||
|Technique|Mise en place de l’ID de corrélation|
|Technique|Vérifier que la màj des log4j nécessaire n’implique pas que les Devs sont faits|",0,2
nan,0,1
"FP500 - Plan de correction 2021   {panel:bgColor=#e3fcef}
*Contexte :*

 Les montées de version POI et dom4j n'ont pas pu être réalisées à cause du coût important que cela impliquait.

Cependant si possible nous aurons besoin de mitiger les risques associés à ces bibliothèques.
{panel}
{panel:bgColor=#deebff}
*Besoin :*

 En tant que responsable RSSI

Je veux que les risques associées aux bibliothèques soient mitigées

Afin de réduire les risques au maximum
{panel}
{panel:bgColor=#ffcfc1}
 {panel}
h2. *Exigences :* 

 
||Référence                                        ||Type                                             ||Exigences                                                     ||
|Ref 1 |Sécurité|Etudier les potentielles options de mitigation de risque pour les failles causées par dom4j|
|Ref 2 |Sécurité|Etudier les potentielles options de mitigation de risque pour les failles causées par poi|",0,1
nan,0,2
"FP867 - Petits sujets techniques SIG 2023 S2 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : Dans le cadre de la modernisation de SIG, une étude a été réalisée pour identifier les gains de mettre à jour la version d’EJB. Cette étude met en avant deux opporunités : 

* Migration des services métier EJB2.1 en service EJB3 
* Migration de la persistance EJB2.1 en implémentation JPA

Si EJB 2.1 a été abandonné c'est parce que cette technologie souffre de plusieurs problèmes importants :

* la lourdeur d'écriture impactant la productivité
* la complexité de mise en œuvre entravant la maintenance
* le besoin de formation spécifique du fait de la quasi absence de profils sur le marché connaissant cette technologie
* la limite des services rendues par l’api de fait qu’elle n’est plus développée depuis 2004
{panel}

{panel:bgColor=#deebff}
*Besoin* : Porter les ejb évènements journaux session
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : [https://comutitres.atlassian.net/browse/SIG-12285|https://comutitres.atlassian.net/browse/SIG-12285|smart-link]
{panel}

h2. Exigences : 

||*Type*||*Exigences*||
|Technique|organiser l'implémentation des ejb 3.2 session en parallèle des EJB 2 session équivalent|
|Technique|Vérifier la cohabitation dans Weblogic 12.2|
|Documentation|Préciser dans la solution la version des EJB et JPA utilisés|
|Documentation|Préciser dans la solution le nombre de services et d'entités impactés|",0,2
"FP874 - Sujet metier SIG 2023 S1 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Reboursement d’une mensualité lors d’une bascule senior en début de mois immédiatement suivi d’une résiliation avec date d’effet pour le mois suivant*
{panel}|
|*ÉTANT DONNE QUE*
* J’ai souscrit un NA au 1er Décembre 2022
* J’ai basculé en profil Senior le 2 Avril 2023|
|*QUAND*
l’agent résilie mon contrat juste après ma bascule Senior avec une date d’effet immédiate|
|*ALORS*
* Je m’attends à un remboursement de 84.10€ pour la mensualité d’Avril
* Les montants de l’opération de la résiliation et du mouvement financier “annulation tarif contrat de transport” doivent être égales à 7 mensualité NAS (correspondant aux mensualité de Mai à Novembre) + 1 mensualité NA (correspondant à la mensualité d’avril)|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Montant “Annulation tarif contrat de transport” d’une mensualité lors d’une bascule senior en fin de mois (après batch de facturation) immédiatement suivi d’une résiliation avec date d’effet pour le mois suivant*
{panel}|
|*ÉTANT DONNE QUE*
* J’ai souscrit un NA au 1er Décembre 2022
* J’ai basculé en profil Senior le 25 Mars 2023|
|*QUAND*
l’agent résilie mon contrat juste après ma bascule Senior avec une date d’effet pour le 1er Mai|
|*ALORS*
* Je n’attends aucun remboursement
* Les montants de l’opération de la résiliation et du mouvement financier “annulation tarif contrat de transport” doivent être égales à 7 mensualités NAS (correspondant aux mensualités de Mai à Novembre)|
|{panel:bgColor=#e3fcef}
*Scénario 3 : Remboursement d’une mensualité lors d’une bascule senior en début de mois (avant le batch) immédiatement suivi d’une résilitation avec date d’effet pour le mois suivant*
{panel}|
|*ÉTANT DONNE QUE*
* J’ai souscrit un NA au 1er Novembre 2022
* J’ai basculé en profil Senior le 1er Juin 2023|
|*QUAND*
l’agent résilie mon contrat juste après ma bascule Senior avec une date d’effet pour le 1er Juillet|
|*ALORS*
* Je n’attends aucun remboursement
* Je n’attends aucun prélèvement non plus
* Les montants de l’opération de la résiliation et du mouvement financier “annulation tarif contrat de transport” doivent être égales à 4 mensualités NAS (correspondant aux mensualité de Juillet à Octobre)|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) : Résiliation NAS sans bascule Senior*
{panel}|
|*ÉTANT DONNE QUE*
* J’ai souscrit un NAS au 1er Décembre 2022|
|*QUAND*
Je résilie mon contrat le 2 Avril 2023 avec une date d’effet immédiate|
|*ALORS*
* Je m’attends à un remboursement de 42.05€ pour la mensualité d’Avril
* Les montants de l’opération de la résiliation et du mouvement financier “annulation tarif contrat de transport” doivent être égales à 8 mensualité NAS| {panel:bgColor=#e3fcef}
*Contexte* : 

h3. Occurrence du problème

Le service client à relevé plusieurs cas de clients ayant basculés Senior dont le contrat avait été résilié mais avec un nombre de prélèvement supérieur à 0.

Normalement, le processus de bascule initialement prévu est de simplement changer le profil du client, or il arrive souvent que pour accélérer la prise en compte du tarif senior, les agents effectuent : 

* une bascule Senior, 
* ensuite une résiliation du contrat
* puis une nouvelle souscription

La première piste explorée était que la durée de financement n'était pas mise à jour lors de la bascule Senior. Pour rappel, la durée de financement d’un contrat NAS est de 12 mois contrairement à NA qui est de 11 mois (avec 1 mois gratuit). 

Après étude il s’avère que le problème n’est pas la durée de financement, mais la date de fin de financement qui n’est pas repoussée d’un mois. Cette correction est prise en charge par l'évolution suivante : [https://comutitres.atlassian.net/browse/SIG-11562|https://comutitres.atlassian.net/browse/SIG-11562|smart-link].

Entre temps, l'étude a aussi révélée qu’il y a un mauvais montant calculé pour les deux mouvements financiers suivants lors de la résiliation : 

* +51 - Annulation tarif contrat de transport+ : Dans le calcul de l’annulation du tarif contrat de transport, autrement dit lorsqu’on résilie ou qu’on suspend le contrat, c’est le calcul qui annule les prochaines mensualités (s'il reste 5 mensualités jusqu'à la date de fin de financement, le calcul doit renvoyer _5 * montantMensualité_).
* +8 - Mensualités annulées+ : Dans le calcul du montant des mensualités à rembourser, lorsque le client résilie ou suspend son contrat après le batch de prélèvement, pour une date d’effet immédiate ou pour le 1er du mois suivant, alors il doit être rembourser de sa dernière mensualité facturée. 

→ Ces règles de calcul pour ces deux mouvements financiers sont mal appliquées quand les agents font dans l’ordre : une bascule Senior puis une résiliation ou suspension. 

h3. 51 - Annulation tarif contrat de transport

En se référent au schéma ci-dessous, l’annulation du tarif contrat de transport indique une annulation de 3 mensualité NAS car : 

* Actuellement : Le contrat étant NAS, le processus annule les mensualités entre la date de début de financement et la date de fin de financement. Comme le profil est déjà Senior alors la mensualité NA (Juillet sur le schéma) est considérée comme NAS, et comme la date de fin de financement n’a pas été repoussée d’un mois alors une mensualité (Octobre sur le schéma) est oubliée dans le calcul.
* La cible : La story [https://comutitres.atlassian.net/browse/SIG-11562|https://comutitres.atlassian.net/browse/SIG-11562|smart-link] va combler la mensualité NAS manquante. 
* Il faut par contre ajouter le fait que la première mensualité à annuler est une mensualité NA. L’annulation de tarif contrat de transport doit être 1 * mensualité NA + 3 mensualité NAS.
!image-20230203-151955.png|width=1835,height=440!

h3. 8 - Mensualités annulées

En se référant encore une fois au schéma ci-dessus, on voit qu’on devrait rembourser le client de sa mensualité de juillet au tarif NA. Or dans les faits, comme le client est basculé Senior, le remboursement se fait sur la base du tarif Senior. 

Il faut donc corriger afin de rembourser le client sur la base du tarif de la dernière mensualité facturée plutôt que celle du tarif à date. 
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

* En tant que comptable Comutitres, je veux que quand un client bascule Senior puis résilie son contrat alors les mouvements d’annulation du tarif de contrat de transport soient corrects et comprennent le bon nombre de mensualités NA et NAS
* En tant que client, je veux que lorsque mon profil est basculé Senior puis mon contrat est résilié dans la foulée, je veux être remboursé de la bonne mensualité afin de ne pas avoir de réclamation à faire.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : [https://comutitres.atlassian.net/browse/SIG-11562|https://comutitres.atlassian.net/browse/SIG-11562|smart-link] 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|SIG-11566_1|Fonctionnelle|Modifier le calcul d'annulation tarif contrat de transport pour les contrat NAS
* Qui ont été résiliés ou suspendus après la date du batch de prélèvement 
* Qui se retrouvent avec une date d’effet de résilitation inférieure à la date de début d’application du tarif senior|
|SIG-11566_2|Fonctionnelle|Le calcul annulation tarif contrat de transport doit prendre en compte le nombre de mensualité du tarif NAS entre la date d’application du contrat et la date de fin de financement ainsi que le nombre de mensualité NA comprise entre la date de résilitation et la date d’application du tarif NAS
Sur le schéma en description on voit qu’avec la bascule post-batch de prélèvement on a une mensualité NA supplémentaire avant l’application du tarif Senior. Lors de l’annulation de tarif du contrat de transports on doit donc annuler 1 mois de NA + les 3 mois NAS qui suivent|
|SIG-11566_3|Fonctionnelle|Modifier le calcul de remboursement pour les contrat NAS lorsque la bascule Senior s’est faite en fin de mois (après la facturation) suivi d’une demande de résiliation avec une date d’effet inférieure à la date d’application du tarif NAS
Sur le schéma on voit que la dernière mensualité payé est au tarif NA. Bien que son profil soit Senior il faut lui rembourser le dernier montant prélevé, pas le tarif en vigueur pour son profil|",0,2
nan,0,1
nan,0,1
nan,0,2
nan,0,1
nan,0,2
nan,0,1
nan,0,2
"FP767 - Evolution de l'IHMC pour la gestion des templates des emails ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Prévisualiser un email dans le cadre d’un upload*
{panel}|
|*ÉTANT DONNE QUE* j’ai appuyé sur le radio bouton de sélection d’un template email puis sur le bouton Upload|
|*QUAND* j’ai uploadé un template et que je clique sur le bouton prévisualiser et que je sélectionne le jeu de données souhaité|
|*ALORS* SIG génère le template d’email et me l’affiche à l'écran|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Prévisualiser un email*
{panel}|
|*ÉTANT DONNE QUE* j’ai appuyé sur le bouton prévisualiser d’un template email|
|*QUAND* je sélectionne le jeu de données souhaité|
|*ALORS* SIG génère le template d’email et me l’affiche à l'écran| {panel:bgColor=#e3fcef}
*Contexte :* 

Le rendu du template dans un mail n’est pas toujours conforme à l’attendu.


{panel}

{panel:bgColor=#deebff}
*Besoin :*

Nous souhaiterions pouvoir voir le rendu d’un template depuis l'écran d’upload des templates
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*
{panel}

h2. Exigences : 

||Type||Exigences||
|Fonctionnel|*Radio bouton “Upload” d’un template*
Je vois un radio bouton de sélection à côté de chaque éléments de la liste des templates email|
|Fonctionnel|*Bouton “Prévisualiser” un template*
Je vois un bouton “Prévisualiser” à côté de chaque élément de la liste des templates email|
|Fonctionnel|*Prévisualiser un template dans le cadre de l’upload*
Quand je clique sur upload après avoir sélectionné un template de la liste alors : 
# SIG reconnaît le type de template que je veux uploader
# SIG me propose de choisir le fichier du template
# Suite à la sélection du template, SIG me propose de valider, de prévisualiser ou d’abandonner l’upload
# Si je choisi de prévisualiser le template, SIG m’affiche l'écran décrit dans l’exigence 5|
|Fonctionnel|*Prévisualiser un template existant*
Quand je clique sur le bouton “Prévisualiser” d'un template de la liste alors : 
# SIG reconnaît le type de template que je veux prévisualiser
# SIG m’affiche l'écran décrit dans l’exigence 5|
|Fonctionnel|*Ecran de choix des JDD*
Avant de m’afficher le template choisi, 
# SIG m’affiche un écran pour choisir les jeux de données nécessaires décrits dans l’exigence 6
# SIG m'affiche l'écran décrit dans l’exigence 7|
|Fonctionnel|*Choix des JDD*
SIG requête dans la table des évènements pour lister les JDD associés aux générations connues en BDD|
|Fonctionnel|*Affichage du template*
Une fois un jeu de données est sélectionnée et confirmé, SIG génère le template avec ces données là et me l'affiche à l'écran dans une fenêtre séparée|",0,2
nan,0,2
"FP874 - Sujet metier SIG 2023 S1 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Bascule de NA vers NA “Senior” dans le mois gratuit*
{panel}|
|*ÉTANT DONNE QUE*  Je suis un client qui possède déjà un forfait Navigo Annuel “classique”
*Et* je suis âgé de plus de 62 ans 
*Et* que le mois M+1 est mon mois gratuit (que je n’ai plus de prélèvements à venir sur mon contrat NA actif)|
|*QUAND* Je demande une bascule vers le forfait Navigo Annuel “Senior”|
|*ALORS* En base de données, au niveau des données “contrat commercial”, on constate que la date E_CON_CONTR_COMM_INTEGRALE.CNIN_SENIOR_DEBUT_D est mis à jour par la date d'effet de bascule senior| {panel:bgColor=#e3fcef}
*Contexte* : 

Lorsqu’un client bascule de NA vers NAS, on inscrit en base de données dans la table des contrats commerciaux NA la date à laquelle le contrat devient Senior

Cette date permet de différencier en base de données les contrats NAS des contrats NA.

Cela permet entre autres de pouvoir isoler les contrats NAS lors *du calcul du PCA.*

Dans le cas d’une bascule lors du {color:#bf2600}*mois gratuit*{color} c’est à dire {color:#bf2600}*Si le nombre de prélèvement restant vaut 0*{color} , cette date n’est pas indiquée car le contrat ne bascule pas directement au tarif Senior. La bascule sera effective au moment de la reconduction du contrat.
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

L’objectif de ce ticket est de renseigner la date de bascule au tarif Senior pour un contrat. Cette information peut être renseignée lors de la bascule 

*En tant* qu'administrateur de l’exploitation 

*Je souhaite que* lorsqu'un client est dans son mois gratuit ET bascule de NA vers NAS , le SIG enregistre la date d'effet de bascule senior pour un forfait Navigo annuel 

*Afin de* pouvoir remonter l’information dans les rapports financiers.


{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 

Si la solution est de renseigner la date lors de la reconduction alors les traitements de reconduction automatique et manuelle devront être impactés.
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|11687_001|Fonctionnelle|*Lors d’une bascule* d’un forfait Navigo Annuel classique à un forfait Navigo Annuel “Senior” {color:#bf2600}*dans le mois gratuit* {color}, le SIG doit inscrire en base de données au niveau de l'objet ""contrat commercial"", la date à partir de laquelle la tarification “Senior” s’applique .
=>
Mettre à jour la date de début de la tarification senior de la colonne {color:#bf2600}*CNIN_SENIOR_DEBUT_D* {color}de la table *E_CON_CONTR_COMM_INTEGRALE* . => *E_CON_CONTR_COMM_INTEGRALE.**_CNIN_SENIOR_DEBUT_D_* _passe de_ *_NULL_* _à_ *la date d'effet de bascule senior pour un forfait Navigo annuel*|",0,1
"FP393 - Amélioration de l’IHMC SIG ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*     
Je suis un conseiller CRC utilisant l’IHMC|
|*QUAND*  
J’ouvre l'écran Synthèse Contrat Commercial|
|*ALORS*  
L'écran est affiché en respectant la nouvelle charte graphique de l’IHMC SIG|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*  
Je suis un utilisateur de l’IHMC|
|*QUAND*  
J’ouvre l'écran Synthèse Contrat Commercial|
|*ALORS*  
Les composants graphiques s’adaptent bien à la résolution 1024 x 769 et 1280 X 1024  sans scroll en bas| {panel:bgColor=#e3fcef}
*Contexte :* 

Le but de cette US est de mettre à jour l’aspect visuel de l’écran « Synthèse Contrat Commercial » en se basant sur les éléments graphiques de la nouvelle charte de l’IHMC SIG.

Le périmètre de la modernisation visuelle :

# Modification de la feuille de style commune.
# Mettre à jour le code la page JSP. 
{panel}

{panel:bgColor=#deebff}
*Besoin :*

 En tant qu’utilisateur de l’IHMC

Je souhaite que l'écran Synthèse Contrat Commercial soit mis à la nouvelle charte graphique IHMC SIG

Afin d’améliorer l’IHMC.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

 Adapter la disposition des éléments graphiques aux différentes résolutions des écrans utilisées par les transporteurs à savoir 1024 x 769 et 1280 X 1024 en minimisant le scroll vers le bas d’écran.
{panel}

h2. *Exigences :* 

 

||Référence||Type||Exigences||
|001|Fonctionnelle|Mettre l'écran Synthèse Contrat Commercial  à la nouvelle charte graphique|
|002|Fonctionnelle|Adapter l'écran aux différentes résolutions des écrans utilisées par les transporteurs à savoir 1024 x 769 et 1280 X 1024 en réduisant le scroll vertical.|",0,2
"FP725 - SIS interface liste des ventes (DIS_A_07) ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Liste de vente*
{panel}|
|*ÉTANT DONNE QUE*
En tant qu’exploitant Comutitres, je reçois 3 fichiers de listes de vente en provenance des émetteurs suivants : 
* 07001 : Canal Mobile
* 07002 : AMT SNCF
* 07003 : T10
Et que le paramètre {{ControleNumSequence}} est activé. 
Que les numéros de séquence des fichiers = dernier numéro de séquence de l'émetteur + 1 ou 001 si le dernier numéro était 999.|
|*QUAND*
Je lance le *BATCH-PASSE-645-SIS* pour ces 3 fichiers|
|*ALORS*
Je n’ai pas d’erreur par rapport aux numéros de séquence car ceux ci sont indépendant les uns des autres.|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Liste de rechargement*
{panel}|
|*ÉTANT DONNE QUE*
En tant qu’exploitant Comutitres, je reçois 3 fichiers de rechargement en provenance des émetteurs suivants : 
* {color:#ff5630}-07001 : Canal Mobile-{color}
* {color:#ff5630}-07002 : AMT SNCF-{color}
* {color:#ff5630}-07003 : T10-{color}
* {color:#ff5630}07000 : SIS{color}
Et que le paramètre {{ControleNumSequence}} est activé
Que les numéros de séquence des fichiers = dernier numéro de séquence de l'émetteur + 1 ou 001 si le dernier numéro était 999.|
|*QUAND*
Je lance le *BATCH-PASSE-640-SIS* pour ces 3 fichiers|
|*ALORS*
Je n’ai pas d’erreur par rapport aux numéros de séquence car ceux ci sont indépendant les uns des autres.|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) : Liste de vente*
{panel}|
|*ÉTANT DONNE QUE*
En tant qu’exploitant Comutitres, je reçois 3 fichiers de listes de vente en provenance des émetteurs suivants : 
* 07001 : Canal Mobile
* 07002 : AMT SNCF
* 07003 : T10
Et que le paramètre {{ControleNumSequence}} est désactivé. 
Et que les numéros de séquence de ces fichiers sont incorrects.|
|*QUAND*
Je lance le *BATCH-PASSE-645-SIS* pour ces 3 fichiers.|
|*ALORS*
Je n’ai pas d’erreur par rapport aux numéros de séquence.|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) : Liste de rechargement*
{panel}|
|*ÉTANT DONNE QUE*
En tant qu’exploitant Comutitres, je reçois 3 fichiers de listes de {color:#ff5630}-vente-{color}{color:#ff5630} rechargement {color}en provenance des émetteurs suivants : 
* {color:#ff5630}-07001 : Canal Mobile-{color}
* {color:#ff5630}-07002 : AMT SNCF-{color}
* {color:#ff5630}-07003 : T10-{color}
* {color:#ff5630}07000 : SIS{color}
Et que le paramètre {{ControleNumSequence}} est désactivé. 
Et que les numéros de séquence de ces fichiers sont incorrects.|
|*QUAND*
Je lance le *BATCH-PASSE-640-SIS* pour ces 3 fichiers.|
|*ALORS*
Je n’ai pas d’erreur par rapport aux numéros de séquence.|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
En tant qu’exploitant Comutitres, je reçois des fichiers autres en provenance d’autres partenaires.|
|*QUAND*
Je lance les batch SIG associés.|
|*ALORS*
Je n’ai pas d’erreur par rapport aux numéros de séquence car ceux ci sont indépendant les uns des autres.| {panel:bgColor=#e3fcef}
*Contexte* : 

Rappel sur quelques notions : 

* *Partenaire* : Un partenaire définit une entité avec laquelle le SIG échange des données sous forme de fichiers. Par extension, lorsque le batch effectue un traitement interne, sans production de fichier, afin de tracer les différentes exécutions, on définit un partenaire SIG
* *Type d'échange* : Les caractéristiques d’un type d’échange sont un code d’identification et un libellé, par exemple : le type d’échange « liste verte » est défini par son code « LV » et son libellé « Liste Verte ». Par extension, un type d’échange peut décrire un traitement interne sans échange de fichier comme le traitement des actions hors délai dont le code est « ActionHorsDela » et le libellé « Actions Hors Délai ».
* *Echange* : Un échange est défini par l’association d’un type d’échange avec un partenaire. Ainsi l’échange de la liste verte avec la RATP est représenté par un échange, tandis que l’échange de la liste verte avec la SNCF est représenté par un autre échange du même type. Un échange est donc caractérisé par un type d’échange « Liste Verte » dans l’exemple précédent et un partenaire « RATP » ou « SNCF ». Un échange se caractérise aussi par : 
** {color:#4c9aff}*son numéro de séquence*{color} afin d’assurer le récepteur qu’il n’a pas loupé un fichier et l’émetteur de générer le n° de séquence suivant,
** le radical du nom du fichier utilisé pour les échanges (lorsqu’il existe). Le nom du fichier étant complété par une date afin d’en assurer son unicité (cf. spécification des traitements batch),
** la liste des emails auxquels doit être adressé le fichier résultat,
** la liste des personnes à avertir par emails en cas de traitement défectueux .
* *Journal d'échange* : Chaque occurrence d’un échange fait l’objet d’un enregistrement dans ce journal. Chaque enregistrement est caractérisé par :
** le nom complet du fichier généré,
** la date d’enregistrement de l’échange dans le journal,
** {color:#4c9aff}*le numéro de séquence*{color} qui le caractérise

Le numéro de séquence transmis par le partenaire dans le fichier (au niveau de la ligne d’entête) est contrôlé par le SIG à chaque intégration de nouveau fichier. Ce contrôle peut être activé ou désactivé via un attribut du batch (i.e. {{ControleNumSequence}}) qui doit être défini dans le fichier .ini associé au batch. 



Suite à la mise en œuvre du ticket [https://comutitres.atlassian.net/browse/SIG-8834|https://comutitres.atlassian.net/browse/SIG-8834|smart-link], il est prévu que le partenaire “SIS” (code 1432) envoie au SIG des listes de ventes en provenance de 3 émetteurs différents, indiqués ci-dessous :

* 07001 : Canal Mobile
* 07002 : AMT SNCF
* 07003 : T10

On aura donc pour le partenaire SIS, des listes de ventes avec 3 codes possibles pour l'émetteur.

Ce fonctionnement sera différent de celui d’aujourd’hui car jusqu’à maintenant nous avions pour un partenaire donné (exemple : “RATP - GenEVE - Ventes Réseau dépositaire” code 24) un seul émetteur possible (“RATP - Vente Réseau Dépositaire - GenEVE” code 03019).  

A noter que la liste en provenance de l'émetteur Canal Mobile est déjà transmise aujourd’hui avec le partenaire SIS (code 1432). 

Aussi, le numéro de séquence de la liste de vente qui sera inscrit à la fois dans le nom du fichier et dans la ligne d’entête du fichier, sera un numéro séquentiel relatif à chacun des 3 émetteurs. Il y aura donc 3 numéros de séquences indépendants. 

Ces 3 émetteurs étant liés au même partenaire (SIS), le SIG détectera donc des erreurs de numéros de séquence si l’on conserve son fonctionnement actuel sur les numéros de séquence. 
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

En tant qu’exploitant je souhaite que le SIG puisse contrôler le numéro de séquence qui est associé au fichier reçu selon l'émetteur du fichier et non plus selon le partenaire du fichier, pour les listes ci-dessous, afin de ne pas avoir d’erreur lors de l’intégration de ces listes : 

* Liste de ventes SIS
* Liste de rechargement SIS 
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 

N/A
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|001|Fonctionnelle|Pour la liste de vente SIS, si le paramètre {{ControleNumSequence}} est activé, le numéro de séquence reçu dans le fichier doit être égal à la dernière séquence reçue pour cet échange avec cet émetteur + 1. Sinon un code erreur doit être remonté par le batch et le fichier ne doit pas être intégré.|
|002|Fonctionnelle|Pour la liste de rechargement SIS, si le paramètre {{ControleNumSequence}} est activé, le numéro de séquence reçu dans le fichier doit être égal à la dernière séquence reçue pour cet échange avec cet émetteur + 1. Sinon un code erreur doit être remonté par le batch et le fichier ne doit pas être intégré.|
|003|Fonctionnelle|Pour ces 2 listes, si le dernier numéro de séquence reçu est 999, le prochain numéro de séquence attendu est 001.|
|004|Fonctionnelle|Pour ces 2 listes, chaque occurrence d'échange doit faire l’objet d’un enregistrement dans le journal d'échanges, avec comme attributs : 
* Le numéro de séquence associé à l'émetteur.
* La date / heure d’enregistrement de l'échange  
* Le nom du fichier généré
* Le code état de l'échange 
** 1 : En cours 
** 2 : Traité
** 3 : Partiellement traité
** 9 : Echoué
* Le nombre d’enregistrement présents dans la liste|
|005|Fonctionnelle|Le SIG ne doit pas permettre l'intégration d’une liste de vente SIS si l’émetteur ne fait pas parti des émetteurs suivants (quel que soit la valeur du paramètre d’activation du contrôle de séquence)  : 
* 07001 : Canal Mobile
* 07002 : AMT SNCF
* 07003 : T10|
|006|Fonctionnelle|Le SIG ne doit pas permettre l'intégration d’une liste de la liste de rechargement SIS si l’émetteur ne fait pas parti des émetteurs suivants (quel que soit la valeur du paramètre d’activation du contrôle de séquence)  : 
* 07000 : SIS|
|007|Fonctionnelle|Pour ces 2 listes, le premier numéro de séquence attendu du SIG doit être le numéro 001.|
|008 {color:#ff5630}(ajout 21.07){color}|Fonctionnelle|A l’issue de l’intégration des fichiers, un fichier d’acquittement confirmation la réception d’une liste de ventes SIS doit être généré. Les règles de gestion pour sa génération doivent être les mêmes que pour les listes de rechargement SIS (cf  [https://comutitres.atlassian.net/browse/SIG-8623|https://comutitres.atlassian.net/browse/SIG-8623|smart-link])|",0,2
"FP409 - Refonte parcours SEL LOT 1 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : création d’un client dans le SIG*
{panel}|
|*ÉTANT DONNE QUE*           
Je suis les SEL|
|*QUAND*  
Je renseigne les attributs du nouveau WS|
|*ALORS*  
Le client est créé dans le SIG.| {panel:bgColor=#e3fcef}
*Contexte :*

Les parcours clients des Services En Ligne (SEL) sont refondus pour s'aligner sur le fonctionnement d'autres sites de souscription plus modernes et rendre ainsi le parcours client plus fluide.

Dans ce cadre, il serait également légitime de diminuer le nombre d'appels au SIG quand cela est possible.

L'idée serait donc de fusionner certaines API existantes pour limiter ces appels.
{panel}

{panel:bgColor=#deebff}
*Besoin :*

*En tant que SEL, je souhaite que la création d'un client dans le SIG n'appelle qu'un seul WS afin de minimiser la sollicitation du SIG.*

Le besoin ici consiste à fusionner REST-API-CLI-100-V2 (Enregistrer un client) et REST-API-CLI-131-V2 (Modifier les sollicitations d'un client)
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

 N/A
{panel}

h2. *Exigences* : 

 

||Référence||Type||Exigences||
|6774_001|Fonctionnelle|Un nouveau WS doit être créé en REST et respecter le [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1730413452/API+REST+Guide+de+d+veloppement|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1730413452/API+REST+Guide+de+d+veloppement|smart-link]|
|6774_002|Fonctionnelle|Le nouveau WS doit implémenter le contrat d’interface décrit en PJ : fusion de REST-API-CLI-100-V2 (Enregistrer un client) et REST-API-CLI-131-V2 (Modifier les sollicitations d'un client)|
|6774_003|Fonctionnelle|En sortie, si la création a réussi, le WS doit retourner la référence client SIG et un code retour 200|
|6774_004|Fonctionnelle|Si l'authentification échoue, le WS doit retourner un code 401 (_Unauthorized_)|
|6774_005|Fonctionnelle|Si l'action n'est pas autorisée, le WS doit retourner un code 403 (_Forbidden_)|
|6774_006|Fonctionnelle|Si la création n'a pas abouti car une des données obligatoires n'était pas renseignée, le WS doit retourner un code 400 (_Bad Request_) avec un message d'erreur spécifique|
|6774_007|Fonctionnelle|Si le service n'était pas disponible, le WS doit retourner un code 500 (_Internal Server Error_)|",0,2
nan,0,2
nan,0,2
nan,0,1
"FP875 - Sujet metier SIG 2023 S2 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : premier client avec un contrat NA à éditer et le deuxième avec un contrat actif*

voir le [https://comutitres.atlassian.net/browse/SIG-12546|https://comutitres.atlassian.net/browse/SIG-12546|smart-link]  pour le JDD
{panel}|
|*ÉTANT DONNE QUE*
Je suis exploitant SIG|
|*QUAND*
je le lance le batch de déduplication|
|*ALORS*
les contrats restent aux mêmes statuts|
|{panel:bgColor=#e3fcef}
*Scénario 2 : le client gardé n’est pas appairé et le client doublon est appairé*
{panel}|
|*ÉTANT DONNE QUE*
Je suis exploitant SIG|
|*QUAND*
je le lance le batch de déduplication|
|*ALORS*
le client gardé est bien appairé, le client doublon est désappairé et l’email du client gardé est remplacé par celui du client doublon.|
|{panel:bgColor=#e3fcef}
*Scénario 3 : les deux clients (actif et doublon) sont appairés*
{panel}|
|*ÉTANT DONNE QUE*
Je suis exploitant SIG|
|*QUAND*
je le lance le batch de déduplication|
|*ALORS*
le client gardé reste bien appairé et le client doublon est désappairé|
|{panel:bgColor=#e3fcef}
*Scénario 4 : les deux clients sont doublon et l’un d’eux est appairé*
{panel}|
|*ÉTANT DONNE QUE*
Je suis exploitant SIG.|
|*QUAND*
je le lance le batch de déduplication.|
|*ALORS*
l’appairage des deux clients ne change pas| {panel:bgColor=#e3fcef}
*Contexte* : Suite anos [https://comutitres.atlassian.net/browse/SIG-12546|https://comutitres.atlassian.net/browse/SIG-12546|smart-link] et [https://comutitres.atlassian.net/browse/SIG-12467|https://comutitres.atlassian.net/browse/SIG-12467|smart-link]  

nous avons constaté que : 

1- Le batch de dédoublonnage active un contrat double pour un client traité dans le processus de dédoublonnage

2- L’indicateur compte en ligne n’est pas pris en compte dans le processus de dédoublonnage
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

En tant que service client,  je souhaite que le batch BATCH-CLI-801 n’active plus le contrat en double lors du processus de dédoublonnage. 

En tant que service client,  je souhaite que le batch BATCH-CLI-801 transfère l’indicateur compte en ligne du client doublon vers le client actif, uniquement dans le cas où le client doublon est appairé et le client actif ne l’est pas.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|Ref 1|Fonctionnel|Ne pas activer -ni transférer-  le contrat non finalisé si le client actif (qu’on garde) procède déjà un contrat finalisé.
Pour cela et suite à l’analyse du code, il faudra ajouter la réévaluation du contrat NA lors du processus de déboulonnage.|
|Ref 2|Fonctionnel|Transférer l’indicateur de présence de compte en ligne et de l’adresse mail au client actif.
Le transfert se fait par un désappairage du client doublon et d’un appairage du client actif.
Warning: si l’appairage n’aboutit pas, il faudra loguer l’adresse mail et le numéro client à appairer pour qu’on puisse le faire manuellement. 
Ceci est à faire à la fin du processus de dédoublonnage et si un client actif est gardé. 
Si les clients actif et doublon sont appairés alors désappairer le doublon.
pour les autres cas : 
* les clients sont tous en doublons suspectés : alors ne rien faire.|",0,1
"FP602 - petits sujets techniques SIG 2022 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client
J’effectue une souscription via les SEL
Je saisis un payeur #porteur
Je renseigne une domiciliation bancaire française du payeur valide|
|*QUAND*
Le payeur modifie l’IBAN indiqué initialement|
|*ALORS*
Le nouvel IBAN est accepté
Le payeur accède bien à l'étape signature.
La souscription est valide.|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client
J’effectue une souscription via les SEL
Je saisis un payeur #porteur
Je renseigne une domiciliation bancaire de la zone SEPA hors France et Monaco du payeur valide|
|*QUAND*
Le payeur modifie l’IBAN indiqué initialement|
|*ALORS*
Le nouvel IBAN est accepté
Le payeur accède bien à l'étape signature.
La souscription est valide.|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client
J’effectue une souscription via les SEL
Je saisis un payeur #porteur
Je renseigne une domiciliation bancaire de la zone SEPA hors France et Monaco du payeur valide|
|*QUAND*
Le payeur valide l’IBAN indiqué par le porteur sans modification|
|*ALORS*
Le nouvel IBAN est accepté
Le payeur accède bien à l'étape signature.
La souscription est valide.| {panel:bgColor=#e3fcef}
Contexte :

L’anomalie [https://comutitres.atlassian.net/browse/SIG-8550|https://comutitres.atlassian.net/browse/SIG-8550|smart-link] évoque un problème historique dans le changement de domiciliation bancaire par le porteur suite à une souscription via les SEL

Quand un un client peut désigne un porteur <> payeur lors de sa souscription sur SEL,  un mail de confirmation est envoyé au payeur, avec en pièce jointe le contrat, le mandat et les CGVU associées au produit.

Le payeur a le droit de modifier l’IBAN renseigné par le porteur. En revanche, si cette action est effectuée, Le message “ Le format de l’iban n’est pas correct”  est affiché suite au motif bloquant 253 retourné par SIG.
{panel}



{panel:bgColor=#deebff}
Besoin :

En tant que PO, je souhaite supprimer le motif bloquant  “ Domiciliation Bancaire inconnue” retournée par le SIG suite à la mise à jour des coordonnées bancaires par le payeur dans le cadre d’une souscription SEL afin de permettre au client de  finaliser sa souscription

Lorsque le client payeur renseigne une nouvelle domiciliation bancaire lors de la souscription, cette domiciliation bancaire soit directement rattachée au client payeur et utilisée pour la souscription
{panel}

{panel:bgColor=#ffebe6}
Prérequis :
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|Ref 1|Technique|Supprimer le motif 253 suite au changement des coordonnées bancaires par le payeur lors d’une souscription via les SEL avec porteur<> payeur|
|Ref 2|Fonctionnelle|La souscription est validée, si le payeur saisit une nouvelle domiciliation bancaire lors de la souscription, cette nouvelle domiciliation bancaire est rattachée au payeur et utilisée.|",0,1
nan,0,2
"FP409 - Refonte parcours SEL LOT 1 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Enregistrer un document dans le SIG par REST-API-DOC-100 (action 22)*
{panel}|
|*ÉTANT DONNE QUE*
Je suis SELV2, consommateur de WS SIG|
|*QUAND*
Je soumets l’appel au SIG du WS sur un objet existant|
|*ALORS*
L'appel au WS se déroule avec succès et le document est bien enregistré dans le SIG.|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Enregistrer un client dans le SIG par REST-API-CLI-100 (action 1 Client)*
{panel}|
|*ÉTANT DONNE QUE*
Je suis SELV2, consommateur de WS SIG|
|*QUAND*
Je soumets l’appel au SIG du WS pour créer un client|
|*ALORS*
L'appel au WS se déroule avec succès et le client est bien créé dans le SIG.|
|{panel:bgColor=#e3fcef}
*Scénario 3 : Changer l’adresse d'un client dans le SIG par REST-API-CLI-110 (action 3 Client)*
{panel}|
|*ÉTANT DONNE QUE*
Je suis SELV2, consommateur de WS SIG|
|*QUAND*
Je soumets l’appel au SIG du WS sur un client existant|
|*ALORS*
L'appel au WS se déroule avec succès et l’adresse du client est bien modifiée dans le SIG.|
|{panel:bgColor=#e3fcef}
*Scénario 4 : Changer la domiciliation bancaire d'un client dans le SIG par REST-API-CLI-SEPA-120 (action 7 Client)*
{panel}|
|*ÉTANT DONNE QUE*
Je suis SELV2, consommateur de WS SIG|
|*QUAND*
Je soumets l’appel au SIG du WS sur un client existant|
|*ALORS*
L'appel au WS se déroule avec succès et la domiciliation bancaire du client est bien modifiée dans le SIG.|
|{panel:bgColor=#e3fcef}
*Scénario 5 : Recherche d'un client dans le SIG par REST-API-CLI-137 (action 90 Client)*
{panel}|
|*ÉTANT DONNE QUE*
Je suis SELV2, consommateur de WS SIG|
|*QUAND*
Je soumets l’appel au SIG du WS sur un client existant|
|*ALORS*
L'appel au WS se déroule avec succès et les donnés du client sont retournées.|
|{panel:bgColor=#fffae6}
Ce scénario doit être décliné avec les 2 autres WS de recherche client : *REST-API-CLI-138* et *REST-API-CLI-002*
{panel}|
|{panel:bgColor=#e3fcef}
*Scénario 6 : Recherche des domiciliations bancaires d'un client dans le SIG par REST-API-CLI-010 (action 300 Client)*
{panel}|
|*ÉTANT DONNE QUE*
Je suis SELV2, consommateur de WS SIG|
|*QUAND*
Je soumets l’appel au SIG du WS sur un client existant|
|*ALORS*
L'appel au WS se déroule avec succès et les donnés du client sont retournées.|
|{panel:bgColor=#e3fcef}
*Scénario 7 : Recherche contrat avec financier* *dans le SIG par REST-INT-API-CON-001* *(action 304 Contrat)*
{panel}|
|*ÉTANT DONNE QUE*
Je suis SELV2, consommateur de WS SIG|
|*QUAND*
Je soumets l’appel au SIG du WS sur un contrat existant|
|*ALORS*
L'appel au WS se déroule avec succès et les donnés du contrat sont retournées.|
|{panel:bgColor=#e3fcef}
*Scénario 8 : Enregistrer un contrat NA dans le SIG par REST-INT-API-CON-100 (action 1 Contrat)*
{panel}|
|*ÉTANT DONNE QUE*
Je suis SELV2, consommateur de WS SIG|
|*QUAND*
Je soumets l’appel au SIG du WS pour saisir un contrat NA|
|*ALORS*
L'appel au WS se déroule avec succès et le contrat NA est bien enregistré dans le SIG.|
|{panel:bgColor=#e3fcef}
*Scénario 9 : Enregistrer un commentaire libre sur un contrat NA dans le SIG par REST-INT-API-CON-490 (action 23 Contrat)*
{panel}|
|*ÉTANT DONNE QUE*
Je suis SELV2, consommateur de WS SIG|
|*QUAND*
Je soumets l’appel au SIG du WS pour enregistrer un commentaire libre sur un contrat NA|
|*ALORS*
L'appel au WS se déroule avec succès et le commentaire est bien enregistré dans le SIG.| {panel:bgColor=#e3fcef}
*Contexte :*

Dans le cadre du projet SEL V2, il est prévu que SEL V2 sollicite le SIG par web service afin de vérifier ou mettre à jour des données clients.
{panel}

{panel:bgColor=#deebff}
*Besoin :*

*En tant que SEL V2, je veux être reconnu du SIG avec un profil SELV2 afin d'être habilité à interroger des Web Services SIG.*

Le périmètre de ce récit couvre :

* La création d'un profil pour SEL V2
* La création de l'utilisateur lié au profil
* La création des habilitations pour le profil nouvellement créé

Les données pour le profil à créer sont :

* Acteur : GIE COMUTITRES (203)
* Code profil : SELV2_P
* Libellé : SELV2
* Description : Profil utilisé par les Services En Ligne V2
* Délai de rafraîchissement des messages d'alerte : 0
* Accès internet : autorisé
* Affichage écran d'évaluation : Non
* Durée validité du mot de passe : 90

Les données pour l'utilisateur à créer sont :

* Code : SELV2
* Nom : Site Services En Ligne V2
* Profil : SELV2_P
* Lieu d'accès par défaut : Paris
* Type : système
* Expiration du mot de passe : 06/09/2099

Les habilitations d'action à rattacher au profil doivent être :

* Objet : Administration (0) - Produit : Communautaire (0) - Action : 22 (Enregistrer un document) 
* Objet : Client (1) - Produit : Communautaire (0) - Action : 1 (Création du client) 
* Objet : Client (1) - Produit : Communautaire (0) - Action : 3 (Changement d’adresse) 
* Objet : Client (1) - Produit : Communautaire (0) - Action : 7 (Changement domiciliation bancaire)  
* Objet : Client (1) - Produit : Communautaire (0) - Action : 90 (Recherche client) 
* Objet : Client (1) - Produit : Communautaire (0) - Action : 300 (Recherche des dom bancaires d'un client) 
* Objet : Contrat (3) - Produit : Communautaire (0)- Action : 304 (Recherche contrat avec financier)
* Objet : Contrat (3) - Produit : Navigo Annuel (4) - Action : 1 (Saisie contrat commercial)
* Objet : Contrat (3) - Produit : Navigo Annuel (4) - Action : 23 (Enregistrement commentaire libre) 


{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

N/A
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|7826_001|Fonctionnel|Le SIG doit définir un profil pour SELV2|
|7826_002|Fonctionnel|Le SIG doit définir un utilisateur de type système rattaché au profil pour SELV2|
|7826_003|Fonctionnel|Le profil créé pour SELV2 doit être habilité pour les actions :
* 22 pour pour l’objet administration (0) et le produit communautaire (0)
* 1, 3, 7, 90 et 300 pour l’objet client (1) et le produit communautaire (0)
* 1, 23 et 304 pour l’objet contrat (3) et le produit NA (4)|",0,1
"FP500 - Plan de correction 2021 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*ÉTANT DONNE QUE*   
 Je suis admin SIG                                          |
|*QUAND*  
 Je modifie les délais de désactivation des utilisateurs|
|*ALORS*  
 Ces délais sont pris en compte par le batch BATCH-HAB-009|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*{panel}|
|*ÉTANT DONNE QUE*     
 Je suis admin SIG|
|*QUAND*    
 J'exécute le BATCH-HAB-009|
|*ALORS*
 Les comptes utilisateurs jamais utilisés depuis plus du délai en question sont désactivés
 Les comptes utilisateurs jamais utilisés depuis moins que ce délai sont toujours actifs
 Les comptes utilisateurs ayant été utilisés mais inactif depuis plus du délai en question sont désactivés
 Les autres comptes actifs sont toujours actifs| {panel:bgColor=#e3fcef}
*Contexte :*

 Forcer la désactivation d'un compte utilisateur jamais utilisé plus rapidement que pour un compte qui a été actif
{panel}

{panel:bgColor=#deebff}
*Besoin :*

Définir les délais avant désactivation des comptes utilisateurs avec distinction entre l'activité passée des comptes

Modifier le BATCH-HAB-009 pour forcer la désactivation d'un compte utilisateur sur un délai paramétrable plus court que pour la désactivation actuelle d'un compte anciennement actif
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

  
{panel}

h2. *Exigences :* 

[https://comutitres.atlassian.net/wiki/spaces/OR/pages/1866105595/FP500+-+Suppression+des+comptes+Utilisateurs+et+Profils+SIG+inutilis+s|https://comutitres.atlassian.net/wiki/spaces/OR/pages/1866105595/FP500+-+Suppression+des+comptes+Utilisateurs+et+Profils+SIG+inutilis+s|smart-link] 

 \[001]à \[004]
 ",0,1
nan,0,1
"FP875 - Sujet metier SIG 2023 S2 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* :  Un audit a été réalisé sur l’IHMC concernant le respect des règlementations d’accessibilité RGAA et les conclusions de cet audit ont mis en évidence plusieurs axes d’amélioration pour faire progresser la note d’accessibilité du site.

L’une des évolutions recommandées concerne les contractes au niveau des couleurs sur l’ensemble des pages de l’IHMC. En effet en faisant des tests via l’outil [https://webaim.org/resources/contrastchecker/|https://webaim.org/resources/contrastchecker/|smart-link] , on remarque que sur certaines pages la note de calcul des contrastes est en dessous des valeurs limites définies dans la doc RGAA [+https://accessibilite.numerique.gouv.fr/methode/criteres-et-tests/#3.2+|https://accessibilite.numerique.gouv.fr/methode/criteres-et-tests/]
{panel}

{panel:bgColor=#deebff}
*Besoin* : En tant que PO et utilisateur de l’IHMC, je souhaite que soit réalisée une étude pour identifier les pages pour lesquelles le contraste n’est pas suffisamment élevé entre la couleur du texte et celle de son arrière-plan mais également au niveau des composants d’interface et des éléments graphiques. Ceci afin de planifier l'évolution correspondante pour améliorer la note RGAA du site.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|12718_001|Fonctionnelle|Vérifier les contrastes entre la couleur du texte et celle de son arrière-plan. Pour réussir le test d’accessibilité il faudrait avoir un rapport de contraste d’au moins 4.5:1 via l’outil [https://webaim.org/resources/contrastchecker/|https://webaim.org/resources/contrastchecker/|smart-link]|
|12718_002|Fonctionnelle|Vérifier les contrastes pour avoir au niveau des composants d’interface et des éléments graphiques : 
!image-20230911-150804.png|width=170,height=66,alt=""Bouton et lien""!
●les boutons 
●les liens
●les composants images 
!image-20230911-150948.png|width=202,height=46!
●les indicateurs de force du password (vert et orange)
!image-20230911-151039.png|width=275,height=71!
 Pour réussir le test d’accessibilité il faudrait avoir un rapport de contraste d’au moins 3:1 via l’outil [https://webaim.org/resources/contrastchecker/|https://webaim.org/resources/contrastchecker/|smart-link]|
|12718_003|Fonctionnelle|Proposer un macrochiffrage pour l'évolution à mettre en place|
|12718_004|Fonctionnelle|Faire des propositions d'écrans pour les différents cas sus mentionnés à mettre en place pour passer les tests d’accessibilité.|",0,1
nan,0,1
nan,0,1
nan,0,2
nan,0,1
nan,0,2
nan,0,2
nan,0,1
nan,0,1
nan,0,1
nan,0,1
"FP687 - Plan de correction 2022 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*ÉTANT DONNE QUE*   
 Je suis admin SIG                                          |
|*QUAND*  
 J'exécute les traitements d'anonymisation des journaux d'événements|
|*ALORS*  Les données utilisateurs des événements de plus d'un an sont anonymisées| {panel:bgColor=#e3fcef}
*Contexte :*

Actuellement les journaux d'événements contiennent des données utilisateurs depuis l'origine du SIG
{panel}

{panel:bgColor=#deebff}
*Besoin :*

Mettre en place un traitement à ordonnancer afin d'anonymiser les données utilisateurs des tables des journaux d'événements
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

  exigences \[008] à \[012] développées
{panel}

h2. *Exigences :* 

[https://comutitres.atlassian.net/wiki/spaces/OR/pages/1866105595/FP500+-+Suppression+des+comptes+Utilisateurs+et+Profils+SIG+inutilis+s|https://comutitres.atlassian.net/wiki/spaces/OR/pages/1866105595/FP500+-+Suppression+des+comptes+Utilisateurs+et+Profils+SIG+inutilis+s|smart-link] 

 \[017] à \[018]
 ",0,2
nan,0,1
nan,0,2
"FP393 - Amélioration de l’IHMC SIG ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
Contexte :

Le but de cette US est de convertir les pages  « Evènement » en se basant sur les éléments graphiques de la nouvelle charte de l’IHMC SIG et indiquer les écrans IHMC qui correspondent à ces pages.
{panel}

{panel:bgColor=#deebff}
Besoin :

En tant qu’utilisateur de l’IHMC

Je souhaite que les écrans “Evènement” soient mis à la nouvelle charte graphique IHMC SIG

Afin d’améliorer l’IHMC.
{panel}

{panel:bgColor=#ffebe6}
Prérequis :

* Adapter la disposition des éléments graphiques aux différentes résolutions des écrans utilisées par les transporteurs à savoir 1024 x 769, 1280 X 1024 et 1920 X1080 en minimisant le scroll vers le bas d’écran.
* La nouvelle IHMC est supportée uniquement par Firefox 38+.
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|001|Fonctionnelle|Mettre l'Écran Evènement à la nouvelle charte graphique|
|002|Fonctionnelle|Adapter l'écran aux différentes résolutions des écrans utilisées par les transporteurs à savoir 1024 x 769, 1280 X 1024 et 1920 X1080 en réduisant le scroll vertical.|",0,2
"FP410 - Integration portail de mobilite ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte :*

Dans le cadre de la bascule Ma Mobilité, des clients pourraient se rendre en agence pour modifier leur identité (nom, prénom, date de naissance) alors que les exports des comptes ont déjà été réalisés, produisant une désynchronisation entre les données du SIG et celles des autres systèmes concernés.
{panel}

{panel:bgColor=#deebff}
*Besoin :*

*En tant que client, je veux que mes données d’identité modifiées en agence soient enregistrées sur mon compte Ile-de-France Connect afin de garantir la cohérence de mes données.*

Le besoin consiste à réaliser un script d’insertion dans la table E_CLT_APP_MODIF à partir d’un fichier en entrée identifiant la liste des références clients impactés par un changement d’identité après export et avant bascule (une ligne par client, chaque ligne ne contenant que la référence client).

Ceci permettra de relancer les traitements de synchronisation entre SIG et IDFM Connect, via la brique d’appairage.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

N/A
{panel}",0,1
nan,0,1
"FP393 - Amélioration de l’IHMC SIG ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un utilisateur de l’IHMC|
|*QUAND*
J’ouvre l’IHMC après authentification|
|*ALORS*
Un header est affiché en haut de l'écran avec le texte “IHMC SIG”| {panel:bgColor=#e3fcef}
*Contexte :*

Le but de cette US est d’ajouter un entête qui contient le texte : “ IHMC SIG “ en respectant la nouvelle charte de l’IHMC SIG.
{panel}

{panel:bgColor=#deebff}
*Besoin :*

 En tant qu’utilisateur de l’IHMC

Je souhaite que l'écran  s’affiche avec un entête  contenant le texte “IHMC SIG”

Afin de permettre à l’agent de distinguer entre IHMC SIG et le nouveau SIS.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|001|Fonctionnelle|Ajouter un header qui contient le texte “IHMC SIG”|
|002|Fonctionnelle|Mettre le header  à la nouvelle charte graphique|",0,1
nan,0,2
nan,0,1
"FP733 - Filiale - Recouvrement ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
l’exploitant du SIG intègre un fichier retour de IDFM sur les recouvrements réalisés|
|*QUAND*
le paramètre de passage à clôture est à True|
|*ALORS*
les contrats payés par les clients présents dans le fichier retour IDFM sont clôturés|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*
l’exploitant du SIG intègre un fichier retour de IDFM sur les recouvrements réalisés|
|*QUAND*
le paramètre de passage à clôture est à False|
|*ALORS*
les contrats payés par les clients présents dans le fichier retour IDFM sont résiliés gestionnaire| {panel:bgColor=#e3fcef}
*Contexte* : 

Dans le cadre de la filiale, la procédure de recouvrement forcé a été mise en place afin de ne plus abandonner de dette aux clients.

Pour cela une série de traitements a été développée permettant de gérer un nouvel état de contrat et de transférer la dette au comptable public

Une fois la situation réglée par le comptable public, IDFM envoie le retour à Comutitres sous la forme d’un fichier qui est alors intégré dans le SIG via le BATCH-CON-675.

Actuellement ce traitement passe les contrats concernés au statut Résilié gestionnaire et ils reviennent dans le processus de clôture au bout de trois ans
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

Afin de ne plus inclure un nouveau délai de trois ans suite à la résolution du recouvrement forcé avant de clôturer les contrats, il est demandé de passer directement à Clôturé les contrats lors de l’intégration du retour d’IDFM 
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|Ref 1|Fonctionnelle|Ajouter un paramètre dans le lancement du BATCH-CON-675 afin de pouvoir forcer la clôture des contrats au lieu de les passer à Résilié gestionnaire|

{panel:bgColor=#eae6ff}
Ma préconisation serait de modifier le libellé et le paramétrage de l’action 1309

 Ajouter un motif de clôture suite à recouvrement qui serait levé par le BATCH-CON-675 dans le cas ou le paramètre passé en entrée du traitement est à True.

Ajouter une priorité permettant de journaliser un nouvel événement dans le cas ou le motif est levé

Dans le traitement du batch, exclure les contrats au statut “Résilié gestionnaire” ou “Clôturé”
{panel}",0,2
"FE1000 - Archivage/suppression des données clients inactifs ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 3 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 4 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : 

L'étude FE1000 a pour objectif de répondre au besoin de se conformer à un des principes de la CNIL consistant à supprimer les données clients, 3 ans après la fin de la relation commerciale.
Aujourd’hui les traitements d’archivage/suppression de données clients s’exécutent 2 ans après la date de fin du dernier passe rattaché à un client.
IdFM estime que la relation contractuelle s’appuie sur la vente de titres de transport et non sur la possession d’un passe télébillettique actif permettant de
stocker ces titres de transport. 
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

L’objectif de cette étude est de : 

* Mettre à jour/compléter la page résumant les règles d’archivage/suppression de données SIG → [https://comutitres.atlassian.net/wiki/spaces/DA/pages/2940370995/SIG+-+R+gles+d+archivage+et+de+suppression+automatique|https://comutitres.atlassian.net/wiki/spaces/DA/pages/2940370995/SIG+-+R+gles+d+archivage+et+de+suppression+automatique|smart-link] 
* Étudier l’impact du fait de s’appuyer sur la date de fin du dernier titre de transport du client et non sur la date de fin de vie du passe comme date de référence pour l’archivage.
** Partir d’un droit au transport (impacts sur les différents produits) avec une date de fin dépassée de 5 ans avant de l’archiver
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 

N/A
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|Ref 1|Étude|Mettre à jour la documentation des règles d’archivage/suppression de données SIG|
|Ref 2|Étude|Étudier l’impact du changement de la date de référence sur les traitements d’archivage actuelles|",0,1
"FP866 - Petits sujets techniques SIG 2023 S1 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Cas passant 100%*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Cas passant 50%*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) : Cas KO 100% (technique / fonctionnel)*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : Dans le cadre de la modernisation SIG, nous procédons à la refonte du socle batch

Le batch PPT-BATCH-FIN-730 s’exécute au besoin et manuellement dans le cycle de facturation NL+ et permet de simuler le Contrôle d'intégration des mobilités par BUS d'évènements. Le cycle de facturation NL+ est constitué, dans l’ordre,  des traitements ci-dessous

h3. [PPT-BATCH-FIN-720 - Consolidation des factures avec les montants liés à la vie du contrat|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762531584/PPT-BATCH-FIN-720+-+Consolidation+des+factures+avec+les+montants+li+s+la+vie+du+contrat]

h3. [PPT-BATCH-FIN-800 - Relance du contrôle des mobilités|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762532197/PPT-BATCH-FIN-800+-+Relance+du+contr+le+des+mobilit+s] 

h3. Pour contourner un cas KO du batch PPT-BATCH-FIN-800 : [PPT-BATCH-FIN-730 - Contrôle intégration de mobilités consolidées|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762531585/PPT-BATCH-FIN-730+-+Contr+le+int+gration+de+mobilit+s+consolid+es]

h3. [PPT-BATCH-FIN-740 - Consolidation des factures avec les montants liés à la mobilité|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762531582/PPT-BATCH-FIN-740+-+Consolidation+des+factures+avec+les+montants+li+s+la+mobilit]

h3. [PPT-BATCH-FIN-750 - Finalisation des factures PPT|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762531583/PPT-BATCH-FIN-750+-+Finalisation+des+factures+PPT]

h3. [PPT-BATCH-FIN-752 - Relance des notifications des factures non éditées|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762532200/PPT-BATCH-FIN-752+-+Relance+des+notifications+des+factures+non+dit+es]

h3. [PPT-BATCH-FIN-501 - Identification des prélèvements Post-Paiement|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762531587/PPT-BATCH-FIN-501+-+Identification+des+pr+l+vements+Post-Paiement]
{panel}

{panel:bgColor=#deebff}
*Besoin* : Initialiser le nouveau socle batch avec le PPT-BATCH-FIN-730

L’adaptation des Logs applicatifs est traitée dans des US distinctes

*Le périmètre de cette US englobe :* 

{color:#bf2600}*– la seconde partie de l’initialisation :*{color}{color:#bf2600} {color}

* *Création du module* {{sig-ioc-batch}}
* *Implémenter le contexte d’exécution séquentielle*
* *Étendre le framework de test existant pour pouvoir tester le métier batch en isolation*

{color:#bf2600}*– La migration du batch :* {color}

* *Journaliser l'échange*
* *Porter le traitement métier*
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Type*||*Exigences*||
|Technique|Initialiser le nouveau socle batch - Partie 2 : 
* Implémenter le mécanisme d’injection de dépendances
* Implémenter la gestion des arguments
* Implémenter la génération du compte-rendu|
|Technique|Migration du batch - Partie 3 : 
* Journaliser l'échange
* Porter le traitement métier|

 ",0,2
nan,0,2
"FP605 - sujet metier SIG S1 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Chargement de la page des templates*
{panel}|
|*ÉTANT DONNE QUE* Je suis membre du service client|
|*QUAND* Je me connecte à la page des templates|
|*ALORS* Aucun template n’est coché par défaut| {panel:bgColor=#e3fcef}
*Contexte :* 

Sur la page d’upload des templates, le template FACCADAMET est coché par défaut, ce qui peut causer des erreurs
{panel}

{panel:bgColor=#deebff}
*Besoin :*

Ne pas avoir de template coché au chargement de la page
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|Ref 1|Type 1|Ne pas avoir de template coché par défaut au chargement de la page des templates|",0,1
nan,0,2
nan,0,1
nan,0,2
nan,0,2
"FP1085 - Petits sujets techniques SIG S1 2024 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : 
{panel}

{panel:bgColor=#deebff}
*Besoin* : Initialisation du module sig-ejb-client3 et conversion des sessions ClientSessionDistant et ClientSessionLocal
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Type*||*Exigences*||
|Technique|Initialisation du module sig-ejb-client3 et conversion des sessions ClientSessionDistant et ClientSessionLocal|",0,2
nan,0,2
nan,0,1
nan,0,2
nan,0,1
"FP1087 - Sujet metier SIG 2024 S1 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 3 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 4 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : 

Actuellement, avec un profil offshore, l'affichage du pavé « *Financement contrat tiers payant* » de l’onglet “*Données financières*” pour un client avec un financement TP est disponible ; les conseillers avec ce profil peuvent donc voir le TP qui finance un client particulier, ce qui pose problème d’un point de vue SSI dans certains cas (notamment pour la Gendarmerie Nationale aujourd’hui mais cela pourrait être étendu à d’autres TP).

Afin d’assurer la sécurité des données des agents du NATP gendarmerie, nous souhaiterions pouvoir masquer les données liées aux TP aux agents en offshore (les données des TP, mais aussi le rattachement à un TP dans le cas d’un client particulier).

{color:#36b37e}De même, l’accès aux données du TP via le menu de recherche d’un contrat tiers payant ne doit pas être autorisé pour ces TP “sensibles”.{color}
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

*Réaliser une étude afin d'élaborer une stratégie dans le SIG pour masquer l’affichage de la raison sociale de certains TP dits “sensibles” en offshore* {color:#36b37e}*ainsi que bloquer l’accès à ces données via une recherche du TP.*{color}

Ce masquage ne doit pas être généralisé, l’affichage de la raison sociale des TP non sensibles devant être conservé.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|13849_001|Fonctionnel|Réaliser une étude pour masquer les données des TP sensibles {color:#36b37e}et bloquer l’accès à ces données{color} pour les profils offshore|
|13849_002|Fonctionnel|Réaliser le macro-chiffrage associé à la (ou les) solution(s) proposée(s)|",0,1
"FP798 - Optimisation des communications ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Client NA avec passe en fin de vie et une adresse email renseignée dans le SIG*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client ayant un contrat NA
*ET* J’ai un passe 
*ET* {color:#bf2600}*j’ai une adresse mail enregistrée* {color}|
|*QUAND*
Mon passe NA va expirer|
|*ALORS*
Je dois recevoir un email deux mois avant la réception du passe m’incitant à confirmer mon adresse postale, ou le cas échéant la mettre à jour sur SEL, par téléphone ou en agence|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Client NA avec passe en fin de vie sans adresse email renseignée dans le SIG*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client ayant un contrat NA
*ET* J’ai un passe 
*ET* {color:#bf2600}*je n’ai pas une adresse mail enregistrée* {color}|
|*QUAND*
Mon passe NA va expirer|
|*ALORS*
Je dois recevoir un courrier avec le passe directement à mon adresse postale enregistrée dans le SIG.| {panel:bgColor=#e3fcef}
*Contexte* :

Actuellement, lors de l’envoi de Passe NA au client dans le cadre d’un renouvellement d’un passe en fin de vie, nous constatons un grand nombre de NPAI.
Afin d’éviter ces courriers non distribués et d’améliorer les  communications, il est nécessaire de créer un nouveau email qui semble manquant dans nos processus actuels.
{panel}

{panel:bgColor=#deebff}
*Besoin* :

*En tant que* membre du SC,

*Je souhaite* envoyer un email au client l’incitant à confirmer son adresse postale, ou bien la mettre à jour sur SEL avant de lui envoyer un nouveau passe NA dans le cadre de renouvellement d’un Passe en fin de vie

*Afin d'*éviter un NPAI 

*Le but est de créer un email pour que le client confirme son adresse postale avant l’envoi d’un nouveau passe.*
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|10047_001|Fonctionnelle|Créer un nouveau email en fin de vie d’un passe NA qui demande au client de confirmer son adresse postale|
|10047_002|Fonctionnelle|L’envoi de l’email de confirmation doit être :  à M-2 (60 jours) de la date de fin de vie du passe.|
|10047_003|Fonctionnelle|Le template de l’email est présenté en Pj
[^FDVPASSE V2 (aeda2189-df27-476a-938d-0ffdf28d94cc).docx]|
|10047_004|Fonctionnelle|Si le client n’a pas une adresse mail dans le SIG, le process actuel est conservé (envoi direct du courrier avec du Passe)|",0,2
nan,0,1
"FP971 - Driver périphérique billettiques poste agence (suite) ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Besoin 1 - Scénario 1 : Fichier bien créé avec le bon nom*
{panel}|
|*ÉTANT DONNE QUE* la nouvelle version SLS 1.4-3 a été installée|
|*QUAND* j’exécute les scripts demarre.sh, arret.sh et reparer.sh en user *root*|
|*ALORS* 
# les scripts s’exécutent bien et on n’a plus besoin de faire la ligne “sudo - u sls sls” puisque cette nouvelle version force le mode *sls*
# en exécutant la commande ls -l dans le répertoire contenant les logs, on constate que ces fichiers sont créés avec le nom d’user “SLS”|
|{panel:bgColor=#e3fcef}
*Besoin 2 - Scénario 1 : Fichier bien créé avec le bon nom*
{panel}|
|*ÉTANT DONNE QUE* je me suis connecté à IHMC sur un poste agence|
|*QUAND* j’ouvre /appli/SLS/var/etats/|
|*ALORS* le fichier ticketingReport.json existe|
|{panel:bgColor=#e3fcef}
*Besoin 2 - Scénario 2 : Structure du fichier*
{panel}|
|*ÉTANT DONNE QUE* je me suis connecté à IHMC sur un poste agence|
|*QUAND* j’ouvre /appli/SLS/var/etats/ticketingReport.json|
|*ALORS* le contenu du fichier respecte la structure citée dans l’exigence N°2|
|{panel:bgColor=#e3fcef}
*Besoin 2 - Scénario 3 : Contenu du fichier au lancement suite à l’installation puis reboot*
{panel}|
|*ÉTANT DONNE QUE* je me suis connecté à IHMC sur un poste agence|
|*QUAND* j’ouvre /appli/SLS/var/etats/ticketingReport.json|
|*ALORS* le contenu du fichier est le suivant : 
* ""sam"":
** ""date"":""""
** ""serialNumber"":""""
** ""personalizationCounter"":-1,
** ""personalizationCeiling"":-1,
** ""loadingCounter"":-1,
** ""loadingCeiling"":-1,
* ""sssrCall"":
** ""date"":""""
** ""type"":"""",
** ""InitRechargementSAM"":-1,
** ""AppelRechargementSAM"":-1,
* ""cardReader"":
** ""date"":""""
** ""state"":"""",
** ""statusCode"":-1,
** ""status"":"""",
+(La partie card et samReader peuvent potentiellement contenir une valeur)+|
|{panel:bgColor=#e3fcef}
*Besoin 2 - Scénario 4 : contenu du fichier suite à l’utilisation du lecteur/encodeur*
{panel}|
|*ÉTANT DONNE QUE* j’ai lu un passe  avec succès avec le lecteur encodeur|
|*QUAND* j’ouvre /appli/SLS/var/etats/ticketingReport.json|
|*ALORS* le contenu du fichier respecte exactement la valeur en {color:#ff5630}rouge{color} et structurellement les valeurs en {color:#36b37e}vert{color}
* ""sam"":
** ""date"":""{color:#36b37e}2023-04-18 15:03:29,804{color}""
** ""serialNumber"":""{color:#36b37e}aec2cf78{color}""
** ""personalizationCounter"":{color:#36b37e}289{color},
** ""personalizationCeiling"":{color:#36b37e}10000{color},
** ""loadingCounter"":{color:#36b37e}524{color},
** ""loadingCeiling"":{color:#36b37e}10000{color},
* ""sssrCall"":
** ""date"":""{color:#36b37e}2023-04-18 15:40:29,804{color}""
** ""type"":""{color:#36b37e}PERSONNALISATION{color}” OU “{color:#36b37e}CHARGEMENT{color}"" (cette variable est liée au dernier encodage qui donne un des deux types de jetons),
** ""InitRechargementSAM"":{color:#36b37e}0{color},
** ""AppelRechargementSAM"":{color:#36b37e}998{color},
* ""cardReader"":
** ""date"":""{color:#36b37e}2023-04-18 15:40:29,804{color}""
** ""state"":""{color:#ff5630}OK{color}"",
** ""statusCode"":{color:#ff5630}0{color},
** ""status"":""{color:#ff5630}API_STATUS_INIT_API_OK{color}"",|
|{panel:bgColor=#e3fcef}
*Besoin 2 - Scénario 4 bis : contenu du fichier suite à l’utilisation du lecteur/encodeur*
{panel}|
|*ÉTANT DONNE QUE* j’ai encodé avec succès un passe annuel avec le lecteur encodeur|
|*QUAND* j’ouvre /appli/SLS/var/etats/ticketingReport.json|
|*ALORS* le contenu du fichier respecte exactement la valeur en {color:#ff5630}rouge{color} et structurellement les valeurs en {color:#36b37e}vert{color}
* ""sam"":
** ""date"":""{color:#36b37e}2023-04-18 15:03:29,804{color}""
** ""serialNumber"":""{color:#36b37e}aec2cf78{color}""
** ""personalizationCounter"":{color:#36b37e}289{color},
** ""personalizationCeiling"":{color:#36b37e}10000{color},
** ""loadingCounter"":{color:#36b37e}524{color},
** ""loadingCeiling"":{color:#36b37e}10000{color},
* ""sssrCall"":
** ""date"":""{color:#36b37e}2023-04-18 15:40:29,804{color}""
** ""sessionType"": “{color:#ff5630}CHARGEMENT{color}"" (cette variable est liée au dernier encodage qui donne un des deux types de jetons),
** ""InitRechargementSAM"":{color:#36b37e}0{color},
** ""AppelRechargementSAM"":{color:#36b37e}998{color},
* ""cardReader"":
** ""date"":""{color:#36b37e}2023-04-18 15:40:29,804{color}""
** ""state"":""{color:#ff5630}OK{color}"",
** ""statusCode"":{color:#ff5630}0{color},
** ""status"":""{color:#ff5630}API_STATUS_INIT_API_OK{color}"",|
|{panel:bgColor=#e3fcef}
*Besoin 2 - Scénario 4 ter : contenu du fichier suite à l’utilisation du lecteur/encodeur*
{panel}|
|*ÉTANT DONNE QUE* j’ai encodé un passe personnalisé  avec succès avec le lecteur encodeur|
|*QUAND* j’ouvre /appli/SLS/var/etats/ticketingReport.json|
|*ALORS* le contenu du fichier respecte exactement la valeur en {color:#ff5630}rouge{color} et structurellement les valeurs en {color:#36b37e}vert{color}
* ""sam"":
** ""date"":""{color:#36b37e}2023-04-18 15:03:29,804{color}""
** ""serialNumber"":""{color:#36b37e}aec2cf78{color}""
** ""personalizationCounter"":{color:#36b37e}289{color},
** ""personalizationCeiling"":{color:#36b37e}10000{color},
** ""loadingCounter"":{color:#36b37e}524{color},
** ""loadingCeiling"":{color:#36b37e}10000{color},
* ""sssrCall"":
** ""date"":""{color:#36b37e}2023-04-18 15:40:29,804{color}""
** ""type"": “{color:#ff5630}PERSONNALISATION{color}"" (cette variable est liée au dernier encodage qui donne un des deux types de jetons),
** ""InitRechargementSAM"":{color:#36b37e}0{color},
** ""AppelRechargementSAM"":{color:#36b37e}998{color},
* ""cardReader"":
** ""date"":""{color:#36b37e}2023-04-18 15:40:29,804{color}""
** ""state"":""{color:#ff5630}OK{color}"",
** ""statusCode"":{color:#ff5630}0{color},
** ""status"":""{color:#ff5630}API_STATUS_INIT_API_OK{color}"",|
|{panel:bgColor=#e3fcef}
*Besoin 2 - Scénario 5 : Fonctionnement lecteur NOK / Appel au SSSR OK*
{panel}|
|*ÉTANT DONNE QUE* j’ai ouvert IHMC (auto test OK), j’ai débranché le lecteur encodeur puis j’ai lu un passe avec le lecteur encodeur (test KO)|
|*QUAND* j’ouvre /appli/SLS/var/etats/ticketingReport.json|
|*ALORS* le contenu du fichier respecte exactement la valeur en {color:#ff5630}rouge{color} et structurellement les valeurs en {color:#36b37e}vert{color}
* ""sam"": *(garde l'état précédent)*
** ""date"":""2023-04-18 15:03:29,804""
** ""serialNumber"":""aec2cf78""
** ""personalizationCounter"":289,
** ""personalizationCeiling"":10000,
** ""loadingCounter"":524,
** ""loadingCeiling"":10000,
* ""sssrCall"": *(garde l'état précédent)*
** ""date"":""2023-04-18 15:40:29,804""
** ""type"":""CHARGEMENT"",
** ""initRechargementSAM"":0,
** ""appelRechargementSAM"":998,
* ""cardReader"":
** ""date"":""2023-04-18 16:40:29,804""
** ""state"":""{color:#ff5630}*NOK*{color}"",
** ""statusCode"":{color:#ff5630}*2*{color},
** ""status"":""{color:#ff5630}*…?*{color}"",|
|{panel:bgColor=#e3fcef}
*Besoin 2 - Scénario 6 : Fonctionnement lecteur OK / Appel au SSSR NOK* {color:#ff5630}*(test à faire par Ali)*{color}
{panel}|
|*ÉTANT DONNE QUE* j’ai lu un passe avec le lecteur encodeur
commande pour supprimer le lien symbolique : sudo -u sls … (suppression du lien)
commande pour remettre le lien symbolique : sudo -u sls … (création du lien)|
|*QUAND* j’ouvre /appli/SLS/var/etats/ticketingReport.json|
|*ALORS* le contenu du fichier respecte exactement la valeur en {color:#ff5630}rouge{color} et structurellement les valeurs en {color:#36b37e}vert{color}
* ""sam"":
** ""date"":""2023-04-18 15:03:29,804""
** ""serialNumber"":""aec2cf78""
** ""personalizationCounter"":289,
** ""personalizationCeiling"":10000,
** ""loadingCounter"":524,
** ""loadingCeiling"":10000,
* ""sssrCall"":
** ""date"":""2023-04-18 15:40:30,804""
** ""type"":""PERSONNALISATION"",
** ""initRechargementSAM"":0, (0 si l’initialisation a fonctionné, )
** ""appelRechargementSAM"":{color:#36b37e}*10006*{color},( *si différent de 700, 998 et 999 → KO*)
* ""cardReader"":
** ""date"":""2023-04-18 15:40:29,804""
** ""state"":""{color:#ff5630}*OK*{color}"",
** ""statusCode"":{color:#ff5630}*0*{color},
** ""status"":""{color:#ff5630}*API_STATUS_INIT_API_OK*{color}"",| {panel:bgColor=#e3fcef}
*Contexte* : 

1- Si on démarre le sls en user root, le sls doit se lancer en user et group sls. Cela a un impact sur les logs SLS et possiblement sur d'autres choses. Pour plus de contexte, la maintenance se connecte en user root sur les postes et doivent parfois relancer le sls qu'il font en root et cela cause des anomalies de log sls qui sont créés en root.

2- Dans le souhait d'améliorer la supervision du poste IHMC et de sa billettique, il serait intéressant de regrouper certaines informations des logs SLS dans une structure de données (ex : JSON) qui est actualisée
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

1- Forcer l’exécution des scripts en user SLS dans la machine RATP V5

2- Mettre en place un fichier de logs sous format JSON qui contiendrait les informations suivantes : 

* La date de mise à jour de la structure
* Le numéro de SAM
* La valeur du plafond du compteur personnalisation
* La valeur actuelle du compteur personnalisation
* La valeur du plafond du compteur chargement
* La valeur actuelle du compteur chargement
* Code de retour de l'initialisation SSSR pour personnalisation (InitRechargementSAM Personnalisation)
* Code de retour de la notification SAM de personnalisation (AppelRechargementSAM Personnalisation)
* Code de retour de l'initialisation SSSR pour chargement (InitRechargementSAM chargement)
* Code de retour de la notification SAM de chargement (AppelRechargementSAM chargement)
* L'état du lecteur (ex : ""OK"",""HS"", ...)
* Le code retour du fonctionnement du lecteur associé à son état (ex : 0, 1, 2, 255, ...)
* La variable associée au code retour du fonctionnement du lecteur associé à son état (ex : API_STATUS_INIT_API_OK, API_STATUS_PB_COMM_CSC, API_STATUS_NO_SAM, API_STATUS_DEFAULT, ...)
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Type*||*Exigences*||
|Technique|Forcer l’exécution des scripts demarre.sh, arret.sh et reparer.sh en user SLS|
|Technique|Créer un fichier de log sous format JSON avec la structure suivante : 
* ""cardReader"":
** ""date"":""[string : année-mois-jour heure:minute:seconde,miliseconde (heure système)]""
** ""state"":""[string : OK or NOK]"", (état du lecteur : fonctionnel ou HS)
** ""statusCode"":[number], (code retour du lecteur)
** ""status"":""[string]"", (nom de variable associée au code retour du lecteur. La liste est fournie dans la solution)
* ""sam"":
** ""date"":""[string : année-mois-jour heure:minute:seconde,miliseconde (heure système)]""
** ""serialNumber"":""[string]"" (numéro de série du SAM)
** ""personalizationCounter"":[number], (valeur actuelle du compteur SAM personnalisation)
** ""personalizationCeiling"":[number], (valeur du plafond du compteur SAM personnalisation)
** ""loadingCounter"":[number], (valeur actuelle du compteur SAM chargement)
** ""loadingCeiling"":[number], (valeur du plafond du compteur SAM chargement)
* ""sssrCall"":
** ""date"":""[string : année-mois-jour heure:minute:seconde,miliseconde (heure système)]""
** ""sessionType"":""[string : PERSONNALISATION or CHARGEMENT]"", (Qui a fait l’appel au SSSR)
** ""initRechargementSAM"":[number], (valeur retournée par le SSSR)
** ""appelRechargementSAM"":[number], (valeur retournée par le SSSR)|
|Fonctionnel|+Les noms des variables+ 
sont issus de la documentation CALYPSO, le nom des variables est tout attaché avec la première lettre en minuscule et les mots suivants commençant par une Majuscule|
|Fonctionnel|Le JSON est en 3 parties pour mieux différencier chaque élément ainsi que son contenu|
|Fonctionnel|+Variables avec valeurs prédéfinies+ 
* Pour la variable « cardReader/state » deux valeurs sont possibles : OK ou NOK
* Pour la variable « sssrCall/sessionType » deux valeurs sont possibles : PERSONNALISATION ou CHARGEMENT
* cardReader/status : 
** API_STATUS_INIT_API_OK
** API_STATUS_NO_SAM
**|
|Fonctionnel|+Indentation+ 
Le fichier doit pouvoir être structurée par ligne comme au-dessus (à l’opposé de toutes les infos sur une ligne) si on éxecture une commande « cat » sur le fichier JSON. Le but est d’avoir une visibilité claire et rapide dès son ouverture
!image-20230420-091111.png|width=1412,height=836!|
|Fonctionnel|+Nom du fichier+
Le fichier de cette structure de données s’appelle « /appli/SLS/var/etats/*ticketingReport.json* »|
|Fonctionnel|+Actualisation des variables+
Les 3 parties étant indépendantes, elles ne sont pas actualisées au même moment donc une variable « date » est ajoutée à chaque partie pour savoir lorsque les données de chaque partie ont été mises à jour
* La structure de données est mise à jour au fur et à mesure du fonctionnement du SLS et donc en même temps que le log SLS se met à jour. Si le SLS s’arrête, la structure de données garde ses dernières valeurs. *Exemple* : Si dans le log SLS il y a un appel à rechargement du SAM au SSSR et que le log SLS indique les codes retours du SSSR alors il faut actualisé la structure de données avec les derniers codes retours du SSSR
* La structure de données est permanente, c’est-à-dire qu’elle n’est pas effacée si le SLS s’arrête ou redémarre ({color:#ff5630}et réinstallé ?{color})
* *Cas particulier d’actualisation des infos :* 
** l’actualisation de la structure de données si on passe par un compte maintenance SIG (autotest, personnalisation de passe, appel au SSSR,…) ? De même si on exécute une commande CURL (ex : curl [http://localhost:8080/v1/autotest/card-reader/sam)|http://localhost:8080/v1/autotest/card-reader/sam)] ?
*** → ça fera l’actualisation|
|Fonctionnel|+Alimentation initiale des variables au lancement du fichier de log+ (certaines variables n’ont pas encore de valeur à ce moment, par exemple les codes retours SSSR)
Lors de la première utilisation du SLS sur un poste (c-à-d juste après une installation), la structure n’a aucune donnée donc il faut définir par défaut la structure de la manière suivante : 
* -1 par défaut pour les valeurs décimales du json
* Guillemets vides pour les chaines de caractère. (La date est une chaine de carac)|
|Technique|+Emplacement du fichier dans le disque+ 
La structure de données est à placer dans /appli/SLS/var/etats/|
|Fonctionnel|+Quelques exemples de fonctionnement :+

* *Première installation du SLS*
** ""sam"":
*** ""date"":""""
*** ""serialNumber"":""""
*** ""personalizationCounter"":-1,
*** ""personalizationCeiling"":-1,
*** ""loadingCounter"":-1,
*** ""loadingCeiling"":-1,
** ""sssrCall"":
*** ""date"":""""
*** ""type"":"""",
*** ""initRechargementSAM"":-1,
*** ""appelRechargementSAM"":-1,
** ""cardReader"":
*** ""date"":""""
*** ""state"":"""",
*** ""statusCode"":-1,
*** ""status"":"""",
* *Exemple 1 : Fonctionnement lecteur OK / Appel au SSSR OK*
** ""sam"":
*** ""date"":""2023-04-18 15:03:29,804""
*** ""serialNumber"":""aec2cf78""
*** ""personalizationCounter"":289,
*** ""personalizationCeiling"":10000,
*** ""loadingCounter"":524,
*** ""loadingCeiling"":10000,
** ""sssrCall"":
*** ""date"":""2023-04-18 15:40:29,804""
*** ""type"":""PERSONNALISATION"",
*** ""initRechargementSAM"":0,
*** ""appelRechargementSAM"":998,
** ""cardReader"":
*** ""date"":""2023-04-18 15:40:29,804""
*** ""state"":""OK"",
*** ""statusCode"":0,
*** ""status"":""API_STATUS_INIT_API_OK"",
* *Exemple 2 : Fonctionnement lecteur NOK*
** ""sam"": (garde l'état précédent)
*** ""date"":""2023-04-18 15:03:29,804""
*** ""serialNumber"":""aec2cf78""
*** ""personalizationCounter"":289,
*** ""personalizationCeiling"":10000,
*** ""loadingCounter"":524,
*** ""loadingCeiling"":10000,
** ""sssrCall"": (garde l'état précédent)
*** ""date"":""2023-04-18 15:40:29,804""
*** ""type"":""CHARGEMENT"",
*** ""initRechargementSAM"":0,
*** ""appelRechargementSAM"":998,
** ""cardReader"":
*** ""date"":""2023-04-18 16:40:29,804""
*** ""state"":""NOK"",
*** ""statusCode"":2,
*** ""status"":""API_STATUS_NO_SAM"",
* *Exemple 3 : Fonctionnement lecteur OK / Appel au SSSR NOK*
** ""sam"":
*** ""date"":""2023-04-18 15:03:29,804""
*** ""serialNumber"":""aec2cf78""
*** ""personalizationCounter"":289,
*** ""personalizationCeiling"":10000,
*** ""loadingCounter"":524,
*** ""loadingCeiling"":10000,
** ""sssrCall"":
*** ""date"":""2023-04-18 15:40:30,804""
*** ""type"":""PERSONNALISATION"",
*** ""initRechargementSAM"":0,
*** ""appelRechargementSAM"":10006,
** ""cardReader"":
*** ""date"":""2023-04-18 15:40:29,804""
*** ""state"":""OK"",
*** ""statusCode"":0,
*** ""status"":""API_STATUS_INIT_API_OK"",
* *Exemple 4 : Fonctionnement lecteur OK / Appel au SSSR NOK car première installation*
** ""sam"":
*** ""date"":""2023-04-18 15:03:29,804""
*** ""serialNumber"":""aec2cf78""
*** ""personalizationCounter"":289,
*** ""personalizationCeiling"":10000,
*** ""loadingCounter"":524,
*** ""loadingCeiling"":10000,
** ""sssrCall"":
*** ""date"":""""
*** ""type"":"""",
*** ""initRechargementSAM"":-1,
*** ""appelRechargementSAM"":-1,
** ""cardReader"":
*** ""date"":""2023-04-18 15:03:29,804""
*** ""state"":""OK"",
*** ""statusCode"":0,
*** ""status"":""API_STATUS_INIT_API_OK"",|",0,2
"FP1054 - Evolutions iR C24 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
La campagne est ouverte en base de données au 01/02 de l’année N|
|*QUAND*
Je souscris un forfait iRS ou iRE en date du 15/02 (SEL, Formulaire papier ou FàF)|
|*ALORS*
Mon forfait est créé sur la campagne N|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*
La date limite de souscription est positionnée au 30/01|
|*QUAND*
Je souscris un forfait iRS ou iRE en date du 10/02 (SEL, Formulaire papier ou FàF)|
|*ALORS*
La souscription est refusée avec le motif Date de saisie invalide|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
La campagne est ouverte en base de données au 01/02 de l’année N et l’ancienne campagne est fermée  au 01/02|
|*QUAND*
Je souscris un forfait iRS en date du 15/01|
|*ALORS*
La souscription est refusée avec le motif Date de saisie invalide| {panel:bgColor=#e3fcef}
*Contexte* : Dans le cadre de certaines évolutions iR liées à l’ouverture de campagne dans le SIG, nous rencontrons des problèmes avec la RBB qui n’a pas la possibilité d’activer la date triche car celle ci n’existe pas sur les autres Assets
{panel}

{panel:bgColor=#deebff}
*Besoin* : Pouvoir mettre en place une gestion des dates d’ouverture et de fin de campagne ainsi que la date de fin de souscription permettant à la RBB de pouvoir tester les évolutions iR
{panel}

{panel:bgColor=#eae6ff}
*Note*: Sujet identifié dans le cadre de l’anomalie [[SIG-13727] [R15 - R8] Problème de complétion de contrat IRE - Jira (atlassian.net)|https://comutitres.atlassian.net/browse/SIG-13727] 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|Ref 1|Technico-Fonctionnelle|La date de début de campagne doit être récupérée en base de données dans la table E_REF_PARMETRE_TYPE_CONTRAT pour définir la campagne active lors d’une souscription ou d’une complétion iR (scolaire et étudiant)|
|Ref 2|Technico-Fonctionnelle|La date limite de souscription pour une campagne actuellement définie au 30/04 de l’année N+1 de la campagne doit pouvoir être modifiable|
|Ref 3|Technico-Fonctionnelle|Le libellé de ce paramètre doit indiquer qu’il n’est modifiable que dans le but de réaliser la RBB et qu’il doit rester dans un intervalle entre le 01/01 et le 30/04|",0,2
nan,0,2
nan,0,1
"FP867 - Petits sujets techniques SIG 2023 S2 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : Dans le cadre de la modernisation de SIG, une étude a été réalisée pour identifier les gains de mettre à jour la version d’EJB. Cette étude met en avant deux opporunités : 

* Migration des services métier EJB2.1 en service EJB3 
* Migration de la persistance EJB2.1 en implémentation JPA

Si EJB 2.1 a été abandonné c'est parce que cette technologie souffre de plusieurs problèmes importants :

* la lourdeur d'écriture impactant la productivité
* la complexité de mise en œuvre entravant la maintenance
* le besoin de formation spécifique du fait de la quasi absence de profils sur le marché connaissant cette technologie
* la limite des services rendues par l’api de fait qu’elle n’est plus développée depuis 2004
{panel}

{panel:bgColor=#deebff}
*Besoin* : Porter les ejb évènements mouvements financiers entité
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : [https://comutitres.atlassian.net/browse/SIG-12285|https://comutitres.atlassian.net/browse/SIG-12285|smart-link] 
{panel}

h2. Exigences : 

||*Type*||*Exigences*||
|Technique|organiser l'implémentation des entités évènements mouvements financiers JPA  en parallèle des EJB entité équivalent|
|Technique|Vérifier la cohabitation dans Weblogic 12.2|
|Documentation|Préciser dans la solution la version des EJB et JPA utilisés|
|Documentation|Précision dans la solution le nombre de services et d'entités impactés|",0,2
nan,0,2
nan,0,1
"FP602 - petits sujets techniques SIG 2022 ||Cas d'utilisation||
|{panel:bgColor=#deebff}
*Scénario 1 (NR) :*
{panel}|
|*ÉTANT DONNE QUE* je suis un utilisateur ayant besoin de faire plusieurs appels WS|
|*QUAND* je fais plusieurs appels WS d’affilés avec le même profil|
|*ALORS* Les appels sont bien effectués| {panel:bgColor=#e3fcef}
*Contexte :*

A chaque appel de WS, des vérifications d’habilitation sont effectuées en base de données (verifierActionAutorisee, rechercherUtilisateurParCode,…),
{panel}

{panel:bgColor=#deebff}
*Besoin :*

 Nous souhaitons étudier la mise en cache du résultat de ces requêtes via l’AOP.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

  Mise en place de l’AOP et [https://comutitres.atlassian.net/browse/SIG-1914|https://comutitres.atlassian.net/browse/SIG-1914|smart-link] 
{panel}

h2. *Exigences :*

 

||Référence||Type||Exigences||
|Ref 1|Type 1|Mise en cache de certaines vérification d’habilitations dans les WS|",0,1
nan,0,2
nan,0,1
nan,0,1
nan,0,1
nan,0,1
nan,0,2
"FE1162 - SIS - Audit multi assets ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 3 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 4 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : 

Un audit de nos assets va être réalisé par Sopra afin de

* Définir et sélectionner la solution cible de la billettique IDFM / Comutitres ;
* Réaliser un diagnostic fonctionnel et technique ;
* Accompagner dans la formalisation de la stratégie billettique pour aligner les enjeux métiers et SI aux évolutions à venir.
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

Afin de préparer les éléments nécessaires à l’audit Sopra, nous souhaitons rédiger un DAT au format IDFM Word (voir PJ) pour l'asset suivant :

* SIG
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|13394_001|Technique|Rédiger un DAT au format IDFM Word pour l'asset SIG|",0,1
"FP847 - IR C23 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : client IRS avec numéro de téléphone renseigné* 
{panel}|
|*ÉTANT DONNE QUE* Je suis un agent CRC|
|*QUAND* La date de début de validité de forfait d’un client IRS est dans 8 jours et que ce dernier n’a pas encore recharger son forfait|
|*ALORS* Une action en attente d’envoie d'SMS de rappel de rechargement au payeur s’affiche
*ET* La liste déroulante de choix de l’action manuelle comporte l’action d’envoi de SMS de rappel de rechargement au payeur
*ET* quand je valide ce choix, l’action en attente disparait.|
|{panel:bgColor=#e3fcef}
*Scénario 2 :  client IRS avec numéro de téléphone non renseigné* 
{panel}|
|*ÉTANT DONNE QUE* Je suis un client IRS|
|*QUAND* La date de début de validité de forfait est dans 8 jours et que je n’ai pas encore recharger mon forfait|
|*ALORS* le payeur de mon forfait reçoit un mail de rappel pour recharger mon forfait| {panel:bgColor=#e3fcef}
*Contexte* : Chaque année et à l’aide d’une requête lancée manuellement, CRC effectue une campagne “passe à recharger” qui consiste à contacter les clients(remontés par la requête) par SMS ou mail 8 jours avant la date de début de validité du forfait pour rappeler aux clients d'aller charger leur passe. Cette campagne est menée du mois d'août au mois de décembre (inclus)
{panel}

{panel:bgColor=#deebff}
*Besoin* : En tant qu’exploitant SIG, je souhaite automatiser la gestion de la compagne “passe à recharger” afin de:

* Poster une action d’envoi de SMS au payeur pour lui rappeler le rechargement de passe du porteur 8 jours avant la date de début de validité de son forfait, si le numéro de téléphone du payeur est renseigné
* Si non d’envoyer l'email en PJ au payeur
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : Avoir un passe  à l'état “A recharger” 8 jours avant la date de début de validité du forfait.
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|Ref 1|Fonctionnelle|Poster une action CRC d’envoi de SMS au payeur pour lui rappeler le rechargement de passe du porteur 8 jours avant la date de début de validité de son forfait, si le numéro de téléphone du payeur est renseigné|
|Ref 2|Fonctionnelle|Le SIG doit envoyer le mail (en PJ au payeur) de rappel de rechargement de passe 8 jours avant la date de début de validité du forfait du client si le numéro de payeur n'est pas renseigné|
|Ref 3|Fonctionnelle|L’action manuelle contrat “Envoie SMS pour rappel de rechargement de passe” doit être créée pour le produit imagine R scolaire (code 1)|",0,2
nan,0,2
"FP874 - Sujet metier SIG 2023 S1 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Spécifications à jour*
{panel}|
|*ÉTANT DONNE QUE*
Je suis PO|
|*QUAND*
Je fais référence aux spécifications du SIG|
|*ALORS*
Ces spécifications sont conformes au code| {panel:bgColor=#e3fcef}
*Contexte* : Une page de recensement des spécifications en décalage avec le code ou dont les règles de gestion sont sujettes à interrogation a été créée : [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741940886/Grand+recensement+des+sp+cifications+douteuses|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741940886/Grand+recensement+des+sp+cifications+douteuses|smart-link]

Cette page est alimentée au fur et à mesure de la découverte des non conformités.
{panel}

{panel:bgColor=#deebff}
*Besoin* : *En tant que PO du SIG, je souhaite que les spécifications soient le reflet du code afin d’en assurer la conformité.*

Le besoin consiste à traiter les différents points de la page de [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741940886/Grand+recensement+des+sp+cifications+douteuses|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741940886/Grand+recensement+des+sp+cifications+douteuses|smart-link] afin de remettre en cohérence spécifications et code.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|11714_001|Fonctionnel / rédactionnel|Mise en conformité des spécifications selon [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741940886/Grand+recensement+des+sp+cifications+douteuses|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741940886/Grand+recensement+des+sp+cifications+douteuses|smart-link]|",0,1
nan,0,1
"FP741 - Filiale - Gestes Co ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :  effectuer un remboursement par un agent 3T*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un agent 3T|
|*QUAND* 
je clique sur le menu “Enregistrer un remboursement”|
|*ALORS*
Le nouvel écran de demande de remboursement qui doit être affiché|
|{panel:bgColor=#e3fcef}
*Scénario 2 : effectuer un remboursement pour un conseiller CRC*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un conseiller CRC|
|*QUAND* 
je clique sur le menu “Enregistrer un remboursement”|
|*ALORS*
Le nouvel écran de demande de remboursement qui doit être affiché| {panel:bgColor=#e3fcef}
*Contexte* : Dans le cadre de la filialisation de Comutitres par IDFM, Un certain nombre d’actions sont à mettre en place pour se conformer à la réglementation légale liée à la filiale.

Parmi les actions demandées c’est la création d'un nouvel écran dédier au demande de remboursement consultable depuis le menu “Enregistrer un remboursement” pour les agents et les partenaires de la gestion client.
{panel}

{panel:bgColor=#deebff}
*Besoin* : En tant qu’utilisateur IHMC, je souhaite effectuer une demande de remboursement via le nouveau écran (maquette ci-joint)
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|Ref 1|Fonctionnel|Développer un nouvel écran (maquette ci-joint) pour les demandes des remboursements pour tous les produits (NA, iRS, iRE, NMS et NL+) pour les deux IHMC|",0,2
nan,0,2
nan,0,2
"FP1085 - Petits sujets techniques SIG S1 2024 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : 
{panel}

{panel:bgColor=#deebff}
*Besoin* : Remplacement des EJB Module Contrat 4
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Type*||*Exigences*||
|Technique|Remplacement des EJB Module Contrat 4|",0,1
nan,0,1
"FP569 - Stockage factures SIMS UN premier test d'acceptation est la vérification du paramétrage évènement selon la SOLU proposée.

 

||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : non régression*
{panel}|
|*ÉTANT DONNE QUE* je suis l'exploitant
*ET* que j'ai lancé tous les traitements de la facturation NL+ (consolidation des frais et avoir, contrôle de mobilités)|
|*QUAND* je lance le traitement de finalisation des factures|
|*ALORS* les factures sont finalisées (aussi bien avoirs que factures)
*ET* aucune action d'envoi d'email n'est postée|

  {panel:bgColor=#e3fcef}
*Contexte :* Le batch PPT-BATCH-FIN-750 a pour but de finaliser la facture. Durant son exécution, il va lever des motifs utilisé lors de la journalisation de l'action 1146 pour les contrats NL+. Ces motifs donneront lieu à l'enregistrement d'une action en attente d'envoi d'email (1195, 1196 ou 1197).

Ces actions doivent alors être consommées par un batch spécifique de traitement d'email. BATCH-COU-550. Or la volumétrie importante des emails à envoyer fait que l'on utilise une solution externalisée pour l'envoi d'email par le prestataire CRC. Poster les actions d'envoi d'email est donc inutile. 
{panel}

{panel:bgColor=#deebff}
*Besoin :* Ne plus poster les actions en attente d'envoi d'email, suite à la finalisation des factures sur des contrats NL+. 
{panel}

h2. Exigences :

||Référence||Type||Exigences||
|01|Fonctionnel|Le traitement de finalisation des factures ne doit plus poster des actions en attente d'envoi d'email pour notifier le client de la présence d'une nouvelle facture.|",0,2
nan,0,2
nan,0,2
"FP867 - Petits sujets techniques SIG 2023 S2 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : Dans le cadre de la modernisation de SIG, une étude a été réalisée pour identifier les gains de mettre à jour la version d’EJB. Cette étude met en avant deux opporunités : 

* Migration des services métier EJB2.1 en service EJB3 
* Migration de la persistance EJB2.1 en implémentation JPA

Si EJB 2.1 a été abandonné c'est parce que cette technologie souffre de plusieurs problèmes importants :

* la lourdeur d'écriture impactant la productivité
* la complexité de mise en œuvre entravant la maintenance
* le besoin de formation spécifique du fait de la quasi absence de profils sur le marché connaissant cette technologie
* la limite des services rendues par l’api de fait qu’elle n’est plus développée depuis 2004
{panel}

{panel:bgColor=#deebff}
*Besoin* : Porter les ejb document entité
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : [https://comutitres.atlassian.net/browse/SIG-12285|https://comutitres.atlassian.net/browse/SIG-12285|smart-link] 
{panel}

h2. Exigences : 

||*Type*||*Exigences*||
|Technique|organiser l'implémentation des entités document JPA  en parallèle des EJB entité équivalent|
|Technique|Vérifier la cohabitation dans Weblogic 12.2|
|Documentation|Préciser dans la solution la version des EJB et JPA utilisés|
|Documentation|Précision dans la solution le nombre de services et d'entités impactés|",0,2
nan,0,1
nan,0,2
nan,0,1
nan,0,1
"FP393 - Amélioration de l’IHMC SIG ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Menu Système*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un conseillers CRC utilisant la nouvelle IHMC|
|*QUAND*
Je clique sur le menu *Système*|
|*ALORS*
L’entrée de menu *gestion des messages* n’est pas affiché|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Menu Référentiel*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un conseillers CRC utilisant la nouvelle IHMC|
|*QUAND*
Je clique sur le menu Référentiel|
|*ALORS*
Les entrées de menu Gérer un type de contrat et Gérer un produit ne sont pas affichés| {panel:bgColor=#e3fcef}
*Contexte* : 

Le but de cette US est d’afficher les écrans ci-dessous uniquement sur l’IHMC1 et de les cacher pour l’IHMC2 en attendant de les décomissionner après la bascule sur l’IHMC2.

* Filtrer l’affichage du menu Système pour les écrans « Gestion des messages ».

* Menu Référentiel, cacher les écrans Gérer un type de contrat et Gérer un produit et Création d’un établissement bancaire.
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

En tant qu’un utilisateur de la nouvelle IHMC

Je souhaite que les entrées de menu Système\\gestion des messages et Référentiel / Gérer un type de contrat, Gérer un produit  et  Création d’un établissement bancaire soient masqués

Afin d’afficher que les écrans portés.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|001|Fonctionnelle|Filtrer l’affichage des menus Système\\gestion des messages, Référentiel/Gérer un type de contrat, Gérer un produit  et création d’un établissent bancaire afin qu’ils soient affichés uniquement pour l’IHMC1.|",0,1
nan,0,1
"FP847 - IR C23 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
je suis  un client iRS ayant réalisé ma souscription de puis les SEL mais que ma souscription n’a pas été enregistrée dans le SIG mais que l’encaissement est bien présent sur le contrat à l'état inexistant|
|*QUAND*
SEL soumet de nouveau la souscription|
|*ALORS*
l’encaissement n’est pas enregistré une seconde fois sur le contrat du client|
|{panel:bgColor=#deebff}
*Scénario 2 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
je suis un client réalisant ma souscription iRS ou iRE depuis les SEL|
|*QUAND*
je valide|
|*ALORS*
mon contrat est enregistré dans le SIG (état du contrat dépendant des PJ nécessaires ou déjà présentes)| {panel:bgColor=#e3fcef}
*Contexte* : 

[https://comutitres.atlassian.net/browse/SIG-11602|https://comutitres.atlassian.net/browse/SIG-11602|smart-link]

Le contrat a deux paiements dans le SIG

Lorsqu’un client fait une souscription au comptant d’un contrat iR depuis les Services En Ligne, il doit s’acquitter du montant de son abonnement et des frais de souscription en payant par CB.

Dans ce cas, SEL appelle un  première fois le SIG pour enregistrer la transaction CB via le WS API-DOC-100-V2 (qui crée le contrat à l'état inexistant)

Ensuite SEL réalise la souscription en appelant le WS API-CON-100 (IRS-API-CON-100, IRE-API-CON-100,…)

Ce dernier réalise deux actions : 

* l’encaissement sur le contrat du paiement qui journalise l'événement  1236 “Encaissement SEL effectué”
* la souscription du contrat avec les différentes PJ à valider ou non

En cas d'échec lors de la souscription (du type erreur inattendue potentiellement due à un problème WebLogic), l’encaissement reste enregistré sur le contrat mais retourne une erreur inattendue à SEL. 

La souscription est alors recyclée pour être soumise de nouveau au SIG par SEL

Lors de ce second appel, le SIG enregistre de nouveau un encaissement sur le contrat du client. Ce contrat se retrouve de ce fait avec deux encaissement enregistré alors qu’il n’y en a eu véritablement qu’un seul  
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

En tant que gestionnaire comptable

Je veux que le SIG n’enregistre pas un second encaissement sur un contrat lors d’une souscription si le contrat a déjà un solde 

Afin de ne plus avoir de régularisation financière à passer sur ces contrats
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : Pouvoir trouver une situation qui fait que l’appel au WS IRS-API-CON-100 va renvoyer une erreur inattendue

à voir avec ESI comment réduire le cache EJB sur les environnements de recette afin de tenter de reproduire le dysfonctionnement de base
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|Ref 1|Type 1|En cas de souscription d’un contrat iR depuis les SEL, si le contrat est à l'état inexistant avec un solde positif correspondant au montant du forfait restant à charge du client quand dans les informations de souscription il y a la présence d’un paiement alors celui ci ne doit pas générer un encaissement sur le contrat|

{panel:bgColor=#eae6ff}
l'encaissement ne doit pas être enregistré si toutes les conditions suivantes sont vérifiées : 

* Produit 1 ou 2
* Contrat créé dans le SIG à l'état inexistant
* Solde du contrat en faveur du client (un encaissement a déjà été réalisé sur le contrat)
* Le montant encaissé lors de la souscription est égal au montant du solde  du contrat
{panel}",0,1
"FP920 - Ma Mobilité 1.2 MVP ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Saisie de données clients (nom / prénom) à l’IHMC*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un agent commercial transporteur|
|*QUAND*
Je saisis à l’IHMC des données clients ne correspondant pas à l’exigence 12490_001|
|*ALORS*
J’obtiens un message bloquant.|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Saisie de données clients (nom / prénom) par WS*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client ayant un espace personnel|
|*QUAND*
Je crée ma fiche client avec des données ne correspondant pas à l’exigence 12490_001|
|*ALORS*
J’obtiens un message bloquant.|
|{panel:bgColor=#e3fcef}
*Scénario 3 : Saisie de données clients par batch (BATCH-CON-920)*
{panel}|
|*ÉTANT DONNE QUE*
Je suis exploitant du SIG|
|*QUAND*
Je soumets un traitement des justificatifs RIB-APA multi produit pour un nouveau payeur dont les données client ne correspondent pas à l’exigence 12490_001|
|*ALORS*
Le traitement remonte les motifs bloquants.|
|{panel:bgColor=#e3fcef}
*Scénario 4 : Saisie de données clients par batch (XX-BATCH-CON-100)*
{panel}|
|*ÉTANT DONNE QUE*
Je suis exploitant du SIG|
|*QUAND*
Je soumets un traitement contenant des données client ne correspondant pas à l’exigence 12490_002|
|*ALORS*
Le client est créé avec une civilité NULL en BDD.|
|{panel:bgColor=#deebff}
*Scénario 5 (NR) : Saisie de données clients par batch (XX-BATCH-CON-100)*
{panel}|
|*ÉTANT DONNE QUE*
Je suis exploitant du SIG|
|*QUAND*
Je soumets un traitement contenant des données client ne correspondant pas à l’exigence 12490_001|
|*ALORS*
Le traitement remonte les motifs bloquants.| {panel:bgColor=#e3fcef}
*Contexte* : 

Le projet Ma Mobilité lot 1.2 concerne les adaptations des assets SIG et APP à la version R5 du SIS et de la brique Tap2Use permettant de gérer les comptes IDFM Connect, ce qui entraine des changements pour l’asset APP (qui doit discuter avec SIS et non plus IDFM Connect) ainsi que l’asset SIG car les règles de gestion concernant les données des clients appairés évoluent.

Une étude a été réalisée [https://comutitres.atlassian.net/wiki/spaces/EP/pages/2843804246/MC+SIG-11405+Macro-chiffrage+tude+MM1.2+MVP|https://comutitres.atlassian.net/wiki/spaces/EP/pages/2843804246/MC+SIG-11405+Macro-chiffrage+tude+MM1.2+MVP|smart-link] afin d’identifier les impacts APP et SIG liés au MVP. Un nettoyage des données clients (nom, prénom, civilité et mobile) est notamment nécessaire afin de véhiculer des données conformes dans le processus de synchronisation entre SIG et SIS, via APP et est traité dans la [https://comutitres.atlassian.net/browse/SIG-12029|https://comutitres.atlassian.net/browse/SIG-12029|smart-link] .

Suite à ce nettoyage, il est indispensable de sécuriser le SIG afin de ne plus permettre l’intégration de données non conformes : une première US [https://comutitres.atlassian.net/browse/SIG-12031|https://comutitres.atlassian.net/browse/SIG-12031|smart-link] a été réalisée dans ce sens, ainsi qu’une étude [https://comutitres.atlassian.net/browse/SIG-12496|https://comutitres.atlassian.net/browse/SIG-12496|smart-link] pour compléter.

Cette dernière étude a permis d’identifier 4 impacts : 

* Modification du [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1730418737|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1730418737|smart-link]
* Modification du [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762532220/BATCH-CON-920+-+Traitement+des+justificatifs+RIB-APA+multi+produit|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762532220/BATCH-CON-920+-+Traitement+des+justificatifs+RIB-APA+multi+produit|smart-link]
* Modification du [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1730419014/CLI-010+-+Modifier+les+donn+es+d+un+client|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1730419014/CLI-010+-+Modifier+les+donn+es+d+un+client|smart-link]
* Modification du WS [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1746144751/REST-API-CLI-130-V1+-+Modifier+un+client|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1746144751/REST-API-CLI-130-V1+-+Modifier+un+client|smart-link]

Cette US va traiter des évolutions nécessaires dans le CLI-002 et le BATCH-CON-920, dont le traitement est lié.
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

*En tant qu’ESI, je veux pouvoir sécuriser le SIG afin de n'insérer en base que des données clients conformes aux règles de nettoyage pré-établies.*

Le besoin consiste à mettre en place des contrôles avant insertion des données client en base de données sur les noms, prénoms et civilité (le traitement sur le téléphone mobile consistant à remplacer le numéro non conforme par une chaîne de caractères vides est déjà réalisé dans ce CU).
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|12490_001|Fonctionnel|Concerne le *CLI-002*
Pour les *nom / prénom* : il n’est pas autorisé d’insérer des données ne contenant que espace, tiret ou apostrophe uniquement (doit contenir au moins un caractère alphabétique).
Après du traitement du trigger, il faut donc vérifier que le nom et le prénom ne seront pas nuls ou ne contenant que des caractères non alphabétiques et lever un motif bloquant le cas échéant : 
2: nom client indéfini
3: prénom client indéfini|
|12490_002|Fonctionnel|Concerne le *CLI-002*
Les seules valeurs autorisées pour la *civilité* sont 1, 2 ou NULL.
Si la civilité n’est pas conforme à l’attendu, il faut mettre la donnée à NULL.|
|12490_003|Fonctionnel|La gestion des motifs bloquants levés lors de la création du client (voir exigence 12490_001) doit être réalisée dans le *BATCH-CON-920*|",0,1
nan,0,2
"FP687 - Plan de correction 2022 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*ÉTANT DONNE QUE*   
 Je suis admin SIG                                          |
|*QUAND*  Je sélectionne la suppression d'un utilisateur depuis l'IHMC|
|*ALORS*  
 L'utilisateur est supprimé après confirmation de l'irréversibilité de cette action| {panel:bgColor=#e3fcef}
*Contexte :*

Pouvoir supprimer automatiquement un utilisateur depuis l'écran d'administration des utilisateurs à l'IHMC (action ponctuelle)
{panel}

{panel:bgColor=#deebff}
*Besoin :*

Le traitement unitaire d'un utilisateur peut être réalisé directement depuis l'IHMC 

Ce traitement ne nécessite pas de respecter les délais ni même que l'utilisateur soit désactivé
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

 
{panel}

h2. *Exigences :* 

 [https://comutitres.atlassian.net/wiki/spaces/OR/pages/1866105595/FP500+-+Suppression+des+comptes+Utilisateurs+et+Profils+SIG+inutilis+s|https://comutitres.atlassian.net/wiki/spaces/OR/pages/1866105595/FP500+-+Suppression+des+comptes+Utilisateurs+et+Profils+SIG+inutilis+s|smart-link] 

 \[022] à \[025]
 ",0,2
"FP500 - Plan de correction 2021 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*ÉTANT DONNE QUE*   
 Je suis admin SIG                                          |
|*QUAND*  
 J'exécute les traitements de suppression des utilisateurs|
|*ALORS*  
 Les lignes dans les tables qui faisaient référence à l'UTI_ID de l'utilisateur supprimé font maintenant référence à l'UTI_ID du ""Compte supprimé""| {panel:bgColor=#e3fcef}
*Contexte :*

Un certain nombre de tables font référence à l'UTI_ID de l'utilisateur ayant réalisés des actions impactant des lignes dans ces tables
{panel}

{panel:bgColor=#deebff}
*Besoin :*

Anonymiser l'UTI_ID des tables impactées
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

  
{panel}

h2. *Exigences :* 

 

[https://comutitres.atlassian.net/wiki/spaces/OR/pages/1866105595/FP500+-+Suppression+des+comptes+Utilisateurs+et+Profils+SIG+inutilis+s|https://comutitres.atlassian.net/wiki/spaces/OR/pages/1866105595/FP500+-+Suppression+des+comptes+Utilisateurs+et+Profils+SIG+inutilis+s|smart-link] 

 \[013]
 ",0,2
nan,0,1
nan,0,1
nan,0,1
"FP828 - Migration outil RATP de gestion des objets trouvés ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Passe trouvé sur le réseau*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un agent d’exploitation RATP|
|*QUAND*
Une personne ramène à un point de contact un titre de transport qu’elle a trouvé|
|*ALORS*
Je peux retrouver les informations du client et le contacter afin de lui restituer son passe.| {panel:bgColor=#e3fcef}
*Contexte* : 

Le groupe RATP se dote d’un nouvel outil (« OTOP ») pour gérer les objets trouvés et déclarés perdus sur le réseau. C’est une solution en SaaS hébergée chez un éditeur externe au SI RATP.

Ce nouvel outil remplacera celui déjà en production (« ESSOR »), il devra indiquer en temps réel lors de l’enregistrement d’un Objet Trouvé, des informations contenues dans le SIG concernant les titres de transport que cette application gère et leur porteur/payeur. 

L’objectif est de pouvoir récupérer les informations relatives à l’état du passe Navigo du client ainsi que ses coordonnées (porteur et/ou payeur),afin de pouvoir prendre contact avec lui pour l’informer des éléments retrouvés sur le réseau RATP.

Pour plus de détails, voir le document Word en PJ.
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

*En tant qu’agent d’exploitation RATP, je veux pouvoir prendre contact avec un client ayant perdu son passe sur le réseau afin de pouvoir lui restituer.*

Le but de cette US est de migrer en REST le service [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762532262/API-PASSE-003+-+Rechercher+les+informations+d+un+passe+de+son+porteur+et+du+payeur+par+num+ro+de+s+rie|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762532262/API-PASSE-003+-+Rechercher+les+informations+d+un+passe+de+son+porteur+et+du+payeur+par+num+ro+de+s+rie|smart-link] afin que le partenaire de la RATP puisse interroger le SIG via l’API Management.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Exigences*||
|11058_001|Un nouveau WS doit être développé pour le WS cité.|
|11058_002|Le WS doit être en REST.|
|11058_003|Le WS doit avoir les mêmes caractéristiques que le WS SOAP (sauf ce qui est précisé explicitement dans les exigences).|
|11058_004|Une authentification BASIC doit être mise en place.|
|11058_005|Le nouveau WS doit respecter les normes de développement de WS REST.|",0,2
nan,0,2
nan,0,1
"FP687 - Plan de correction 2022 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Exigence 1*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client avec plusieurs domiciliations bancaires valides sur le même contrat commercial|
|*QUAND*
Je lance le batch-CON-590 et après traitement|
|*ALORS*
Dans  le commentaire automatique on trouve les informations suivantes :
* si l'IBAN est renseigné : « BIC:XXX, IBAN:XXX, CC:XXX, MAJ:jj/mm/aaaa »
* si l'IBAN n'est pas renseigné : « Banque:XXX, Guichet:XXX, Compte:XXX, CC:XXX, MAJ:jj/mm/aaaa » et on ne trouve aucune information sur le nom prénom du Titulaire|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Exigence 2*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client ayant un contrat commercial actif au prélèvement|
|*QUAND*
Je lance le batch-FIN-500 et après traitement|
|*ALORS*
un évènement est enregistré avec un commentaire automatique  qui ne contient aucune information sur le nom prénom du Titulaire|
|{panel:bgColor=#e3fcef}
*Scénario 3 : Exigence 3*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un opérateur CRC|
|*QUAND*
 Je modifie le titulaire d’un RIB depuis l’IHMC|
|*ALORS*
un évènement est enregistré suite à cette action et ne comporte pas de commentaire automatique|
|{panel:bgColor=#e3fcef}
*Scénario 4 : Exigence 4*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client ayant une adresse SIG qui n’est plus correcte
Pour une raison X SIG envoie un courrier postal au client 
le Courrier revient en NPAI au prestataire|
|*QUAND*
Je lance le BATCH-CLI-510 avec en entrée un fichier contenant le client concerné|
|*ALORS*
un évènement est enregistré avec un commentaire automatique Vide|
|{panel:bgColor=#e3fcef}
*Scénario 5 : Exigence 5*
{panel}|
|*ÉTANT DONNE QUE*
 Je suis un opérateur CRC|
|*QUAND*
Je modifie l’adresse email d’un client déja appairé|
|*ALORS*
un évènement “ Modification d’adresse mail non autorisée” est enregistré suite à cette action et ne comporte pas de commentaire automatique|
|{panel:bgColor=#e3fcef}
*Scénario 6: Exigence 5*
{panel}|
|*ÉTANT DONNE QUE*
 Je suis un opérateur CRC|
|*QUAND*
Je modifie l’adresse email + numéro de téléphone ou autre donnée d’un client déjà appairé|
|*ALORS*
un évènement “ Données clients hors mail modifiées” est enregistré suite à cette action et ne comporte pas de commentaire automatique| {panel:bgColor=#e3fcef}
*Contexte* : Il a été identifié que certaines données à caractère sensible sont enregistrées automatiquement dans les commentaires automatiques. 

Les données clients font partie des données sensibles qui peuvent entrainer un risque important pour les personnes concernées.

Après analyse des commentaires automatiques qui sont extrait suite à l'US  [[SIG-8984] Extraction des commentaires automatiques contenant des données personnelles - Jira (atlassian.net)|https://comutitres.atlassian.net/browse/SIG-8984] qui permet  de lister les commentaires en base de données en se limitant aux actions identifiées dans l'étude [[SIG-2882] [ETUDE] Enregistrement auto de données personnelles dans les commentaires - Jira (atlassian.net)|https://comutitres.atlassian.net/browse/SIG-2882]. 

Nous concluons que certaines données peuvent être supprimées des commentaires automatiques et que nous pouvons les trouver ailleurs. 


{panel}

{panel:bgColor=#deebff}
*Besoin* : Nettoyer les données personnelles des commentaires automatiques 
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|01|Fonctionnel|Lors du lancement du BATCH-CON-590 générant l'évènement ""Modification d'affectations de domiciliation bancaire "", le commentaire automatique de cet évènement doit contenir les informations suivantes :
* si l'IBAN est renseigné : « BIC:XXX, IBAN:XXX, CC:XXX, MAJ:jj/mm/aaaa »
* si l'IBAN n'est pas renseigné : « Banque:XXX, Guichet:XXX, Compte:XXX, CC:XXX, MAJ:jj/mm/aaaa »|
|02|Fonctionnel|Lors du lancement du _BATCH-FIN-500_“ un évènement est enregistré dans lequel se trouve un commentaire automatique. 
le commentaire automatique ne doit plus contenir de titulaire dans les informations enregistrées|
|03|Fonctionnel|Lors de l’appel du CLI-040 *“*
Ne plus envoyer de commentaire automatique 
Exemple commentaire automatique: LLE CATHERINE KLEIN 30004 00345 00002766916|
|04|Fonctionnel|Lors du lancement du BATCH-CLI-510 générant l'évènement ""NPAI recu "", le commentaire automatique de cet évènement doit être vide et ne contenir aucune information|
|05|Fonctionnel|Supprimer le commentaire automatique en cas de modification d’adresse mail depuis le SIG  pour un client appairé|",0,1
"FP609 - petits sujets NL+ 2022 Prérequis : 

* Disposer d'un contrat NL+
* Rendre le mandat SEPA invalide
* Suspendre le contrat NL+

||(!)||Description||
|1|* Essayer de faire une reprise => la reprise n'est pas autorisée car pas de mandat SEPA valide
* Faire un changement de Payeur disposant de coordonnées bancaires sur le contrat en Agence => changement de payeur effectué
* Essayer de faire une reprise => la reprise fonctionne désormais|
|2|Pré-requis : se mettre dans un cas où on ne peut pas faire de changement de coordonnées bancaires pour un contrat suspendus (cf liste des motifs menant à l’évènement “69: changement de payeur impossible”
* Faire un changement de coordonnées bancaires => changement de coordonnées bancaires non effectué| h2. Exigences : 

||Référence||Exigences||
|01|Le *changement de Payeur* doit être réalisable en *Agence* pour un contrat NL+ *Suspendu* et aboutir à la journalisation de l'événement *“68: payeur change”*|
|02|En cas de levée de motifs bloquants pour le *changement de Payeur* en *Agence* d'un contrat NL+ *Suspendu* le SIG doit journaliser l'événement *“69: changement de payeur impossible”*|",0,2
nan,0,2
nan,0,2
nan,0,2
"FE657 - Recherche d'une nouvelle solution Chatbot ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 3 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 4 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : 

Sur les Services en ligne il y avait un chatbot *Laiye* qui permettait d’accompagner les clients sur certains parcours et donnée quelques infos correspondant à des question pré définis. Malheureusement, l'éditeur de ce chatbot semble avoir fermé.

Aujourd’hui, les Service en ligne sont donc dépourvu de chatbot. L’idée est donc d’en mettre un en place pour à minima accéder à nouveau aux fonctionnalités demandées et voir éventuellement les possibilités d’extensions. 

h3. Fonctionnalités actuelles

Le chatbot est présent sur les parcours produit suivant valable pour NA et ou iR ainsi que compte client : 

* Souscrire
* Renouveler
* Modifier les informations personnelles
* Obtenir une attestation
* Perte ou vol de passe
* Résilier un contrat
* Déclarer un changement d'établissement scolaire
* Déclarer le statut de boursier
* Paiement
* Modes de paiement
* Fonctionnement des prélèvements
* Modifier un moyens de paiement
* Impayés
* Appairage
* Carte bon plan (une seule réponse pour indiqué qu’elle n’existe plus)

Il y a également un moyen de couper la conversation 

La plupart des interractions sont de l’ordre de l’information avec des questions prédéfinis. 

h4. Points d’entrés / Phrase d’entrainement

Chacun des parcours peut être déclencher par une “phrase d’entrainement”

 Exemple pour le parcours Souscription : 

* souscrire
* Ça coûte combien le pass Imagine'R ?
* Bonjour, je cherche comment faire un abonnement de transports navigo
* Quand faut il faire l’inscription ?

h4. Réponses et orientation du chatbot

Une fois la question posé sur ce parcours précis, le Chatbot répond par une simple question pour en savoir plus sur le contexte client et orienter vers le parcours approprier. 

Pour continuer avec notre exemple de soucription : 

Réponse du Chtabot : “Votre demande concerne quel forfait?”

Le client est inviter à choisir entre plusieurs choix par clic : “Imagine R” ou “Navigo Annuel”

→ On repars de plus belle : le chatbot a une réponse par choix et déroule son arbre de réponse. 

h4. Volumétrie 

* Chaque parcours à 1 point d’entrée en saisie textuelle utilisateur et des phrases d’entraiement
* La profondeur des arbres ne dépassent pas 3 niveaux de questions/réponses
* La largeurs des arbres ne dépassent pas 7 possiblités de réponse à une question. 
* La plupart des arbres n’ont que 2 choix de réponses possibles.

h4. Dashboard Admin

Le chatbot se paramètre en no-code, depuis une interface d’administration sur laquelle on peut ajouter des parcours, des points d’entrées, des arbres de décisions etc..

Ce dashboard permet aussi de visualiser les KPI comme le nombre de messages recu, le nombre de conversation, le pourcentage de précision, et un historique des conversations avec un score de qualité sur 10 si le chatbot à compris le besoin client en fonction de son interraction. 

h3. POC en cours : chatbot agent

Ce POC permet d’accompagner le client sur les parcours mentionnés plus bas. Si le chatbot ne permet pas de répondre au question, il faut pouvoir basculer vers un agent à distance (selon disponibilité) qui prend le relais pour répondre au besoin client

* Suspension / résiliation NA
* Régularisation d’impayés NA
* Parcours de souscription NA
* Apparairage des données

L’idée est d’améliorer la qualité de service du client, et de dégorger les autres canaux SAV (telephone, face à face …)

h3. Extensions potentielles

* Plus de parcours client couvert, aujourd’hui seulement certaine parcours NA et iR sont couvert avec le chatbot. On peut imaginer un déploiement sur tout SEL
* Aujourd’hui, peu voir aucune donnée du back office n’est remontée au chatbot. On pourrait imaginer une interraction pour récupérer l’objet client ou contrat afin d’avoir plus de réponse, plus d’action possible → Sujet SSI / RGPD


{panel}

{panel:bgColor=#deebff}
*Besoin* : 

En tant que directeur SAV, je veux un chatbot sur mesure permettant d’accompagner les clients Service en ligne dans leur parcours afin de diminuer la demande SAV 
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|SIG-13449|Etude|Fournir un document des solutions chatbot, avec les couts et les délais associé par niveau d’intégration 
* Niveaux Iso fonctionnel : c’est à dire les parcours Souscription NA, iR et SAV compte, purement informatif non connecté
* POC Bascule agent : sur les parcours mentionnés, purement informatif, avec possiblité de bascule vers un agent en chat direct
* Les possibilités / faisabilité de chatbot supplémentaire : connexion API, déploiement sur plusieurs parcours …|",0,2
"PIM ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
je suis un client avec un contrat NA éligible à obtenir le tarif Senior et basculant lors de mon mois gratuit
je lance le batch de reconduction (ou effectue une reconduction manuelle)
je prélève les 12 mensualités|
|*QUAND*
le batch de reporting CA est exécuté (suite à la reconduction *un an plus tard* du contrat NAS (bien faire vivre le contrat sur une année glissante en effectuant tous les prélèvements avant de faire la reconduction))|
|*ALORS*
le contrat est bien comptabilisé dans la ligne NAS pour la reconduction| {panel:bgColor=#e3fcef}
*Contexte* : 

Le BATCH-REP-240 permet d’extraire le CA par type d’acte -souscription, reconduction, suspension, reprise…) 

La DAF contrôle ce reporting via des extraction de CRE et a constaté un écart significatif entre le reporting CA et les CRE pour les mouvements financiers de type Reconduction. Après analyse cet écart est issu de contrats NAS qui ne sont pas pris en compte par le Reporting CA car la date CNIN_SENIOR_MVF_CA_D est nulle pour ces contrats. Or le reporting CA se base sur cette date pour comptabiliser ou non les contrats NAS.
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

Il faut que les contrats NAS aient tous une date de mouvements financiers CA renseignée.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 

La date est renseignée en cas de souscription d’un contrat NAS ou en cas de bascule “directe”

En cas de bascule lors du mois gratuit, l’application du tarif n’est réalisée que lors de la reconduction. Il est donc nécessaire de mettre à jour le processus de reconduction pour renseigner cette date lors d’une bascule au tarif Senior. 

Voir ce qui a été fait pour le champ CNIN_SENIOR_DEBUT_D via la [[SIG-11687] NAS - Date de début de tarification Senior - Jira (atlassian.net)|https://comutitres.atlassian.net/browse/SIG-11687]
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|Ref 1|Fonctionnelle|Renseigner la date CNIN_SENIOR_MVF_CA_D  en cas de reconduction d’un contrat NA au tarif NAS si cette date n’est pas renseignée|
|Ref 2|Fonctionnelle|La date à renseigner est égale au 1er jour du mois de reconduction|",0,1
nan,0,2
nan,0,1
nan,0,2
nan,0,2
nan,0,1
nan,0,1
"FP447 - Refonte des iban etrangers ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client ayant souscrit par formulaire 
Après traitement par ACE, le contrat est à l'état incomplet dans le SIG et une action est en attente
Le batch IR-BATCH-COU-505_Paragon est lancé|
|*QUAND*
Le fichier est généré suite au lancement du batch|
|*ALORS*
La domiciliation bancaire étrangère est bien renseignée dans le courrier|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client ayant souscrit par formulaire avec iban français
Après traitement par ACE, le contrat est à l'état incomplet dans le SIG et une action est en attente
Le batch IR-BATCH-COU-505_Paragon est lancé|
|*QUAND*
Le fichier est généré suite au lancement du batch|
|*ALORS*
La domiciliation bancaire française est bien renseignée dans le courrier| {panel:bgColor=#e3fcef}
*Contexte* : 

L’ano [https://comutitres.atlassian.net/browse/SIG-8945|https://comutitres.atlassian.net/browse/SIG-8945|smart-link]  évoque un trou fonctionnel lors de la mise en place des IBAN Etrangers.

Depuis la 22.2, on affiche l’IBAN générique et pas l’IBAN étranger d’un client sur le courrier Paragon
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

En tant que PO, je souhaite mettre à jourl’alimentation du courrier Paragon  afin qu’il affiche les véritables valeurs du BIC et IBAN

Il faudra donc  :

* Récupérer l'IBAN directement depuis le champs DOM_IBAN2 et pas DOM_IBAN de la table E_CLT_DOMICILIATION_BANCAIRE.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|Ref 1|Fonctionnelle|Transmettre à Paragon les valeurs des colonnes DOM_IBAN2 et DOM_BIC2|",0,1
"FP409 - Refonte parcours SEL LOT 1 ||(!)||Description||
|1|Description de l'exigence 1|
|2|Description de l'exigence 2|
 {panel:bgColor=#e3fcef}
*Contexte :*

 
{panel}
{panel:bgColor=#deebff}
*Besoin :*

 
{panel}
{panel:bgColor=#ffcfc1}
*Prérequis :*

  
{panel}
h2. *Exigences :* 

 
||Référence                                        ||Type                                             ||Exigences                                                     ||
|Ref 1 |Type 1|Exigence 1 |
|Ref 2 |Type 2|Exigence 2|",0,2
nan,0,2
nan,0,1
"FP447 - Refonte des iban etrangers ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :* *Changer domiciliation bancaire* *avec DOM étrangère*
{panel}|
|*ÉTANT DONNE QUE* 
Je suis un client ayant un contrat NL+ au prélèvement
Je me rend en agence pour demander un changement de domiciliation bancaire, afin d'utiliser une domiciliation bancaire *étrangère*|
|*QUAND*  
L'agent effectue le changement à l'IHMC|
|*ALORS*  
Un nouveau mandat de prélèvement SEPA est édité via l'IHMC et contient les données BIC et IBAN correspondant à la domiciliation bancaire *étrangère*. 
Le rendu ergonomique est identique à celui avec un IBAN français.|
|{panel:bgColor=#deebff}
*Scénario 2 (NR) :* *Changer domiciliation bancaire avec DOM française*
{panel}|
|*ÉTANT DONNE QUE*  
Je suis un client ayant un contrat NL+ au prélèvement
Je me rend en agence pour demander un changement de domiciliation bancaire, afin d'utiliser une domiciliation bancaire *française*|
|*QUAND*  
L'agent effectue le changement à l'IHMC|
|*ALORS*  
Un nouveau mandat de prélèvement SEPA est édité via l'IHMC et contient les données BIC et IBAN correspondant à la domiciliation bancaire *française*.|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) : Changer de payeur avec DOM française*
{panel}|
|*ÉTANT DONNE QUE*  
Je suis un client ayant un contrat NL+ au prélèvement
Je me rend en agence pour demander un changement de payeur, et l'associer à une domiciliation bancaire *française*|
|*QUAND*  
L'agent effectue le changement à l'IHMC|
|*ALORS*  
Un nouveau mandat de prélèvement SEPA est édité via l'IHMC et contient les données BIC et IBAN correspondant à la domiciliation bancaire *française*.| {panel:bgColor=#e3fcef}
*Contexte :*

Les mandats de prélèvements SEPA générés par le SIG contiennent entre autres les informations BIC et IBAN de la domiciliation bancaire rattachée au contrat commercial à prélever.

Exemple :

* !image-2021-12-02-17-17-18-253.png|width=686,height=430!

Ces données BIC et IBAN proviennent des colonnes ""DOM_IBAN"" et ""ETB_BIC"" de la table E_CLT_DOMICILIATION_BANCAIRE. Ces colonnes ne contiennent aujourd'hui que des domiciliations bancaires française. 

Deux nouvelles colonnes BIC et IBAN vont faire leur apparition dans le modèle de données SIG dans le cadre du projet FP447 ""Refonte des iban étrangers"" afin d'y stocker à la fois les domiciliations bancaires françaises et étrangères. 
{panel}

{panel:bgColor=#deebff}
*Besoin :*

Lors d'un changement de domiciliation bancaire pour un contrat Navigo Liberté +, réalisé en agence 3T, un nouveau mandat SEPA est édité via l'IHMC afin de présenter au client le nouveau compte à débiter.

Les SIG doit désormais ici s'appuyer sur les deux nouvelles colonnes BIC et IBAN pour le renseignement des données BIC et IBAN afin de permettre l'affichage des domiciliations bancaires étrangères. 
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

* Permettre la saisie des domiciliations bancaires étrangères à l'IHMC.  
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|Ref 1|Fonctionnelle|En cas de changement de domiciliation bancaire d'un contrat Navigo Liberté +, pour l'associer à une domiciliation bancaire étrangère, alors le mandat SEPA qui est affiché à l'IHMC doit indiquer les BIC et IBAN de la domiciliation bancaire étrangère.|
|Ref 2|Ergonomique|Même avec un code IBAN étranger sur 34 caractères, celui-ci doit être affiché sur une seule ligne comme pour le code IBAN français sur 27 caractères.
{panel:bgColor=#deebff}
Il est possible néanmoins de décaler un peu le champ IBAN vers la gauche afin de rester sur une seule ligne. 
{panel}|
|Ref 3|Ergonomique|Même avec un code IBAN étranger sur 34 caractères, les différents éléments du mandat de prélèvement SEPA devront rester positionnés à la même position qu'avec un code IBAN français sur 27 caractères.|

NB :

* Pour la solution, afin de minimiser les risques de régression, nous souhaitons que soient créées 2 nouvelles ZVA dédiées aux 2 nouvelles colonnes BIC et IBAN plutôt que de modifier les 2 ZVA BIC et IBAN actuelles. 
* Le template correspondant est MDTSEPA_PPT",0,1
"FP867 - Petits sujets techniques SIG 2023 S2 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 3 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 4 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : Dans le cadre du remplacement des EJB, nous entamons le module client 
{panel}

{panel:bgColor=#deebff}
*Besoin* : Mettre en place une documentation pour découper le module client et écrire les solutions afférentes.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Type*||*Exigences*||
|Documentation|Découpage module client|
|Documentation|Rédaction des solutions du module client|",0,2
nan,0,2
"FP874 - Sujet metier SIG 2023 S1 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis l’exploitant du SIG|
|*QUAND*
J’intègre un fichier de saisie de masse iRS
que le fichier contient un enregistrement dont une donnée obligatoire est Null|
|*ALORS*
La log CR m’indique quelle donnée est manquante pour l’enregistrement|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis l’exploitant du SIG|
|*QUAND*
J’intègre un fichier de saisie de masse iRE
que le fichier contient un enregistrement dont une donnée obligatoire est Null|
|*ALORS*
La log CR m’indique quelle donnée est manquante pour l’enregistrement|

Pas de tests sur les autres produits car l’intégration de masse est utilisée pour iR de manière quasiment exclusive {panel:bgColor=#e3fcef}
*Contexte* : 

Pas de contrôle dans le BATCH-CON-100 sur le format du fichier en entrée : en cas de fichiers contenant des zones obligatoires nulles, une erreur technique est levée mais pas d’erreur fonctionnelle. Il est alors compliqué de déterminer le problème rencontré dans le fichier de données
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

Gérer les erreurs de non respect des données dans le fichier d’entrée en indiquant l’erreur fonctionnelle
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 

Concerne les traitements qui ont en commun la classe java {{sig.batch.gestion.GestionSaisieContratsCommerciaux}} : 

* INT-BATCH-CON-100
* IR-BATCH-CON-100
* IRS-BATCH-CON-100
* IRE-BATCH-CON-100
* ORG-BATCH-CON-100
{panel}



{panel:bgColor=#eae6ff}
L’anomalie [https://comutitres.atlassian.net/browse/SIG-9181|https://comutitres.atlassian.net/browse/SIG-9181|smart-link] créée suite au développement de la [https://comutitres.atlassian.net/browse/SIG-9118|https://comutitres.atlassian.net/browse/SIG-9118|smart-link] a permis d’identifier que fonctionnement non désiré. En l’occurence, c’est l’absence du type d’abonnement (Primo ou Réabo) qui faisait planter le traitement d’intégration 
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|Ref 1|Fonctionnelle|En cas de données Null alors qu’obligatoire dans le doc [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762531247/ISM+-+Fichier+de+saisie+de+masse|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762531247/ISM+-+Fichier+de+saisie+de+masse|smart-link] une erreur dans le CR doit indiquer quel champ est manquant pour l’enregistrement en cours|",0,1
"FP741 - Filiale - Gestes Co ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Enregistrement d’un remboursement NMS*
{panel}|
|*ÉTANT DONNE QUE*
je suis un conseiller de clientèle|
|*QUAND*
j’ajoute un remboursement sur un contrat NMS|
|*ALORS*
-le solde du client est positif-
-une action en attente est enregistrée sur le contrat et sera traitée par le BATCH-FIN-525-
Un événement est tracé sur le contrat|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Enregistrement d’un Geste commercial NMS*
{panel}|
|*ÉTANT DONNE QUE*
je suis un conseiller clientèle|
|*QUAND*
j’ajoute un geste commercial pour un contrat NMS|
|*ALORS*
-le solde du client est positif-
-une action en attente est enregistrée sur le contrat et sera traitée par le BATCH-FIN-510-
Un événement est enregistré sur le contrat| {panel:bgColor=#e3fcef}
*Contexte* : Dans le cadre de la filialisation de Comutitres par IDFM, Un certain nombre d’actions sont à mettre en place pour se conformer à la réglementation légale liée à la filiale.

Parmi les actions demandées, c’est de faire la paramétrage événementiel nécessaire pour la gestion des remboursements et les gestes commerciaux pour le produit NMS.
{panel}

{panel:bgColor=#deebff}
*Besoin* : Création du paramétrage événementiel pour la gestion de remboursement et des gestes commerciaux pour le produit NMS.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : la liste des motifs pour NMS dans l’US

[https://comutitres.atlassian.net/browse/SIG-9496|https://comutitres.atlassian.net/browse/SIG-9496|smart-link]
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|001|Paramétrage|Action NMS : Enregistrer un remboursement|
|002|Paramétrage|Événement : un événement pour invalidation de la demande de remboursement (motifs suffisants 1, 268) de priorité la plus haute|
|003|Paramétrage|Événements : un événement par motif de remboursement NMS|
|-004-|-Paramétrage-|-Le mouvement financier pour le remboursement est le mouvement 56 “remboursement accordé”-
{color:#ff991f}*Pas de gestion financière des NMS* {color}|
|-005-|-Paramétrage- 
-Fonctionnelle-|-la validation du remboursement doit générer un solde positif sur le contrat commercial et une action en attente doit être postée pour prise en compte par le traitement de remboursement (BATCH-FIN-510)-
{color:#ff991f}*Pas de gestion financière des NMS* {color}|
|006|Paramétrage|Action NMS :  Enregistrer un geste commercial|
|007|Paramétrage|Événement : un événement pour invalidation de la demande d’attribution de geste commercial (motifs suffisants 1, 268) de priorité la plus haute|
|008|Paramétrage|Événements : un événement par motif de geste commercial NA|
|-009-|-Paramétrage-|-Un mouvement financier “geste commercial accordé” est créé et enregistré suite à l’enregistrement d’un événement de demande de geste commercial-
{color:#ff991f}*Pas de gestion financière pour NMS*{color}|
|-010-|-Paramétrage-|-La validation du geste commercial doit générer l’enregistrement d’une action en attente (en fonction du mode de paiement) pour prise en compte par les traitements automatiques de remboursement (BATCH-FIN-510)- 
{color:#ff991f}*Pas de gestion financière pour NMS*{color}|",0,2
nan,0,1
nan,0,1
nan,0,1
nan,0,1
nan,0,1
"FP393 - Amélioration de l’IHMC SIG ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Écran contextuel documents – rechercher*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un Je suis un conseiller CRC utilisant l’IHMC|
|*QUAND*
J’ouvre l'écran Enregistrer un Document|
|*ALORS*
L'écran est affiché en respectant la nouvelle charte graphique de l’IHMC SIG|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Écran contextuel documents – Envoyer un document*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un agent RATP utilisant l’IHMC|
|*QUAND*
J’ouvre l'écran Envoyer un Document|
|*ALORS*
L'écran est affiché en respectant la nouvelle charte graphique de l’IHMC SIG|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) : Rechercher document*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un agent SNCF utilisant l’IHMC|
|*QUAND*
J’ouvre l'écran Rechercher un Document Type|
|*ALORS*
L'écran est affiché en respectant la nouvelle charte graphique de l’IHMC SIG|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) : Enregistrer un document*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un agent SNCF utilisant l’IHMC|
|*QUAND*
J’ouvre l'écran Enregistrer un Document|
|*ALORS*
L'écran est affiché en respectant la nouvelle charte graphique de l’IHMC SIG| {panel:bgColor=#e3fcef}
*Contexte :* 

Le but de cette US est de mettre à jour l’aspect visuel de l'Écran contextuel document en se basant sur les éléments graphiques de la nouvelle charte de l’IHMC SIG.

+*Le périmètre de la modernisation visuelle :*+

* Écran contextuel documents – rechercher  (voir pj rechercher-document)
* Écran liste de documents (voir pj Résultat_rechercher_document)
* Écran contextuel documents – consulter un document (pj consulter_document) avec un bouton permet d'afficher l'image (voir pj) et un bouton qui permet de désaffecter le document à l'objet SIG (client, contrat) (sur la v22.3 cet ne s’affiche pas). Mais, s’affiche sur la 22.2 (voir écran consulter document en pj).
* Écran contextuel documents – Envoyer un document (voir pj Envoyer_document).
* Écran contextuel documents – enregistrer un document (voir pj Enregistrer_document_suite_l'envoi_du_document et Enregistrer_document).
* Popup message (Popup_ Message) qui indique que tu es en mode SLS.
* Document Type (voir pj Rechercher_document_Type).
{panel}

{panel:bgColor=#deebff}
*Besoin :* 

 En tant qu’utilisateur de l’IHMC

Je souhaite que l'Écran contextuel document soit mis à la nouvelle charte graphique IHMC SIG

Afin d’améliorer l’IHMC.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :* 

* Adapter la disposition des éléments graphiques aux différentes résolutions des écrans utilisées par les transporteurs à savoir 1024 x 769 et 1280 X 1024 en minimisant le scroll vers le bas d’écran.
* La nouvelle IHMC est supportée uniquement par Firefox 38+.
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|001|Fonctionnelle|Mettre l'Écran contextuel document à la nouvelle charte graphique|
|002|Fonctionnelle|Adapter l'écran aux différentes résolutions des écrans utilisées par les transporteurs à savoir 1024 x 769 et 1280 X 1024 en réduisant le scroll vertical.|",0,1
nan,0,2
"FP605 - sujet metier SIG S1 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Faire la bascule de NA senior sur un passe avec zonage restreint* 
{panel}|
|*ÉTANT DONNE QUE*
je suis client qui possède contrat NA  avec un passe de zonage 3..4
*ET* que je me rends en agence pour demander la bascule vers Senior|
|*QUAND*  l’agent 3T tente de modifier mon profil “Tout public” vers “Senior”|
|*ALORS* le système lève un motif bloquant pour empêcher cette bascule en précisant que la bascule est bloqué à cause du passe avec zonage restreint|
|{panel:bgColor=#deebff}
*Scénario 2 (NR) :Faire la bascule de NA senior sur un passe avec toutes zones*
{panel}|
|*ÉTANT DONNE QUE* 
Je suis client qui possède contrat NA avec un passe toutes zones
*ET* que je me rends en agence pour demander la bascule vers Senior|
|*QUAND* L'agent change le profil de “Tout public” vers “Senior”|
|*ALORS* le système bascule le contrat au tarif senior| {panel:bgColor=#e3fcef}
*Contexte :* Actuellement, quand un client demande de souscrire un contrat NA senior en agence, un acte SAV se fait sur son profil pour le rendre senior, à ce moment si le SIG détecte que le contrat du client est de zonage restreint, il change automatiquement le zonage pour le rendre toutes zones en annulant son ancien contrat (avec zonage restreint, voir l’exemple ci-joint), sauf que même si le système met à jour le zonage, le client ne profite que de son premier droit de transport qui est avec un zonage restreint. 
{panel}

{panel:bgColor=#deebff}
*Besoin :* En tant qu'Agent 3T, je veux que le système empêche la bascule NA Senior si le client dispose d’un contrat avec zonage restreint.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*Avoir un contrat avec zonage restreint 
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|Ref 1|Fonctionnel|Bloquer la bascule du profil “Tout public” vers “senior” lorsque le client dispose d'un contrat avec zonage restreint|",0,1
"FP847 - IR C23 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : client IRE avec numéro de téléphone renseigné* 
{panel}|
|*ÉTANT DONNE QUE* Je suis un agent CRC|
|*QUAND* La date de début de validité de forfait d’un client IRE/IRS est dans 8 jours et que ce dernier n’a pas encore recharger son forfait|
|*ALORS* Une action en attente d’envoie d'SMS de rappel de rechargement s’affiche
*ET* La liste déroulante de choix de l’action manuelle comporte l’action  d’envoie d'SMS de rappel de rechargement
*ET* quand je valide ce choix, l’action en attente disparait.|
|{panel:bgColor=#e3fcef}
*Scénario 2 :  client IRE avec numéro de téléphone non renseigné et email renseigné*
{panel}|
|*ÉTANT DONNE QUE* Je suis un client IRE|
|*QUAND* La date de début de validité de forfait est dans 8 jours et que je n’ai pas encore recharger mon forfait|
|*ALORS* je reçois un mail de rappel pour recharger mon forfait| {panel:bgColor=#e3fcef}
*Contexte* : Chaque année et à l’aide d’une requête lancée manuellement, CRC effectue une campagne “passe à recharger” qui consiste à contacter les clients(remontés par la requête) par SMS ou mail 8 jours avant la date de début de validité du forfait pour rappeler aux clients d'aller charger leur passe. Cette campagne est menée du mois d'août au mois de décembre (inclus)
{panel}

{panel:bgColor=#deebff}
*Besoin* : En tant qu’exploitant SIG, je souhaite automatiser la gestion de la compagne “passe à recharger” afin de:

* Poster une action d’envoi de SMS de rappel de rechargement de passe 8 jours avant la date de début de validité de son forfait, si le numéro de téléphone du client est renseigné
* Si non d’envoyer l'email en PJ 
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : Avoir un passe  à l'état “A recharger” 8 jours avant la date de début de validité du forfait.
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|Ref 1|Fonctionnelle|Poster une action CRC d’envoi de SMS de rappel de rechargement de passe 8 jours avant la date de début de validité du forfait du client au porteur si son numéro est renseigné|
|Ref 2|Fonctionnelle|Le SIG doit envoyer le mail (en PJ au porteur) de rappel de rechargement de passe 8 jours avant la date de début de validité du forfait du client si le numéro de téléphone du porteur n'est pas renseigné et que l’adresse mail de ce dernier est renseignée|
|Ref 4|Fonctionnelle|Envoyer un SMS au payeur si les coordonnées téléphoniques et l’adresse mail du porteur ne sont pas renseignées et que le numéro de mobile du payeur est connu|
|Ref 5|Fonctionnelle|Envoyer un mail au payeur si les coordonnées téléphone et adresse mail du porteur ne sont pas renseignées et si le numéro de téléphone portable du payeur n’est pas non plus renseigné|
|Ref 3|Fonctionnelle|L’action manuelle contrat “Envoie SMS pour rappel de rechargement de passe” doit être créée pour le produit imagine R étudiant (code 2).|",0,2
"FP733 - Filiale - Recouvrement ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
je suis l’exploitant du SIG|
|*QUAND*
le traitement de recouvrement IDFM est exécuté|
|*ALORS*
le fichier de détail par usager est généré| {panel:bgColor=#e3fcef}
h2. *Contexte* : 

A compter du 01/01/2023 et de la transformation du GIE Comutitres en filiale d’IDFM régie par une convention de mandat, les recettes de transport sont qualifiées de recettes publiques et sont d’office éligibles au recouvrement en contentieux, tel qu’existant sur les impôts particuliers, les factures de collectivités …
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

Mettre en place un traitement permettant de transmettre la gestion de la dette à IDFM 

Cette US concerne la constitution du fichier Détail 
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : [https://comutitres.atlassian.net/browse/SIG-9671|https://comutitres.atlassian.net/browse/SIG-9671|smart-link]
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|Ref 1|Fonctionnelle|Les données extraites sont regroupées par client payeur et par produit|
|Ref 2|Interface|Le format du fichier est décrit sur la page [https://comutitres.atlassian.net/wiki/spaces/EP/pages/2602533502/FE733+-+PJ+FILIALE+RECOUV+2+ENTREES+DETAIL+Liste+des+entr+es+en+recouvrement+forc+sur+une+p+riode+-+D+tail+par+usage|https://comutitres.atlassian.net/wiki/spaces/EP/pages/2602533502/FE733+-+PJ+FILIALE+RECOUV+2+ENTREES+DETAIL+Liste+des+entr+es+en+recouvrement+forc+sur+une+p+riode+-+D+tail+par+usager]r|
|Ref 3|Fonctionnelle|Un contrat commercial extrait ne peut être pris en compte qu’une seule fois (tout envoi confondus)|
|Ref 4|Fonctionnelle|Un mode reprise permet de générer de nouveau le fichier en cas de problème avant la fin de la création du fichier|",0,2
nan,0,1
"FP1087 - Sujet metier SIG 2024 S1 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 3 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 4 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : 

Dans le SIG, certains tarifs ne sont pas divisibles par leur durée de financement.

C’est le cas par exemple du tarif Junior qui s'élève à 24€, dont 8€ de frais de souscription. Le reste à payer de 16€ peut être réalisé au prélèvement qui s'étale alors sur 9 mois, dans le cadre des contrats imagine R. Les mensualités prélevées correspondant à 1,77€ entraînent donc une perte sur arrondi (le calcul 16/9 ne tombant pas juste).

De la même manière, il existe des profits sur arrondi.
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

Réaliser une étude listant l’ensemble des cas provoquant des pertes ou des profits sur arrondi dans le SIG ainsi que le macro-chiffrage associé à la solution préconisée pour réduire la perte accumulée.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|13289_001|Fonctionnel|Réaliser une étude pour identifier les cas menant à des pertes ou des profits sur arrondi dans le SIG et évaluer la perte globale sur une année|
|13289_002|Fonctionnel|Proposer une solution pour réduire la perte accumulée et un macro-chiffrage associé|",0,1
nan,0,2
nan,0,2
"FP656 - Filiale - Impact identité visuelle ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Termes modifiés en base de données*
{panel}|
|*ÉTANT DONNE QUE*
Je suis testeur|
|*QUAND*
Je réalise les vérifications en base de données|
|*ALORS*
Les tables identifiées ont été traitées et les libellés concernés ont été modifiés.|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Termes modifiés dans le paramétrage événementiel*
{panel}|
|*ÉTANT DONNE QUE*
Je suis testeur|
|*QUAND*
Je réalise les vérifications du paramétrage|
|*ALORS*
Les expressions identifiées ont été modifiées (pour le fichier de paramétrage et les spécifications).|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) : Terme “litigieux” non modifié*
{panel}|
|*ÉTANT DONNE QUE*
Je suis testeur|
|*QUAND*
Je vérifie les modifications des libellés dans le paramétrage|
|*ALORS*
Le motif “SAV _ Cas litigieux” (852) n’a pas été modifié.| {panel:bgColor=#e3fcef}
*Contexte* : 

Dans le cadre de la mise en place de la filiale, Comutitres va changer de statut, passant de GIE (Groupement d’Intérêt Économique) à SAS (Société par Actions Simplifiée). 

L’hypothèse de travail retenue est que le nouveau nom serait “Comutitres S.A.S”.
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

*En tant qu’utilisateur du SIG, je souhaite que le terme GIE ne soit plus présent dans l'écosystème afin d'être conforme avec le nouveau statut de Comutitres.*

Le besoin consiste à supprimer le terme GIE des endroits suivants, si concernés : 

* base de données
* fichier de paramétrage
* IHMC
* spécifications

+*Ce qui est demandé*+ 

* Au niveau de la base de donnée : identifier les tables qui seront impactées par cette modification puis mettre en place des scripts permettant de modifier les expressions contenant le mot “GIE” pour chaque table identifiée.
* Au niveau du fichier de paramétrage : identifier toutes les expressions contenant le mot “GIE” et le changer en “Comutitres”.
* Pour les IHMs : modification dans les JSP de l’IHM du SIG (_pas d’impact identifié_).
* Pour les spécifications : identifier toutes les spécifications qui seront impactées puis effectuer les modifications de manière unitaire.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 

N/A
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|9335_001|Fonctionnel|Les termes “*GIE*” ou “*GIE Comutitres*” contenus dans les éléments d'habilitation (habilitations, partenaires, actions autorisées…) doivent être remplacés par “*Comutitres*”.|
|9335_002|Fonctionnel|Le terme “*GIE*” contenu en base de données dans des libellés courts doit être remplacé par “*Comu*”.|
|9335_003|Fonctionnel|Les termes “*GIE*” ou “*le GIE*” ou “*GIE Comutitres*” contenus dans les libellés des éléments de paramétrage événementiel (actions, événements, états, motifs) doivent être remplacés par “*Comutitres*”.|
|9335_004|Fonctionnel|Les spécifications qui seront impactées par le changement de libellé doivent être identifiées afin d'effectuer les modifications nécessaires (notamment les spécifications contenant des libellés de paramétrage).|

+Remarque+ : Les modifications à réaliser ne doivent pas concerner le produit Navigo Annuel 1ère classe (code 41), le produit étant obsolète.

{panel:bgColor=#fffae6}
Les termes “*litigieux*” ou “*collégien*” contenant la chaîne de caractères “*GIE*” ne doivent pas être modifiés. 
{panel}",0,2
"FP877 - Filtre et recherche affinée dans les évènements SIG ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : 

L’étude FE636 a permis d’identifier les obstacles à une bonne compréhension du traçage SIG, à la fois dans des recherches d’informations (reporting notamment), mais aussi face à un client :

# Il s’agit de listes indépendantes d’événements séparées par « objet ».
# Dans chaque liste, des événements pas regroupés par parcours client (P/V, souscript°, résiliat°, etc.).
# Enfin, les événements répertoriés sont très nombreux et de nature diverse (« bruit technique »)

+Deux besoins ont été retenus :+

# Améliorer les filtres au niveau recherche affiné des évènements permettant une plus grande lisibilité lors de la consultation du SIG. Ce filtrage pour éviter d'afficher par défaut les événements ""techniques"" et/ou redondants"" dans l'écran ""Evènements » du SIG (en ôtant certains acteurs par exemple).
# Pouvoir paramétrer de nouveaux filtres et d'ajouter/retirer à loisir les événements devant faire parti de ces nouvelles listes

Une première estimation d'impacts par l'équipe a été effectuée pour le premier besoin : cf [https://comutitres.atlassian.net/wiki/spaces/EP/pages/2876408627/FP877+-+Existant+SIG#Exigences|https://comutitres.atlassian.net/wiki/spaces/EP/pages/2876408627/FP877+-+Existant+SIG#Exigences|smart-link]

Nous allons alors répondre à ce besoin par les étapes suivantes : 

# {color:#ff5630}*Ajouter les filtres au niveau de la  recherche affiné des évènements permettant une plus grande lisibilité lors de la consultation du SIG. Ce filtrage pour éviter d'afficher par défaut les événements ""techniques"" et/ou redondants"" dans l'écran ""Evènements » du SIG.*{color}
# Pouvoir rendre la solution administrable : L'idée est de pouvoir ajouter ou supprimer des évènements à une fonction métier sans passer par une évolution, tout en sécurisant les listes existantes
{panel}

h2. Exigences : 

||*Référence*||*Exigences*||
|01|L'écran de recherche affinée des événements SIG doit être modifié pour ajouter un filtre activable ou non, pour permettre l’exclusion des événements ayant le code opérateur = Batch des résultats|
|02|L'écran de recherche affinée des événements SIG doit être modifié afin de classer les catégories par ordre alphabétique croissant|
|03|Une nouvelle liste de catégorie d'événements doit être créée pour contenir les événements liés à Perte/Vol|
|04|Tous les événements liés à une perte/vol doivent figurer dans cette liste, quel que soit le produit.|
|05|Une nouvelle liste de catégorie d'événements doit être créée pour contenir les événements liés une suspension/reprise
{panel:bgColor=#eae6ff}
on parle bien de reprise dans le cadre d’une suspension et non pas d’une reprise suite à contentieux.
{panel}|
|06|Tous les événements liés à une suspension/reprise doivent figurer dans cette liste, quel que soit le produit. (A date, il n’y a que NA et NL+)|
|07|L'étude doit indiquer :
* les différents points à implémenter pour répondre à ce besoin complémentaire
* un tableau récapitulatif des différentes US à mettre en œuvre et un macrochiffrage pour chacune des US|
|08|Une attention particulière lors de l'étude doit être apportée sur le besoin d’administration.
*Une solution simple serait ici de choisir d’utiliser le système de liste d’E_REF_LISTE. Or si on décide d’aller plus loin en rendant ces listes administrables, il existe un danger à ce qu’une mauvaise manipulation rendent les listes inopérantes.*|",0,1
"FP393 - Amélioration de l’IHMC SIG ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Afficher historique Client*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un administrateur fonctionnel SNCF utilisant l’IHMC|
|*QUAND*
J’affiche la synthèse client
ET je n’avais pas consulté un autre client avant|
|*ALORS*
L’entrée de menu contextuelle Récent n’est pas affiché.|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Afficher historique Client*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un  administrateur fonctionnel SNCF utilisant l’IHMC|
|*QUAND*
J’affiche la synthèse client
ET j'avais déjà consulté un ou plusieurs autre(s) client(s)|
|*ALORS*
L’entrée de menu contextuelle Récent est affiché 
En dépliant le menu alors  le N° Client des 5 clients  récemment consultés sont affichés|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) : Afficher historique Client* pour les autres profil SNCF
{panel}|
|*ÉTANT DONNE QUE*
Je suis un AGENT COMMERCIAL SNCF utilisant l’IHMC.|
|*QUAND* 
J’affiche la synthèse client|
|*ALORS*
L’entrée de menu contextuelle Récent n’est pas affiché.| {panel:bgColor=#e3fcef}
*Contexte :* 

* Le but de cette US est de rendre l’entrée de *menu Récent  sous forme d’un sous menu* (voir la capture écran ci-dessous) pliable afin de pouvoir le déplier pour voir les 5 dernières consultations par objet. 
* *Lorsqu’on survole avec la souris le sous menu Récent alors la ligne est surlignée avec le code couleur objet correspondant.*

* *Lorsqu’on survole une référence client, contrat, … consultée. Alors, la ligne est surlignée avec le code couleur objet correspondant.*
{panel}

{panel:bgColor=#deebff}
*Besoin :*

En tant qu’un utilisateur de  l’IHMC

Je souhaite que le *menu Récent  soit* pliable / dépliable 

Afin d'éviter les erreurs d’inattention qui peuvent être engendrées par les agents.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

* Adapter la disposition des éléments graphiques aux différentes résolutions des écrans utilisées par les transporteurs à savoir 1024 x 769, 1280 X 1024 et 1920 X1080 en minimisant le scroll vers le bas d’écran.
* La nouvelle IHMC est supportée uniquement par Firefox 38+.
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|001|Fonctionnelle|Rendre le menu récent pliable/dépliable pour afficher  l’historique des 5 derniers clients, contrats, contrats tiers payant|
|002|Fonctionnelle|La fonctionnalité doit être développée pour l’IHMC2|",0,1
nan,0,1
nan,0,2
"FP725 - SIS interface liste des ventes (DIS_A_07) ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client SIG effectuant une vente sur un équipement “Canal mobile” ou “AMT SNCF” ou “T10”
Le fichier de liste de vente est envoyé au SIG|
|*QUAND*
Je lance le nouveau batch de liste de vente SIS avec le code partenaire 1432 (SIS)|
|*ALORS*
La vente est correctement intégrée dans le SIG|
|{panel:bgColor=#deebff}
*Scénario 2 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client SIG effectuant une vente sur un équipement 3T 
Le fichier de liste de vente est envoyé au SIG|
|*QUAND*
Je lance l’ancien batch de liste de vente avec le code partenaire 3T correspondant|
|*ALORS*
La vente est correctement intégrée dans le SIG| {panel:bgColor=#e3fcef}
*Contexte* : 

Actuellement le flux de “*liste de ventes*” est transmis depuis les transporteurs (SNCF, RATP, OPTILE), vers le SIG. Ce flux contient toutes les ventes réalisées sur les équipements de vente de ces transporteurs. 

{color:#ff5630}Il existe également un flux de “{color}{color:#ff5630}*liste de ventes*{color}{color:#ff5630}” qui est transmis depuis le SIS vers le SIG, pour les ventes réalisées par “Canal Mobile”. {color}

Dans le cadre de la mise en œuvre du SIS, nous souhaitons {color:#ff5630}permettre la gestion de deux nouveaux émetteurs dans le flux de ventes SIS vers SIG.  {color}{color:#ff5630}-créer un nouveau flux de liste de ventes entre le SIG et le SIS à l’image de celui entre le SIG et les 3T. Ce flux contiendra les données de ventes réalisées sur les nouveaux équipements connectés au SIS-{color}.

Les seuls types de forfaits vendus côtés SIS et donc présents sur ce flux seront les suivants : 

* Navigo Mois / Semaine
* TST Réduction 50% et 75%
* TST Gratuité

A noter que les flux existants avec les 3T seront conservés.
{panel}

{panel:bgColor=#deebff}
*Besoin* :

En tant que responsable du projet SIS, je souhaite que le SIG puisse intégrer {color:#ff5630}deux nouveaux émetteurs dans le flux de ventes en provenance du SIS. {color}{color:#ff5630} -un nouveau flux de vente en provenance du SIS afin d’intégrer les ventes réalisées depuis les équipements connectés au SIS-{color}. 

NB : Aucun fichier d’acquittement n’est attendu pour le moment de la part du SIG, mais sera demandé dans une prochaine évolution. 
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* :

N/A
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|Ref 1|Fonctionnel|Le SIG doit proposer un nouveau batch identique au BATCH-PASSE-645, permettant d’intégrer les fichiers de ventes en provenance du SIS avec les codes émetteurs ci-dessous :  
* {color:#ff5630}-07001 : Canal Mobile-{color}
* 07002 : AMT SNCF
* 07003 : T10|
|Ref 2|Fonctionnel|Le batch de vente SIS doit pouvoir échanger avec le code partenaire *1432* (SIS)|
|Ref 3|Fonctionnel|Le SIG doit permettre d’intégrer les fichiers de ventes en provenance de SIS avec le format de nommage suivant :  *TT_XXYYY_AAAAMMJJHHMMSS_NNN.dat* 
Avec : 
* *TT* : Ce code correspond au type de fichier. Il vaut systématique *30* pour les données de ventes
* *XXYYY*  : Ce code permet d’identifier l’émetteur du compte rendu de distribution en succès
* *AAAAMMJJHHMMSS* : Désigne la date de transmission du fichier d’échange.
* *NNN* : Numéro de séquence. 
+Exemples :+ 30_07001_20210810030445_001.dat
{panel:bgColor=#fffae6}
Aucun contrôle SIG n’est attendu sur ce format de nommage de fichier. 
{panel}|
|Ref 4|Fonctionnel|Le traitement de recyclage doit prendre en compte ces nouveaux émetteurs.|
|Ref 5|Fonctionnel|Le SIG doit afficher l'agent vente en gras ci-dessous selon le code émetteur : 
* {color:#ff5630}-07001 : Canal Mobile =>- {color}{color:#ff5630}*-Mobile-*{color}
* 07002 : AMT SNCF => *SNCF*
* 07003 : T10 => *T10*|",0,1
nan,0,1
"FP798 - Optimisation des communications ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :  Envoi d’email suite aux actes : Perte/vol et non réception par téléphone pour le produit NMS*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client NMS|
|*QUAND*
J’effectue un acte SAV *Perte/vol et non réception*  par téléphone|
|*ALORS*
Je reçois un email de confirmation| {panel:bgColor=#e3fcef}
*Contexte :*

Actuellement, quand un client ayant souscrit un contrat NMS effectue une “_demande de remplacement perte/vol (7)_“ ou une “_demande de remplacement suite non réception_” (8), par téléphone, il ne reçoit aucun e-mail de confirmation, en contre partie.  
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

En tant que membre du SC, je souhaite qu’un e-mail de confirmation soit envoyé au client NMS quand ce dernier effectue l'acte SAV : *“**_demande de remplacement perte/vol_**”(7)* ou “*_demande de remplacement suite non réception_* *(8)”* uniquement par le canal  *téléphone* afin de le rassurer et éviter les réitérations d’appels.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|11977__001|Fonctionnelle|Le Template de l’email suite aux acte SAV pour le produit NMS: 
Sous le nom *ECONFSAVPTNMS*:
[^ECONFSAVPTNMS (faa77fcc-97a6-423a-9572-1ee33d5a89d1).docx]|
|11977__002|Fonctionnelle|Les actes SAV suite auxquels l’envoie d’email devra être effectué : 
* Perte/vol et non réception|
|11977__003|Fonctionnelle|L’envoi d’e-mail se fait suite à une “Demande de remplacement perte/vol” ou “Demande de remplacement suite non réception” réalisée par téléphone. *Attention* : Pas d’envoi d’e-mails suite aux actes SAV réalisés {color:#bf2600}en agence ou par les SEL{color}
* L’action en attente d’envoi de mail ne doit se faire que si le client a une adresse mail.|
|12242__04|Fonctionnelle|2 évènements devront déclencher l’envoi de cet Email selon la section “*Périmètre*” dans le tableau du  premier onglet de l' [[ETUDE] Chiffrages des différents scénarios pour la conception des mails pour les Produits : iR/NA/NL+ et les passes - Etudes & Projets - Confluence (atlassian.net)|https://comutitres.atlassian.net/wiki/spaces/EP/pages/2874835160/ETUDE+Chiffrages+des+diff+rents+sc+narios+pour+la+conception+des+mails+pour+les+Produits+iR+NA+NL+et+les+passes]  
* 17 - remplacement perte/vol effectuée
* 19 - remplacement non réception effectué|
|12242__05|Fonctionnelle|Les ZVAs à concevoir dans le ce template  pour l’acte SAV  “Perte/vol et non réception “ sont : 
# %acteréalisé%
# %numeroPasse%|
|12242__06|Fonctionnelle|L’e-mail devra être envoyé au porteur OU au porteur = payeur|",0,2
"FP393 - Amélioration de l’IHMC SIG ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Consulter Client*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un agent RATP utilisant l’IHMC|
|*QUAND*
Je clique sur un client depuis le résultat de recherche
Et je clique sur Consulter|
|*ALORS*
L'écran Synthèse Client est affiché en respectant la nouvelle charte graphique de l’IHMC SIG|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Saisir Client*
{panel}|
|*ÉTANT DONNE QUE*
*Je suis un agent SNCF utilisant l’IHMC*|
|*QUAND*
Je clique sur l’entrée de menu Client
Et je clique sur Saisir|
|*ALORS*
L'écran Synthèse Client est affiché en respectant la nouvelle charte graphique de l’IHMC SIG| {panel:bgColor=#e3fcef}
Contexte :

Le but de cette US est de mettre à jour l’aspect visuel des écrans « Client» en se basant sur les éléments graphiques de la nouvelle charte de l’IHMC SIG.

+*Le périmètre de la modernisation visuelle :*+

* Rechercher
* Consulter
* Nouvelle recherche
* Retour résultat recherche
* Saisir
* Saisir client personne morale

{panel}

{panel:bgColor=#deebff}
Besoin :

En tant qu’utilisateur de l’IHMC

Je souhaite que les écrans “Client” soient mis à la nouvelle charte graphique IHMC SIG

Afin d’améliorer l’IHMC.
{panel}

{panel:bgColor=#ffebe6}
Prérequis :

* Adapter la disposition des éléments graphiques aux différentes résolutions des écrans utilisées par les transporteurs à savoir 1024 x 769, 1280 X 1024 et 1920 X1080 en minimisant le scroll vers le bas d’écran.
* La nouvelle IHMC est supportée uniquement par Firefox 38+.
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|001|Fonctionnelle|Mettre l'Écran Client à la nouvelle charte graphique|
|002|Fonctionnelle|Adapter l'écran aux différentes résolutions des écrans utilisées par les transporteurs à savoir 1024 x 769, 1280 X 1024 et 1920 X1080 en réduisant le scroll vertical.|",0,1
"FP499 - Sujet ESI Bruits et Silences logs ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*QUAND*  :
 * le contrat IRS est créé à l'état _0 - inexistant_ suite à un encaissement lors de la saisie
 * la réévaluation met le contrat à l'état _23 - traitement back office_
 * le BATCH-COU-540 est lancé|
|*ALORS*  
 * l'évènement _1282 - Envoi courriel AR formulaire effectué_ est journalisé sur le contrat et le mail est envoyé.|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*{panel}|
|*QUAND*  
 * le contrat IRS est créé à l'état 3 _- Actif_ suite à la saisie
 * le contrat est mis à l'état _3 - Impayé_ suite à un impayé
 * le BATCH-COU-540 est lancé|
|*ALORS*  
 * l'évènement _9906 - Mail non envoyé_ est journalisé sur le contrat et le mail n'est pas envoyé.|
|{panel:bgColor=#ddeeff}
*Scénario 3 (NR) :*{panel}|
|*QUAND*  
 * le contrat IRS est créé à l'état 3 _- Actif_ suite à la saisie
 * le BATCH-COU-540 est lancé|
|*ALORS*  
 * l'évènement _1282 - Envoi courriel AR formulaire effectué_ est journalisé sur le contrat et le mail est envoyé.| {panel:bgColor=#e3fcef}
*Contexte :*

La mantis [https://mantis.comman-pw01.msp.fr.clara.net/view.php?id=54472] a remonté des logs indiquant que deux contrats sont en échec suite au passage du _BATCH-COU-540 - Traitement de génération et envoi de courriels pour communiquer sur les contrats iR nouvellement intégrés dans le SIG_. Ce batch poste et traite l'action _1106 - Envoi courriel AR formulaire_ pour ensuite envoyer directement le mail.

Après analyse, il s'avère que lors du passage du batch, ces contrats étaient à l'état _23 - traitement back office_ et que celui-ci n'est pas géré par le paramétrage des évènements à enregistrer liés à l'action 1106, alors qu'il est bien dans les états autorisés de l'action.
{panel}
{panel:bgColor=#deebff}
*Besoin :*

Le besoin est de corriger les états du paramétrage des évènements à enregistrer liés à l'action _1106 - Envoi courriel AR formulaire_ pour correspondre avec les états autorisés sur l'action *pour les produits IRS et IRE*. Il faudra également en profiter pour corriger une erreur de paramétrage en remplaçant le motif bloquant 1301 sur l'action par le motif 1031.
{panel}
h2. *Exigences :*

 
||Référence                                        ||Type                                             ||Exigences                                                     ||
|001|Fonctionnelle|Ajouter les états _8 - Résilié COMUTITRES, 9 - Résilié gestionnaire, 10 - Résilié transporteur, 11 - Cloturé, 12 - Appel sortant à faire, 13 - Non joignable, 14 - Client à dédoublonner, 15 - Attente justificatifs, 18 - Attente paiement GRC, 19 - Abandon confirmé, 20 - Contentieux, 23 - Traitement back office, 24 - Non finalisé_, sur l'évènement à enregistrer reliant l'action 1106 à l'évènement _9906 - Mail non envoyé_ pour les produits IRS et IRE.|
|002|Fonctionnelle|Ajouter les états _12 - Appel sortant à faire, 13 - Non joignable, 14 - Client à dédoublonner, 15 - Attente justificatifs, 18 - Attente paiement GRC, 19 - Abandon confirmé,_ _23 - Traitement back office_ sur l'évènement à enregistrer reliant l'action 1106 à l'évènement _1282 - Envoi courriel AR formulaire effectué_ pour les produits IRS et IRE.|
| 003| Fonctionnelle|Retirer les états _4 - Impayé, 5 - Retard, 6 - Suspendu, 7 - Résilié client_ de l'évènement à enregistrer reliant l'action 1106 à l'évènement _1282 - Envoi courriel AR formulaire effectué_ pour les produits IRS et IRE.|
|004|Fonctionnelle|Corriger le motif bloquant _1301 - Autres données modifiées_ par le motif bloquant _1031 - Adresse email incorrecte_ sur l'action 1106 pour les produits IRS et IRE.|
|005|Fonctionnelle|Ajouter l'action autorisée avec l'indicateur à N pour les états _4 - Impayé, 5 - Retard, 6 - Suspendu, 7 - Résilié client, 8 - Résilié COMUTITRES, 9 - Résilié gestionnaire, 10 - Résilié transporteur, 11 - Cloturé, 20 - Contentieux, 24 - Non finalisé_ pour les produits IRS et IRE.|",0,1
"FP605 - sujet metier SIG S1 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Souscrire contrat NA*
{panel}|
|*ÉTANT DONNE QUE*  Je suis un conseillers CRC|
|*QUAND*  je souscris un contrat NA
*ET* je valide|
|*ALORS*  la souscription se fait sans erreur| {panel:bgColor=#e3fcef}
*Contexte :*

La mantis [https://mantis.comman-pw01.msp.fr.clara.net/view.php?id=26078|https://mantis.comman-pw01.msp.fr.clara.net/view.php?id=26078] a remonté que le prestataire CRC n'a plus le droit de souscrire des contrats NA, un message  d’erreur bloque la souscription du a l’absence de la référence du contrat :

* 
!image-20220524-134408.png|width=606,height=118!


Après analyse, il s’avère que suite à l'évolution 1648 (version 10.0),  un motif bloquant est levé si la référence de contrat commercial n’est pas fournie en entrée et que le canal est différent de 'Face à Face” (ci-joint la cause probable) 

* !image-20220517-093128.png|width=654,height=134!

Alors que pour CRC on doit autoriser la souscription NA (même sans référence contrat) tout en gardant le même fonctionnement pour SEL et les souscriptions par formulaire .
{panel}

{panel:bgColor=#deebff}
*Besoin :*

 En tant que CRC, je souhaite pouvoir faire des souscriptions NA 
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

  
{panel}

h2. *Exigences :* 

 

||Référence||Type||Exigences||
|Ref 1|Fonctionnel|Permettre à CRC de faire les souscriptions NA quel que soit le canal de la demande|",0,1
"FP875 - Sujet metier SIG 2023 S2 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Spécifications à jour*
{panel}|
|*ÉTANT DONNE QUE*
Je suis PO|
|*QUAND*
Je fais référence aux spécifications du SIG|
|*ALORS*
Ces spécifications sont conformes au code| {panel:bgColor=#e3fcef}
*Contexte* : Une page de recensement des spécifications en décalage avec le code ou dont les règles de gestion sont sujettes à interrogation a été créée : [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741940886/Grand+recensement+des+sp+cifications+douteuses|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741940886/Grand+recensement+des+sp+cifications+douteuses|smart-link]

Cette page est alimentée au fur et à mesure de la découverte des non conformités.
{panel}

{panel:bgColor=#deebff}
*Besoin* : *En tant que PO du SIG, je souhaite que les spécifications soient le reflet du code afin d’en assurer la conformité.*

Le besoin consiste à traiter les différents points de la page de [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741940886/Grand+recensement+des+sp+cifications+douteuses|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741940886/Grand+recensement+des+sp+cifications+douteuses|smart-link] afin de remettre en cohérence spécifications et code.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|12721_001|Fonctionnel / rédactionnel|Mise en conformité des spécifications selon [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741940886/Grand+recensement+des+sp+cifications+douteuses|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741940886/Grand+recensement+des+sp+cifications+douteuses|smart-link]|",0,1
nan,0,2
nan,0,1
"FP875 - Sujet metier SIG 2023 S2 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE* je suis un utilisateur de l’IHMC,|
|*QUAND* je suis sur la page *IHMC-EVT-050 - Opération* ,|
|*ALORS* chaque champ de formulaire doit avoir une étiquette et être rattaché au bon bloc|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*  je suis un utilisateur de l’IHMC,|
|*QUAND* je suis sur la page *IHMC-EVT-163 - Synthèse du nombre de passes consommées*|
|*ALORS* chaque champ de formulaire doit avoir une étiquette et être rattaché au bon bloc|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE* je suis un utilisateur de l’IHMC,|
|*QUAND* je suis sur la page *IHMC-DOC-020 - Consulter un document*|
|*ALORS* chaque champ de formulaire doit avoir une étiquette et être rattaché au bon bloc|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE* je suis un utilisateur de l’IHMC,|
|*QUAND* je suis sur la page *IHMC-DOC-100 - Enregistrer un document*|
|*ALORS* chaque champ de formulaire doit avoir une étiquette et être rattaché au bon bloc| {panel:bgColor=#e3fcef}
*Contexte* : Un audit a été réalisé sur l’IHMC concernant le respect des règlementations d’accessibilité RGAA et les conclusions de cet audit ont mis en évidence plusieurs axes d’amélioration pour faire progresser la note d’accessibilité du site.

L’une des évolutions recommandées concerne la présence d’une étiquette sur chaque champ de formulaire. En effet on remarque que ces étiquettes sont souvent absentes ou que le libellé n’est pas techniquement bien rattaché au champ correspondant. Une étude [https://comutitres.atlassian.net/browse/SIG-12951|https://comutitres.atlassian.net/browse/SIG-12951|smart-link] a donc été réalisée pour déterminer les pages impactées ainsi qu’une solution pour corriger le problème. La présente US a pour but de mettre en œuvre cette solution.
{panel}

{panel:bgColor=#deebff}
*Besoin* : En tant qu’utilisateur de l’IHMC, je souhaite que soit ajoutés des labels pour les champs des formulaires et que les labels des champs mal renseignés soient corrigés, afin d’améliorer la note RGAA du site.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|13228_1|Fonctionnelle|Pour chacune des pages de l’IHMC ci-dessous, il faut remplacer lorsqu’elles sont présentes, les balises <div> liées aux champs de formulaires par des <label>|
|13228_2|Fonctionnelle|Pour chacune des pages de l’IHMC ci-dessous, s’il n’y a ni de balise <div>, ni de balise <label> rattachée à un champ de formulaire, alors il faut rajouter une balise <label>|
|13228_3|Fonctionnelle|Pour chacune des pages de l’IHMC ci-dessous, pour chaque balise <label> présente ou nouvellement ajoutée, il faut ajouter si elle n’est pas présente, un attribut propriété ID “for” pour la rattacher au champ de formulaire adéquat|

Pages IHMC concernées : 

|IHMC-AMET-CAD-100 - Saisir un contrat tiers payant|
|{color:#ff5630}IHMC-CAD-100 - Saisir un contrat tiers payant{color}|
|{color:#ff5630}IHMC-CAD-130 - Modifier un contrat tiers payant {color}|
|IHMC-CAD-140 - Modifier les caractéristiques d'un contrat cadre Navigo Annule|
|IHMC-CAD-150 - Résilier un contrat tiers payant|
|IHMC-CAD-200 - Enregistrer un encaissement comptant|
|IHMC-CAD-230 - Enregistrer une régularisation financière|
|IHMC-CAD-290 - Ajout d'une action manuelle sur un contrat tiers payant|
|{color:#ff5630}IHMC-CAD-900 - Rechercher mandat SEPA{color}|
|{color:#ff5630}IHMC-EVT-050 - Opération{color}|
|{color:#ff5630}IHMC-EVT-101 - Rechercher les actions à effectuer{color}|
|IHMC-EVT-101b - Rechercher les actions à effectuer|
|IHMC-EVT-160 - Contrôle de fin de session|
|IHMC-EVT-162 - Contrôle des recettes - Affichage du détail|
|IHMC-EVT-163 - Synthèse du nombre de passes consommées|
|IHMC-EVT-181 - Ecran synthèse Superviseur|
|{color:#ff5630}IHMC-EVT-205 - Action à effectuer{color}|
|{color:#ff5630}IHMC-HAB-001 - Contrôle d'accès{color}|
|{color:#ff5630}IHMC-HAB-100 - Créer un profil{color}|
|IHMC-HAB-110 - Gérer les autorisations d'accès d'un profil|
|IHMC-HAB-111 - Paramétrer les autorisations d'accès : liste des actions attribuables|
|IHMC-HAB-112 - Paramétrer les autorisations d'accès : liste des actions attribuées|
|IHMC-HAB-120 - Gérer les autorisations d'accès|
|IHMC-HAB-135 - Fonctions profil|
|IHMC-HAB-200 - Rechercher un utilisateur|
|IHMC-HAB-220 - créer un utilisateur|
|IHMC-HAB-220 bis - Modifier, réactiver, désactiver, suspendre, débloquer ou supprimer un utilisateur|
|IHMC-HAB-300 - Modifier les lieux d'accès|
|IHMC-HAB-520 - Identification externe|
|IHMC-HAB-560 - Choix du lieux d'accès et du visuel passe|
|IHMC-PASSE-001 - Rechercher un passe|
|IHMC-PASSE-001sav - Rechercher un passe|
|IHMC-PASSE-145- Enregistrer la mise au rebut d'un passe|
|IHMC-PASSE-190- Ajout d'une action manuelle sur le passe|
|IHMC-PASSE-200- Recherche des lots de commandes|
|IHMC-PASSE-225- Mise en opposition de droits TST|

En {color:#ff5630}rouge{color} le pages à tester",0,2
nan,0,2
"FP447 - Refonte des iban etrangers ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Génération d’un prélèvement avec bloc spécifique de changement bancaire avec code BIC différent*
{panel}|
|*ÉTANT DONNE QUE*
# Je suis client disposant d’un contrat NL+ au prélèvement sur une domiciliation bancaire étrangère *ayant déjà été prélevé*
# J’ai effectué un changement de domiciliation bancaire vers une banque étrangère avec un code BIC différent du précédent|
|*QUAND*
Je suis prélevé à l'échéance suivante|
|*ALORS*
# Le motif _1182 - Modification de mandat SEPA – banque différente_ et le motif _Première Occurrence de prélèvement_ sont levés
# Le fichier de prélèvement contient un bloc indiquant la valeur SMNDA|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Génération d’un prélèvement avec bloc spécifique de changement bancaire avec même code BIC* 
{panel}|
|*ÉTANT DONNE QUE*
# Je suis client disposant d’un contrat NL+ au prélèvement sur une domiciliation bancaire étrangère *ayant déjà été prélevé*
# J’ai effectué un changement de domiciliation bancaire vers une banque étrangère avec un code BIC identique au précédent|
|*QUAND*
Je suis prélevé à l'échéance suivante|
|*ALORS*
# Le motif _1181- Modification de mandat SEPA – même banque_ est levé
# Le fichier de prélèvement contient un bloc indiquant la valeur SMNDA|

(!) Le scénario 1 est à vérifier pour des cas de changement de domiciliation bancaire étrangère vers française et inversement
(!) Les scénario 1 et 2 sont à vérifier pour des cas de changement de domiciliation bancaire français vers français {panel:bgColor=#e3fcef}
*Contexte :*

+Processus de prélèvement bancaire+

Le processus de prélèvement bancaire repose sur la notion de mandat SEPA. Un client autorise son compte à être prélevé en vertu de ce mandat. 

Cependant, il se peut qu’un client décide de changer le compte bancaire sur lequel le contrat est prélevé : il effectue alors un changement de domiciliation bancaire affecté au contrat. Dans ce cas, le client ne doit pas signer de nouveau mandat SEPA. Ce changement est géré automatiquement dans le processus de prélèvement entre les banques.

Techniquement, cela se traduit par l’ajout de bloc spécifique dans le fichier de prélèvement (cf. [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741916384/CON-701+G+n+rer+fichier+temporaire+de+pr+l+vement|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741916384/CON-701+G+n+rer+fichier+temporaire+de+pr+l+vement|smart-link] au niveau des RG 6 à 16). L’ajout de ce bloc est conditionné à la levée des motifs _1181 - Modification de mandat SEPA – même banque_ et _1182 - Modification de mandat SEPA – banque différente_ et à la présence d’un IBAN précédent dans la table E_CON_PRELEVEMENT_SEPA (colonne PREL_BANQ_PRECEDENT_IBAN).

Ces motifs sont levés dans le CU [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741920060/FIN-390+V+rifier+Mandat+SEPA+pour+pr+l+vement+SDD+SEPA|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741920060/FIN-390+V+rifier+Mandat+SEPA+pour+pr+l+vement+SDD+SEPA|smart-link] appelé par le [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741930544/FIN-213+Enregistrer+un+pr+l+vement+SEPA|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741930544/FIN-213+Enregistrer+un+pr+l+vement+SEPA|smart-link] au niveau des RG 17 et 18.

+Évolutions IBAN étrangers+

Les domiciliations bancaires sont stockées dans la table E_CLT_DOMICILIATION_BANCAIRE. Suite aux développements de la 22.2, cette table contient désormais deux colonnes IBAN et deux colonnes BIC. Elles sont alimentées ainsi :

* Pour les IBAN français :
** DOM_IBAN = DOM_IBAN2
** DOM_BIC_SAISIE = DOM_BIC_SAISIE2
* Pour les IBAN étrangers :
** DOM_IBAN <> DOM_IBAN2. DOM_IBAN contient l'IBAN générique. DOM_IBAN2 contient l'IBAN réel du client
** DOM_BIC_SAISIE <> DOM_BIC_SAISIE2. DOM_BIC_SAISIE est NULL ou contient un code BIC générique. DOM_BIC_SAISIE2 contient le code BIC réel du client.

Le processus de prélèvement a été mis à jour en 22.2 pour être en mesure de prélever les IBAN étrangers en automatique. 
{panel}

{panel:bgColor=#deebff}
*Besoin :*

La levée de ces motifs se base sur une comparaison entre les codes BIC de l'établissement bancaire des domiciliations bancaires N et N-1 d’un contrat. Ainsi, dans le cas d’un changement de domiciliation bancaire d’un IBAN étranger vers un autre IBAN étranger, il n’est pas possible de détecter un changement d'établissement bancaire car il est identique pour tous les IBAN étrangers.

*En tant que membre de la DAF, je souhaite que les ordres de prélèvement contiennent les indications de changement de domiciliation bancaire sur un mandat quand un client passe d’une domiciliation bancaire étrangère vers une autre domiciliation bancaire étrangère afin d'éviter un rejet de prélèvement par la banque.*
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

 Saisie, souscription et prélèvement sur IBAN étranger développés.
{panel}

h2. *Exigences :*

||*Référence*||*Type*||*Exigences*||
|FONC-SIG-7471-001|Fonctionnel|Lorsqu’un contrat a fait l’objet d’un changement de domiciliation bancaire (quelque soit le sens de ce changement : français vers français, français vers étranger, étranger vers français, étranger vers étranger…), le fichier de prélèvement précise dans son contenu que le prélèvement du contrat a lieu sur une nouvelle domiciliation bancaire mais qu’il utilise le même mandat SEPA.
(!) Le fichier de prélèvement fait la distinction entre un changement de domiciliation bancaire dans une même banque et un changement de domiciliation bancaire vers une banque différente de la banque initiale.|
|TECH-SIG-7471-001|Technique|Le motif _1181 - Modification de mandat SEPA – même banque_ est levé lorsqu’un contrat a fait l’objet, entre deux prélèvements, d’un changement de domiciliation bancaire en restant dans le même établissement bancaire.
Pour les domiciliations bancaires françaises, il suffit de comparer les codes BIC des établissements bancaires
Pour les domiciliations bancaires étrangères, il suffit de comparer les 8 premiers caractères des codes BIC.|
|TECH-SIG-7471-002|Technique|Le motif _1182 - Modification de mandat SEPA – banque différente_ est levé lorsqu’un contrat a fait l’objet, entre deux prélèvements, d’un changement de domiciliation bancaire en changeant d'établissement bancaire.
Pour les domiciliations bancaires françaises, il suffit de comparer les codes BIC des établissements bancaires
Pour les domiciliations bancaires étrangères, il suffit de comparer les 8 premiers caractères des codes BIC.|",0,1
nan,0,1
nan,0,1
nan,0,1
"FP458 - Ameliorations parcours existant suspension SE ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client porteur / payeur d'un contrat NA qui est suspendu depuis 12 mois|
|*QUAND*
Celui-ci est automatiquement résilié par le SIG|
|*ALORS*
Je reçois un mail correspondant au template RESPOSTSUSP2, pour m’avertir que celui-ci a été automatiquement résilié.|
|{panel:bgColor=#deebff}
*Scénario 2 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client porteur / payeur d'un contrat NA, qui est suspendu depuis 10 mois|
|*QUAND*
Je fais une reprise de mon contrat|
|*ALORS*
Je ne reçois aucun mail de résiliation, même après 12 mois.| {panel:bgColor=#e3fcef}
*Contexte :*

Un client Navigo Annuel, qui a été suspendu, est automatiquement résilié au bout de 12 mois si le client ne fait pas de reprise de son contrat. En dehors des CGVU, le client n’est pas averti de cette résiliation automatique de son contrat NA.  
{panel}

{panel:bgColor=#deebff}
*Besoin :*

Envoyer un email aux clients pour les prévenir de la résiliation de leur contrat NA suite à non reprise au delà de 12 mois de suspension.  
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

Le template du courriel à envoyer.
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|001|Fonctionnelle|Le SIG doit envoyer automatiquement un email aux clients respectant les conditions suivantes : 
* ayant un contrat NA qui a été résilié automatiquement par le SIG suite à non reprise. 
* et dont le payeur du contrat a une adresse mail|
|002|Fonctionnelle|Celui-ci doit correspondre au template “RESPOSTSUSP2”.|
|003|Fonctionnelle|Cet email doit être envoyé au client payeur du contrat uniquement.|",0,2
nan,0,2
"FP447 - Refonte des iban etrangers ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Souscription NA en agence avec DOM étrangère*{panel}|
|*ÉTANT DONNE QUE* 
 Je suis un client qui souhaite souscrire à un contrat NA en agence 
 Que je fourni une domiciliation bancaire *étrangère* à l'agent|
|*QUAND*  
 L'agent édite le contrat NA afin de me le faire signer |
|*ALORS*  
 Le pavé mandat de prélèvement SEPA contient les données BIC et IBAN correspondant à ma domiciliation bancaire *étrangère*.
Le rendu ergonomique est identique à celui avec un IBAN français. |
|{panel:bgColor=#ddeeff}
*Scénario 2 (NR) :* *Souscription NA en agence avec DOM française*{panel}|
|*ÉTANT DONNE QUE*  
 Je suis un client qui souhaite souscrire à un contrat NA en agence 
 Que je fourni une domiciliation bancaire *française* à l'agent |
|*QUAND*  
 L'agent édite le contrat NA afin de me le faire signer  |
|*ALORS*  
 Le pavé mandat de prélèvement SEPA contient les données BIC et IBAN correspondant à ma domiciliation bancaire *française*.  | {panel:bgColor=#e3fcef}
*Contexte :*

Les mandats de prélèvements SEPA générés par le SIG contiennent entre autres les informations BIC et IBAN de la domiciliation bancaire rattachée au contrat commercial à prélever.

Exemple :

* !image-2021-12-02-15-46-54-126.png|width=701,height=435!

Ces données BIC et IBAN proviennent des colonnes ""DOM_IBAN"" et ""ETB_BIC"" de la table E_CLT_DOMICILIATION_BANCAIRE. Ces colonnes ne contiennent aujourd'hui que des domiciliations bancaires française. 

Deux nouvelles colonnes BIC et IBAN vont faire leur apparition dans le modèle de données SIG dans le cadre du projet FP447 ""Refonte des iban étrangers"" afin d'y stocker à la fois les domiciliations bancaires françaises et étrangères. 
{panel}

{panel:bgColor=#deebff}
*Besoin :*

Lors d'une souscription d'un forfait Navigo Annuel réalisée en agence 3T, le formulaire NA qui est édité par l'agent contient un pavé ""mandat de prélèvement SEPA"".

Exemple :

* !image-2021-12-02-15-40-52-252.png|width=84.1310642633337%!

  Les SIG doit désormais ici s'appuyer sur les deux nouvelles colonnes BIC et IBAN pour le renseignement des données BIC et IBAN afin de permettre l'affichage des domiciliations bancaires étrangères. 
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

* Pouvoir saisir une domiciliation bancaire étrangère à l'IHMC.  
{panel}

h2. *Exigences :* 

||Référence||Type||Exigences||
|Ref 1|Fonctionnelle|En cas de souscription d'un contrat Navigo Annuel *en agence*, associé à une domiciliation bancaire étrangère, alors le formulaire de souscription NA qui est édité en agence doit indiquer au niveau du pavé ""Mandat de prélèvement SEPA"", les BIC et IBAN de la domiciliation bancaire étrangère.|
|Ref 2|Ergonomique|Même avec un code IBAN étranger sur 34 caractères, celui-ci doit être affiché sur une seule ligne comme pour le code IBAN français sur 27 caractères.|
|Ref 3|Ergonomique|Même avec un code IBAN étranger sur 34 caractères, les différents éléments du mandat de prélèvement SEPA devront rester positionnés à la même position qu'avec un code IBAN français sur 27 caractères.
{panel:bgColor=#deebff}
Il est possible néanmoins de décaler un peu le champ IBAN vers la gauche afin de rester sur une seule ligne. 
{panel}|

 NB :

* Pour la solution, afin de minimiser les risques de régression, nous souhaitons que soient créées 2 nouvelles ZVA dédiées aux 2 nouvelles colonnes BIC et IBAN plutôt que de modifier les 2 ZVA BIC et IBAN actuelles. 
* Le template correspondant est CONTRATiNT",0,1
nan,0,1
"FP867 - Petits sujets techniques SIG 2023 S2 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : Dans le cadre du remplacement des EJB, nous entamons le module contrat
{panel}

{panel:bgColor=#deebff}
*Besoin* : Mettre en place une documentation pour découper le module contrat et écrire les solutions afférentes.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Type*||*Exigences*||
|Documentation|Découpage module contrat|
|Documentation|Rédaction des solutions du module contrat|",0,1
"FP447 - Refonte des iban etrangers ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :* *Changer domiciliation bancaire* *avec DOM étrangère*
{panel}|
|*ÉTANT DONNE QUE* 
Je suis un client ayant un contrat NA au prélèvement
Je me rend en agence pour demander un changement de domiciliation bancaire, afin d'utiliser une domiciliation bancaire *étrangère*|
|*QUAND*  
L'agent effectue le changement à l'IHMC|
|*ALORS*  
Un nouveau mandat de prélèvement SEPA est édité via l'IHMC et contient les données BIC et IBAN correspondant à la domiciliation bancaire *étrangère*. 
Le rendu ergonomique est identique à celui avec un IBAN français.|
|{panel:bgColor=#deebff}
*Scénario 2 (NR) :* *Changer domiciliation bancaire avec DOM française*
{panel}|
|*ÉTANT DONNE QUE*  
Je suis un client ayant un contrat NA au prélèvement
Je me rend en agence pour demander un changement de domiciliation bancaire, afin d'utiliser une domiciliation bancaire *française*|
|*QUAND*  
L'agent effectue le changement à l'IHMC|
|*ALORS*  
Un nouveau mandat de prélèvement SEPA est édité via l'IHMC et contient les données BIC et IBAN correspondant à la domiciliation bancaire *française*.|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) : Changer mode de paiement avec DOM française*
{panel}|
|*ÉTANT DONNE QUE*  
Je suis un client ayant un contrat NA au comptant
Je me rend en agence pour demander un changement de mode de paiement bancaire, afin de passer au prélèvement et l'associer à une domiciliation bancaire *française*|
|*QUAND*  
L'agent effectue le changement à l'IHMC|
|*ALORS*  
Un nouveau mandat de prélèvement SEPA est édité via l'IHMC et contient les données BIC et IBAN correspondant à la domiciliation bancaire *française*.|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) : Changer de payeur avec DOM française*
{panel}|
|*ÉTANT DONNE QUE*  
Je suis un client ayant un contrat NA au prélèvement
Je me rend en agence pour demander un changement de payeur, et l'associer à une domiciliation bancaire *française*|
|*QUAND*  
L'agent effectue le changement à l'IHMC|
|*ALORS*  
Un nouveau mandat de prélèvement SEPA est édité via l'IHMC et contient les données BIC et IBAN correspondant à la domiciliation bancaire *française*.| {panel:bgColor=#e3fcef}
*Contexte :*

Les mandats de prélèvements SEPA générés par le SIG contiennent entre autres les informations BIC et IBAN de la domiciliation bancaire rattachée au contrat commercial à prélever. ( En pièce jointe, un exemple de mandat SEPA)

 En cours de développement de la [https://comutitres.atlassian.net/browse/SIG-7304|https://comutitres.atlassian.net/browse/SIG-7304|smart-link], un point a  été soulevé par CDA,  il s’est avéré que le changement de domiciliation bancaire était impacté mais cela n’a pas été vu lors de la conception. 

Les tests sont bloqués côté CDA parce que la solution  ne traite que la modification IHMC et il faudra revoir le processus de changement de domiciliation bancaire.


{panel}



{panel:bgColor=#deebff}
*Besoin :*

Lors d'un changement de domiciliation bancaire pour un contrat Navigo Annuel, réalisé en agence 3T, un nouveau mandat SEPA est édité via l'IHMC afin de présenter au client le nouveau compte à débiter. 

En tant qu’agent, je souhaite générer un mandat SEPA avec un IBAN étranger quand le client demande le changement de sa domiciliation bancaire.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

  
{panel}

h2. *Exigences :* 

 

||Référence||Type||Exigences||
|Ref 1|Fonctionnelle|En cas de changement de domiciliation bancaire d'un contrat Navigo Annuel, par un IBAN étranger, alors le mandat SEPA  doit indiquer les BIC et IBAN de la domiciliation bancaire étrangère.|
|Ref 2|Ergonomique|L’IBAN doit être affiché sur une seule ligne|
|Ref 3|Ergonomique|Les différents éléments du mandat de prélèvement SEPA devront rester positionnés à la même position qu'avec un code IBAN français sur 27 caractères.|",0,1
nan,0,1
nan,0,1
nan,0,2
"FP867 - Petits sujets techniques SIG 2023 S2 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 3 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 4 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : Dans le cadre de la modernisation SIG, nous procédons à la refonte du socle batch.
{panel}

{panel:bgColor=#deebff}
*Besoin* : Etudier les solutions liées à : 

* BATCH-COU-540
* BATCH-COU-530
* BATCH-DOC-500
* BATCH-DOC-501
* BATCH-REP-200
* PPT-BATCH-FIN-501
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Type*||*Exigences*||
|Documentation|Ecrire les solutions nécessaires pour migrer les batchs : 
* BATCH-COU-540
* BATCH-COU-530
* BATCH-DOC-500
* BATCH-DOC-501
* BATCH-REP-200
* PPT-BATCH-FIN-501|",0,1
"FP597 - IR C22 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Abandon depuis SEL*
{panel}|
|*ÉTANT DONNE QUE*                    
Je suis un client avec un contrat iRS|
|*QUAND*  
Je fais une demande d’abandon depuis les SEL de mon contrat|
|*ALORS*  
Le contrat est au statut “Abandonné” dans le SIG 
Une action à effectuer de confirmation d’abandon est enregistrée sur le contrat|
|{panel:bgColor=#deebff}
*Scénario 2 : Confirmation d’abandon dans le SIG (NR)*
{panel}|
|*ÉTANT DONNE QUE*  
Je suis un prestataire du SC|
|*QUAND*  
Je confirme l’abandon de la souscription suite à la demande depuis les SEL|
|*ALORS*  
Le contrat est au statut “Abandon confirmé”
Une action de Remboursement comptant LCABSOUS est présente dans les actions à effectuer
Une action d’envoi de courriel de confirmation d’abandon est présente dans les actions à effectuer| {panel:bgColor=#e3fcef}
*Contexte :*

 Suite au changement de marché, les tâches relatives aux abandon de contrats ne sont pas gérées correctement
{panel}

{panel:bgColor=#deebff}
*Besoin :*

 Ajouter une action à traiter à destination du prestataire de gestion client pour confirmer l’abandon 
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

Vérifier les situations d’abandon qui demandent une confirmation

Processus identique entre iRS et iRE 
{panel}

h2. *Exigences :* 

||Référence||Type||Exigences||
|001|Fonctionnelle|Ajout d’une action spécifique pour la confirmation d’abandon (action 88) depuis un abandon par le client depuis les SEL (Motif 283 Volonté client)
{panel:bgColor=#fffae6}
SEL n'envoie pas de motif 1283 dans l’appel du WS API-CON-490 

Une évolution est prévue côté SEL pour envoyer dans l’appel le motif 283 et le motif 1283 
{panel}|
|002|Fonctionnelle|Un événement spécifique doit être journalisé pour indiquer que l’abandon de souscription depuis les SEL est confirmé|
|003|Fonctionnelle|Les actions à effectuer potentielles sur le contrat abandonné doivent être supprimées : 
* 26: Appel sortant
* 27: Réévaluation automatique incomplétude
* 28: Réévaluation automatique sous 48 H
* 29: Dédoublonner contrat
* 236: Attente données financement TP - Souscription
* 501: Édition courrier INCOMPL|
|004|Fonctionnel|L’état consécutif du contrat est Abandonné (code 2)|
|005|Fonctionnel|Les produits concernés sont IRS et IRE|",0,2
nan,0,2
"FP875 - Sujet metier SIG 2023 S2 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 3 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 4 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : Suite à l'étude [https://comutitres.atlassian.net/browse/SIG-12092|https://comutitres.atlassian.net/browse/SIG-12092|smart-link] qui porte sur la problématique de tentative d’insertion de 5 droits dans un passe, nous avons identifié qu’une cause possible de ce phénomène d’avoir autant de droits insérés dans un passe est le non contrôle de la date de fin de droits d’un produit NA lors de son insertion. Nous pensons aussi que les règles sont doublonnées et que le seul bloc SI à garder serait [le premier|https://comutitres.atlassian.net/wiki/spaces/EP/pages/3014983784/SIG-12092+R+tro+documentation+-+Insertion+des+droits+dans+les+passes.#CU-sp%C3%A9cifique-de-recherche-des-droits]
{panel}

{panel:bgColor=#deebff}
*Besoin* : Avant de démarrer les travaux de modification de ces règles, nous avons besoin de comprendre en détail ce qui va se produire lorsqu’on supprimera ces règles : 

# Quels sont les critères des éventuels droits qui s’inséraient avant mais plus après 
# Quels sont les critères des éventuels droits qui ne s’inséraient pas avant mais qui le seront après

Inclure dans l'étude la partie SLS
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Type*||*Exigences*||
|Documentation|Quels sont les critères des éventuels droits qui s’inséraient avant mais plus après la suppression de tous les blocs SI sauf celui de la [7ème ligne de l’algo|https://comutitres.atlassian.net/wiki/spaces/EP/pages/3014983784/SIG-12092+R+tro+documentation+-+Insertion+des+droits+dans+les+passes.#CU-sp%C3%A9cifique-de-recherche-des-droits]|
|Documentation|Quels sont les critères des éventuels droits qui ne s’inséraient pas avant mais qui le seront après la suppression de tous les blocs SI sauf celui de la [7ème ligne de l’algo|https://comutitres.atlassian.net/wiki/spaces/EP/pages/3014983784/SIG-12092+R+tro+documentation+-+Insertion+des+droits+dans+les+passes.#CU-sp%C3%A9cifique-de-recherche-des-droits]|",0,1
"FP865 - Petits sujets NL+ 2023 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Rechercher un CC résilié (Client, Gestionnaire, Comutitres)*
{panel}|
|*ÉTANT DONNE QUE* je suis un exploitant du SIG|
|*QUAND* je recherche un CC d’un contrat NL+ résilié (les 3 cas) en ne précisant pas l’identifiant du contrat de transport
*ET quand* la date du trajet est {color:#ff5630}*supérieure* {color}à la date de fin de validité du contrat  NL+|
|*ALORS* j’ai bien les infos du CC en sortie en plus du motif, date de résiliation et date fin du contrat commercial|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Rechercher un CC résilié (Client, Gestionnaire, Comutitres)*
{panel}|
|*ÉTANT DONNE QUE* je suis un exploitant du SIG|
|*QUAND* je recherche un CC d’un contrat NL+ résilié (les 3 cas) en ne précisant pas l’identifiant du contrat de transport
*ET quand* la date du trajet est {color:#ff5630}*inférieure* {color}à la date de fin de validité du contrat  NL+|
|*ALORS* j’ai bien les infos du CC en sortie en plus du motif, date de résiliation et date fin du contrat commercial|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) : Rechercher un CC Actif*
{panel}|
|*ÉTANT DONNE QUE* je suis un exploitant du SIG|
|*QUAND* je recherche un CC d’un contrat NL+ actif (en précisant ou pas le contrat de transport)|
|*ALORS* j’ai bien les infos du CC en sortie| {panel:bgColor=#e3fcef}
*Contexte* : 

* Actuellement, lorsque SIMS interroge le SIG pour obtenir le contexte commercial d’un contrat NL+ résilié, si le contrat de transport n’est pas renseigné alors le SIG répond en disant qu’il ne connait pas ce CC.
* L’interrogation se fait par l’API [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762532282/PPT-API-CON-870-V2+-+R+cup+rer+le+contexte+commercial+d+un+contrat+sur+r+ception+d+un+trajet+valoriser|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762532282/PPT-API-CON-870-V2+-+R+cup+rer+le+contexte+commercial+d+un+contrat+sur+r+ception+d+un+trajet+valoriser|smart-link]
* Cet appel sera fait à chaque reconstitution au fil de l’eau (chaque 1 heure en PROD et chaque 2 minutes en recette). Ce qui donne lieu à des appels inutiles et écrit beaucoup de logs inutilement.
* {color:#ff5630}Il faut noter que ce cas fonctionnel peut correspondre à un client résilié, pour lequel le passage en liste noire n’a pas été effectué.{color}
{panel}

!image-20221014-100232.png|width=83.33333333333334%!

{panel:bgColor=#deebff}
*Besoin* : 

* Si l'état du contrat commercial est “Résilié Gestionnaire” / “Résilié Comutitres” / “Résilié client”, que l’API puisse renvoyer comme réponse comme précisé sur la [https://comutitres.atlassian.net/browse/SIG-6308|https://comutitres.atlassian.net/browse/SIG-6308|smart-link] : 
** la date de mise en opposition, 
** la date et heure de fin du contrat
** ainsi que le motif de mise en opposition 
* Pour cela, il serait possible de changer le comportement du  [https://comutitres.atlassian.net/wiki/spaces/DA/pages/2610890839/PPT-CON-305+-+Rechercher+les+contrats+commerciaux+Post-Paiement+ayant+re+u+un+trajet+valoriser|https://comutitres.atlassian.net/wiki/spaces/DA/pages/2610890839/PPT-CON-305+-+Rechercher+les+contrats+commerciaux+Post-Paiement+ayant+re+u+un+trajet+valoriser|smart-link] pour qu’il fasse un contrôle au tout début sur l'état du contrat commercial correspondant aux paramètres en entrée.
* En effet, le problème avec le CU actuel est qu’il ne trouve aucune ligne dans la recherche du CU PPT-CON-305, à cause des lignes 6 et 7. L’idée ici est donc d'éviter cette recherche comme un contrat “Résilié Gestionnaire” / “Résilié Comutitres” / “Résilié client” devrait renvoyer à VEC une réponse telle que demandée dans la [https://comutitres.atlassian.net/browse/SIG-6308|https://comutitres.atlassian.net/browse/SIG-6308|smart-link].
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 

N/A
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|01|Fonctionnelle|Pour un contrat commercial NL en état “Résilié Gestionnaire” / “Résilié Comutitres” / “Résilié client”, l’interrogation de son contexte commercial par VEC, sans “Identifiant du contrat de transport” doit renvoyer comme retourner : 
* le contexte commercial de manière nominale
* ET la date de fin de validité forcée au dernier jour (23:59:59) du mois de la date de fin du contrat commercial.
* ET renvoyer comme valeur de la date de mise en opposition : la date et heure de la résiliation du contrat commercial
* ET renvoyer comme motif de mise en opposition : 
** 205 pour un contrat commercial en état Résilié COMUTITRES
** 1067 pour un contrat commercial en état “Résilié Gestionnaire
** 206 pour un contrat commercial en état Résilié Client|
|02|Documentation|La mise à jour de la documentation doit mettre à jour la documentation de l’API[https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762532282/PPT-API-CON-870-V2+-+R+cup+rer+le+contexte+commercial+d+un+contrat+sur+r+ception+d+un+trajet+valoriser|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762532282/PPT-API-CON-870-V2+-+R+cup+rer+le+contexte+commercial+d+un+contrat+sur+r+ception+d+un+trajet+valoriser|smart-link] pour laquelle une modification a été apportée par l’implémentation de la [https://comutitres.atlassian.net/wiki/spaces/EP/pages/1721651472/SOLU+SIG-6308+NL+WS+r+cup+ration+contexte+commercial+renvoyer+une+date+de+mise+en+oppo+et+motif+pour+contrats+r+sili+s|https://comutitres.atlassian.net/wiki/spaces/EP/pages/1721651472/SOLU+SIG-6308+NL+WS+r+cup+ration+contexte+commercial+renvoyer+une+date+de+mise+en+oppo+et+motif+pour+contrats+r+sili+s|smart-link]|",0,1
nan,0,2
nan,0,2
nan,0,2
nan,0,2
nan,0,1
nan,0,1
"FP499 - Sujet ESI Bruits et Silences logs ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*ÉTANT DONNE QUE*  je suis l'exploitant                                            |
|*QUAND*  je lance le batch RECYCL-001|
|*ALORS*  je n'ai pas de fausses erreurs qui remontent| {panel:bgColor=#e3fcef}
*Contexte :*

Lors du passage du BATCH-RECYCL-001, des exceptions ExceptionRechercheInfructueuse sont parfois levées à tort pour le motif de rejet 14 suppression pour demande de remboursement ultérieur.

Lors du passage du BATCH-RECYCL-001, des exceptions IndexOutOfBoundsException sont parfois levées pour le même motif.
{panel}
{panel:bgColor=#deebff}
*Besoin :* Corriger le traitement existant pour qu'il s'effectue correctement lorsqu'il le devrait et ne plus remonter d'erreurs techniques sans message compréhensible ni d'erreurs à tort.
{panel}
h2. *Exigences :* 

 
||Référence                                        ||Type                                             ||Exigences                                                     ||
|001|Technico-Fonctionnel|Lorsque le client possède plusieurs contrats commerciaux éligibles au traitement on les traite tous.|
|002|Technico-Fonctionnel|Lorsque le client ne possède aucun contrat éligible on lève une erreur avec un message explicite.|",0,1
nan,0,2
"FP867 - Petits sujets techniques SIG 2023 S2 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : Dans le cadre de la modernisation de SIG, une étude a été réalisée pour identifier les gains de mettre à jour la version d’EJB. Cette étude met en avant deux opporunités : 

* Migration des services métier EJB2.1 en service EJB3 
* Migration de la persistance EJB2.1 en implémentation JPA

Si EJB 2.1 a été abandonné c'est parce que cette technologie souffre de plusieurs problèmes importants :

* la lourdeur d'écriture impactant la productivité
* la complexité de mise en œuvre entravant la maintenance
* le besoin de formation spécifique du fait de la quasi absence de profils sur le marché connaissant cette technologie
* la limite des services rendues par l’api de fait qu’elle n’est plus développée depuis 2004
{panel}

{panel:bgColor=#deebff}
*Besoin* : Porter les ejb évènements reporting entité
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : [https://comutitres.atlassian.net/browse/SIG-12285|https://comutitres.atlassian.net/browse/SIG-12285|smart-link] 
{panel}

h2. Exigences : 

||*Type*||*Exigences*||
|Technique|organiser l'implémentation des entités évènements reporting JPA  en parallèle des EJB entité équivalent|
|Technique|Vérifier la cohabitation dans Weblogic 12.2|
|Documentation|Préciser dans la solution la version des EJB et JPA utilisés|
|Documentation|Précision dans la solution le nombre de services et d'entités impactés|",0,1
"FP605 - sujet metier SIG S1 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client au tarif Tout public 
Avec un contrat NA suspendu|
|*QUAND*
Je demande la bascule de mon profil vers Senior|
|*ALORS*
Un message bloquant est affiché indiquant que la bascule n’est pas possible du fait de ne pas avoir de contrat de transport actif.|
|{panel:bgColor=#deebff}
*Scénario 2 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client au tarif Tout public 
Avec un contrat NA actif|
|*QUAND*
Je demande la bascule de mon profil vers Senior|
|*ALORS*
Mon profil client et contrat NA sont basculés au tarif Senior.| {panel:bgColor=#e3fcef}
*Contexte :*

La bascule d'un client NA vers Senior devrait normalement être bloquée si le contrat NA est suspendu. Or ce n'est pas le cas. 

Ce comportement est dû à un trou fonctionnel SIG qui a été détecté lors de l'analyse de ce ticket [SIG-6511]
{panel}

{panel:bgColor=#deebff}
*Besoin :*

 L'objectif de cette demande est de résoudre ce trou fonctionnel afin d’obliger le client à faire une reprise NA avant de pouvoir basculer son contrat.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

  N/A
{panel}

h2. Exigences :

||Référence||Type||Exigences||
|Ref 1|Fonctionnel|Un client ne doit pas pouvoir basculer au profil Senior s’il possède un contrat Navigo Annuel sans contrat de transport à l'état actif.|",0,1
"FP447 - Refonte des iban etrangers ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Ajouter un nouveau BIC/IBAN via SEL*
{panel}|
|*ÉTANT DONNE QUE* 
Je suis un client sur les SEL disposant de domiciliations bancaires françaises et étrangères|
|*QUAND*
# Je consulte mes moyens de paiements 
# J'ajoute une nouvelle domiciliation bancaire étrangère|
|*ALORS*
# Je visualise correctement mes domiciliations bancaires (aucune valeur générique ne s’affiche)
# La nouvelle domiciliation bancaire est correctement ajoutée|
|{panel:bgColor=#deebff}
*Scénario 2 (NR) : Ajouter un nouveau BIC/IBAN français via SEL*
{panel}
*ÉTANT DONNE QUE* 
Je suis un client sur les SEL disposant de domiciliations bancaires françaises et étrangères|
|*QUAND*
# Je consulte mes moyens de paiements 
# J’ajoute une nouvelle domiciliation bancaire française|
|*ALORS*
# Je visualise correctement ma domiciliation bancaire
# La nouvelle domiciliation bancaire est correctement ajoutée| 

{panel:bgColor=#e3fcef}
*Contexte :*

Les domiciliations bancaires sont stockées dans la table E_CLT_DOMICILIATION_BANCAIRE. Suite aux US de saisie d'un IBAN étranger de la 22.2,  cette table contient désormais deux colonnes IBAN et deux colonnes BIC. Elles sont alimentées ainsi :

* Pour les IBAN français :
** DOM_IBAN = DOM_IBAN2
** DOM_BIC_SAISIE = DOM_BIC_SAISIE2
* Pour les IBAN étrangers :
** DOM_IBAN <> DOM_IBAN2. DOM_IBAN contient l'IBAN générique. DOM_IBAN2 contient l'IBAN réel du client
** DOM_BIC_SAISIE <> DOM_BIC_SAISIE2. DOM_BIC_SAISIE est NULL ou contient un code BIC générique. DOM_BIC_SAISIE2 contient le code BIC réel du client.

Un client, par SEL, peut gérer ses moyens de paiement. La page affiche la liste des moyens de paiement de l’utilisateur et donne ensuite la possibilité d’ajouter une domiciliation bancaire à un client en lui faisant renseigner son IBAN et son BIC.

Cette fonctionnalité utilise : 

* l’API-CLI-010 pour lister les domiciliations bancaires
* l'API-CLI-SEPA-120 pour ajouter une domiciliation bancaire

Suite aux développements de la 22.2, le SIG a été amélioré pour gérer les IBAN étrangers via l’IHM. Le lot 2 du projet IBAN étranger est de permettre au client d’utiliser SEL pour effectuer les opérations classiques de souscription et de SAV.
{panel}

{panel:bgColor=#deebff}
*Besoin :*

En tant que client possédant un IBAN étranger, je souhaite grâce aux SEL de : 

* Pouvoir visualiser mes domiciliations bancaires
* Ajouter une nouvelle domiciliation bancaire étrangère comme nouveau moyen de paiement
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

Développements IBAN étranger en 22.2 finalisés.
Client ayant un compte en ligne.
{panel}

h2. *Exigences :* 

||Référence||Type||Exigences||
|FONC-SIG-7516-001|Fonctionnelle|L’API-CLI-SEPA-120 permet d’ajouter un IBAN étranger à un client.|
|FONC-SIG-7516-002|Fonctionnelle|L’API-CLI-010 retourne les domiciliations bancaires d’un client en précisant l’IBAN et le code BIC réels du client qu’il soit étranger ou français.
(i) Les champs correspondant au format RIB sont toujours alimentés (avec les valeurs réelles pour les domiciliations bancaires françaises ou les valeurs génériques pour les domiciliations bancaires étrangères).|
|TECH-SIG-7516-001|Technique|Aucune nouvelle version d’API ne doit être développée.|",0,1
"FP874 - Sujet metier SIG 2023 S1 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Agent SNCF change le mode de paiement vers le comptant*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un agent SNCF 
*ET* je me connecte sur le poste PVM 1.6 via Firefox|
|*QUAND* 
j’identifie un contrat IRS ou IRE ou NA actif au prélèvement
*ET* je change le mode de paiement 
*ET* je sélectionne “comptant” 
*ET* je valide|
|*ALORS* 
L'écran IHMCCON410 s’affiche au premier plan|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Agent OPTILE change le mode de paiement vers le comptant*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un agent OPTILE
*ET* je me connecte via Firefox|
|*QUAND* 
j’identifie un contrat IRS ou IRE ou NA actif au prélèvement
*ET* je change le mode de paiement 
*ET* je sélectionne “comptant” 
*ET* je valide|
|*ALORS* 
L'écran IHMCCON410 s’affiche au premier plan| {panel:bgColor=#e3fcef}
*Contexte* :  

Suite à l’anomalie [https://comutitres.atlassian.net/browse/SIG-9397|https://comutitres.atlassian.net/browse/SIG-9397|smart-link], on constate un problème d’affichage de fenêtre sur les postes suivants :  

* *SNCF PVM 1.6, Firefox (Rec6 - 207d - V23_2_0b-R1)*
* *Optile SLS, Firefox (Rec6 - 207d - V23_2_0b-R1)*

Parcours de reproduction : 

* Se connecter à l’ihmc en tant qu’agent SNCF ou OPTILE
* Consulter un contrat IRs actif au prélèvement 
* Changer le mode de paiement vers le comptant
* Valider, 

Alors l'écran *IHMCCON410* qui permet d’enregistrer un encaissement s’affiche {color:#bf2600}*en arrière plan*{color}{color:#bf2600}.{color} 
{panel}

+*IHMCCON410*+ :

!image-20230125-142411.png|width=773,height=670!

{panel:bgColor=#deebff}
*Besoin:*

*En tant que* agent SNCF ou OPTILE

*je souhaite* voir l'écran *IHMCCON410*  au premier plan

*Afin* de valider d’avoir une ergonomie correcte 
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|9742_001|Fonctionnelle|Le SIG doit toujours présenter l' IHMCCON410 au premier plan quel que soit  : 
* le profil utilisateur
* le poste agence utilisé
* le produit consulté (IRE / IRS / NA)|",0,1
nan,0,2
nan,0,2
nan,0,1
nan,0,2
nan,0,2
"FP875 - Sujet metier SIG 2023 S2 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Client payeur existant à l'état Décédé*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client déclaré décédé|
|*QUAND*
Je souhaite souscrire pour un porteur différent|
|*ALORS*
Les SEL m’indiquent que je ne suis pas éligible|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Client payeur existant à l'état Exclu à la demande du client*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client existant ayant demandé à être exclu|
|*QUAND*
Je souhaite souscrire pour un porteur différent|
|*ALORS*
Les SEL m’indiquent que je ne suis pas éligible|
|{panel:bgColor=#e3fcef}
*Scénario 3 : Client porteur existant à l'état Décédé*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client potentiel|
|*QUAND*
Je souhaite souscrire pour un porteur déclaré décédé|
|*ALORS*
Les SEL m’indiquent qu’il n’est pas éligible|
|{panel:bgColor=#e3fcef}
*Scénario 4 : Client porteur existant à l'état Exclu à la demande du client*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client potentiel|
|*QUAND*
Je souhaite souscrire pour un porteur différent ayant demandé à être exclu|
|*ALORS*
Les SEL m’indiquent qu’il n’est pas éligible|
|{panel:bgColor=#deebff}
*Scénarios (NR) : souscription iRS / iRE pour un porteur ou un payeur à l'état Décédé ou Exclu à la demande du client*
{panel}| {panel:bgColor=#e3fcef}
*Contexte* : 

La [SIG-2404] a permis de créer un service d'affectation permettant à un client se connectant sur les Services En Ligne d'évaluer son éligibilité à souscrire à un produit donné : [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741937874/REST-API-CON-001-V1+-+valuer+l+ligibilit+d+un+client+un+produit|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1741937874/REST-API-CON-001-V1+-+valuer+l+ligibilit+d+un+client+un+produit|smart-link] 

Quelques lacunes de ce service ont pu être résorbées via l’US [https://comutitres.atlassian.net/browse/SIG-6750|https://comutitres.atlassian.net/browse/SIG-6750|smart-link] mais il s’avère que l'état du porteur et du payeur ne sont pris en compte que dans le cadre de souscription aux produits imagine R, ce que l’US actuelle vise à modifier.
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

*En tant que SEL, je souhaite que les clients porteurs ou payeurs dans un état décédé ou exclu ne puissent être éligibles à la souscription, quel que soit le produit concerné.*

Le but de cette US est de vérifier l’état du porteur et du payeur quel que soit le produit et, si l’état du client est _5 – Décédé_ ou _6 – Exclu à la demande du client,_ de lever le motif bloquant correspondant (comme ce qui est actuellement réalisé pour imagine R).
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 

N/A
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|12257_001|Fonctionnel|Si le payeur existe, le web service doit vérifier son état : s’il est _5 – Décédé_ ou _6 – Exclu à la demande du client_ alors le client n’est pas éligible à la souscription.|
|12257_002|Fonctionnel|Si le porteur existe, le web service doit vérifier son état : s’il est _5 – Décédé_ ou _6 – Exclu à la demande du client_ alors le client n’est pas éligible à la souscription.|",0,1
nan,0,1
nan,0,2
"FP602 - petits sujets techniques SIG 2022 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte :*

 A l’occasion des modifications qui sont faites à l’IHMC dans le cadre de la modernisation, nous souhaitons profiter de l’occasion pour corriger les issues SONAR associées aux pages qui seront modifiées. 

L’objectif est de pouvoir mutualiser les tests, ainsi que de gagner du temps par le fait qu’il s’agit d’une partie de code déjà en cours de modification.
{panel}

{panel:bgColor=#deebff}
*Besoin :*

 Corriger l’ensemble des issues SONAR associées aux parcours modifiés par l'évolution [https://comutitres.atlassian.net/browse/SIG-7541|https://comutitres.atlassian.net/browse/SIG-7541|smart-link] .
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

  
{panel}

h2. *Exigences :* 

 

||Référence||Type||Exigences||
|Ref 1|Type 1|Corriger les issues des pages de ce parcours|
|Ref 2|Type 2|Corriger uniquement l’IHMC2|",0,1
nan,0,1
nan,0,1
"FP393 - Amélioration de l’IHMC SIG ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : imagine R scolaire*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un agent RATP utilisant l’IHMC|
|*QUAND*
Je clique sur un client depuis le résultat de recherche
Et je clique sur “imagine R scolaire”|
|*ALORS*
L'écran Synthèse Client Souscription est affiché en respectant la nouvelle charte graphique de l’IHMC SIG|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Navigo Liberté +*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un agent SNCF utilisant l’IHMC|
|*QUAND*
Je clique sur un client depuis le résultat de recherche
Et je clique sur “Navigo Liberté +”|
|*ALORS*
L'écran Synthèse Client Souscription est affiché en respectant la nouvelle charte graphique de l’IHMC SIG| {panel:bgColor=#e3fcef}
Contexte :

Le but de cette US est de mettre à jour l’aspect visuel des écrans « Client Souscription» en se basant sur les éléments graphiques de la nouvelle charte de l’IHMC SIG.

+*Le périmètre de la modernisation visuelle :*+

* imagine R scolaire
* Navigo
* imagine R étudiant
* Contrat tiers payant Amethyste
* Navigo Annuel 1cl
* Navigo Annuel
* Contrat tiers payant Navigo Annuel 1er classe
* Contrat IRTP étudiant
* Contrat IRTP scolaire
* Navigo Annuel GRC
* Contrat tiers payant Navigo Annuel
* Navigo Liberté +
{panel}

{panel:bgColor=#deebff}
Besoin :

En tant qu’utilisateur de l’IHMC

Je souhaite que les écrans “Client Souscription” soient mis à la nouvelle charte graphique IHMC SIG

Afin d’améliorer l’IHMC.
{panel}

{panel:bgColor=#ffebe6}
Prérequis :

* Adapter la disposition des éléments graphiques aux différentes résolutions des écrans utilisées par les transporteurs à savoir 1024 x 769, 1280 X 1024 et 1920 X1080 en minimisant le scroll vers le bas d’écran.
* La nouvelle IHMC est supportée uniquement par Firefox 38+.
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|001|Fonctionnelle|Mettre les écrans Client Souscription à la nouvelle charte graphique|
|002|Fonctionnelle|Adapter l'écran aux différentes résolutions des écrans utilisées par les transporteurs à savoir 1024 x 769, 1280 X 1024 et 1920 X1080 en réduisant le scroll vertical.|",0,1
nan,0,2
nan,0,2
"FP1087 - Sujet metier SIG 2024 S1 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client ayant un contrat NAS ayant débuté avant le 01/01/2023|
|*QUAND*
je demande une attestation de forfait NAS|
|*ALORS*
Le tarif Senior sur la période entre  le 01/10/2019 et le 01/01/2023 est affiché dans le tableau|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client ayant un contrat NAS ayant débuté en 2023|
|*QUAND*
je demande une attestation de forfait NAS|
|*ALORS*
Seuls les tarifs applicables sont affichés, soit les tarifs à partir du 01/01/2023|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
je suis un client ayant un contrat NA au tarif classique ayant débuté avant le 01/01/2023|
|*QUAND*
Je demande une attestation de forfait NA|
|*ALORS*
Les tarifs NA sont affichés sans distinction de la date de mise en service du tarif NAS| {panel:bgColor=#e3fcef}
*Contexte* : 

L’attestation pour un contrat NAS ayant débuté avant le 01/01/2023 n’ont pas le tarif mensuel affiché pour la période entre le 01/10/2019 et le 01/01/2023
{panel}

!image-20240131-165532.png|width=655,height=212!



{panel:bgColor=#deebff}
*Besoin* : 

Le besoin est de pouvoir afficher une ligne supplémentaire pour distinguer le tarif Senior  partir de sa date de mise en service si le contrat était au tarif Senior avant le 01/01/2023
{panel}

!image-20240131-165401.png|width=730,height=266!



{panel:bgColor=#ffebe6}
*Prérequis* : La cause probable de ce non affichage vient du fait que le tableau des tarifs est construit à partir des tarifs de NA, or il n’existe pas de tarif NAS correspondant à la date du tarif NA au 01/08/2017 de même qu’il n’existe pas de tarif NA en date du 01/10/2019 correspondant au tarif NAS

*Attention* le but est de conserver un affichage cohérent pour NA quand le contrat n’est pas au tarif Senior à savoir une seule ligne de tarif pour la période du 01/08/2017 au 01/01/2023
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|Ref 1|Fonctionnelle|Afficher une ligne dans le tableau de tarifs pour un contrat NAS et ayant débuté avant le 01/01/2023 (en fonction de la date d’application du tarif Senior sur le contrat)|",0,1
nan,0,2
nan,0,1
"FP847 - IR C23 Une étude sur la faisabilité et les impacts 

Un macro-chiffrage {panel:bgColor=#e3fcef}
*Contexte* : Dans le cadre de la campagne imagine R, on rencontre tous les ans des problématiques de flux avec les prestataires en charge de valider les différentes PJ. Cela génère des engorgements de contrats qui restent en attente de validation  
{panel}

{panel:bgColor=#deebff}
*Besoin* : Afin de désengorger la liste de contrats pour lesquels on attend une confirmation, Comutitres souhaiterait pouvoir valider en masse un certain nombre de PJ et lancer la réévaluation de contrat afin de faire avancer le workflow de validation de la souscription de ces contrats

*L’attendu de cette US est une étude de faisabilité et d’impact ainsi que le macro-chiffrage associé*
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|Ref 1|Fonction|Pouvoir valider en masse un type de justificatif sur une liste de contrats donnée en entrée (tous les types de documents sont éligibles) 
Les contrats sont réévalués et passent à l'état suivant selon les éléments présents et validés|
|Ref 2|Impact|Impacts sur le BATCH-CON-103 pour les PJ validées en masse suite au retour du prestataire pour la vraie validation/invalidation de la PJ|
|Ref 3|Impact|Impacts sur le BATCH-DOC-500 pour l’intégration des documents physiques et pour les rattacher aux contrats/événements|
|Ref 4|Impact|Impacts sur le BATCH-DOC-510 pour l’intégration des documents multi-type|
|Ref 5|Impact|Autres impacts ?|",0,1
nan,0,2
nan,0,2
"FP393 - Amélioration de l’IHMC SIG ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Gérer perte ou vol*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un agent RATP utilisant l’IHMC|
|*QUAND*
Je clique sur un contrat depuis le résultat de recherche
Et je clique sur Gérer perte ou vol|
|*ALORS*
L'écran Synthèse Contrat est affiché en respectant la nouvelle charte graphique de l’IHMC SIG|
|{panel:bgColor=#e3fcef}
*Scénario 2 :  Changer de porteur*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un agent SNCF utilisant l’IHMC|
|*QUAND*
Je clique sur l’entrée de menu Contrat
Et je clique sur Changer de porteur|
|*ALORS*
L'écran Nouveau porteur est affiché en respectant la nouvelle charte graphique de l’IHMC SIG| {panel:bgColor=#e3fcef}
Contexte :

Le but de cette US est de mettre à jour l’aspect visuel des écrans « Contrat MAJ» en se basant sur les éléments graphiques de la nouvelle charte de l’IHMC SIG.

+*Le périmètre de la modernisation visuelle :*+

* Gérer perte ou vol
* Changer zones
* Annuler contrat transport
* Gérer non réception
* Encaisser paiement
* Changer de porteur
* Gérer Hors service
* Compléter un contrat
* Gérer changement photo
* Résiliation (Comutitres)
* Action manuelle
* Réclamation
{panel}

{panel:bgColor=#deebff}
Besoin :

En tant qu’utilisateur de l’IHMC

Je souhaite que les écrans “Contrat MAJ” soient mis à la nouvelle charte graphique IHMC SIG

Afin d’améliorer l’IHMC.
{panel}

{panel:bgColor=#ffebe6}
Prérequis :

* Adapter la disposition des éléments graphiques aux différentes résolutions des écrans utilisées par les transporteurs à savoir 1024 x 769, 1280 X 1024 et 1920 X1080 en minimisant le scroll vers le bas d’écran.
* La nouvelle IHMC est supportée uniquement par Firefox 38+.
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|001|Fonctionnelle|Mettre l'Écran Contrat MAJ à la nouvelle charte graphique|
|002|Fonctionnelle|Adapter l'écran aux différentes résolutions des écrans utilisées par les transporteurs à savoir 1024 x 769, 1280 X 1024 et 1920 X1080 en réduisant le scroll vertical.|",0,2
"FP733 - Filiale - Recouvrement ||(!)||*Description*||
|1|Le WS ne doit pas faire l'objet d'une nouvelle version|
|2|En cas d'appel du WS de contexte commercial,
→ Si le contrat commercial est en état *Recouvrement IDFM*
Alors le WS doit retourner le contexte commercial de manière nominale 
ET la date de fin de validité forcée au dernier jour (23:59:59) du mois de la date de fin du contrat commercial 
ET renvoyer comme valeur de la date de mise en opposition la date et heure de la résiliation du contrat commercial
ET renvoyer comme motif de mise en opposition : 1507 (Client payeur avec contrat en recouvrement IDFM)|

  {panel:bgColor=#e3fcef}
Contexte : 

La transformation du GIE COMUTITRES en filiale d’IDFM implique de nombreux changements structurels. En particulier, la gestion des contrats entrants en cycle d’impayés. Toute la gestion du recouvrement s’effectuera désormais par IDFM à partir de juin 2023. La solution adoptée dans le SIG est la création d’un nouvel état appelé “Recouvrement IDFM”. 

Sur SIMS, Les validations des clients avec un état (liste : résilié client, résilié gestionnaire, résilié Comutitres) ne sont pas valorisées. Il faudra donc rajouter ce nouvel état à cette liste.
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

Modifier le WS d'interrogation du contexte commercial afin de prévoir un nouveau cas fonctionnel : retourner le infos du CC avec le motif de résiliation si le contrat est en recouvrement IDFM.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 

N/A
{panel}",0,1
nan,0,1
"FP597 - IR C22 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : client Souscription Primo SEL*
{panel}|
|*ÉTANT DONNE QUE* Je suis un client sans passe et sans contrat quand je fais une souscription primo
*ET* je saisie mal mes informations personnelles (nom, prénom ou date de naissance) dans l'étape titulaire 
*ET* Je valide cette étape|
|*QUAND* je reviens vers l'étape titulaire (avant de valider la prochaine étape)  pour modifier mes informations personnelles mal saisie (via le WS)|
|*ALORS* J’ai la main pour modifier ces informations et cette modification est prises en compte par le SIG|
|{panel:bgColor=#deebff}
*Scénario 2 (NR) : Client avec contrat Actif*
{panel}|
|*ÉTANT DONNE QUE* je suis un client avec un contrat actif
*ET* J’aperçois que je dois modifier des informations personnelles (nom, prénom ou date de naissance)|
|*QUAND* je reviens vers l'étape titulaire|
|*ALORS* ces informations sont grisées et la modification n’est pas permises| {panel:bgColor=#e3fcef}
*Contexte :* Actuellement, si le client valide l'étape titulaire lors d’une souscription primo de n’importe quel produit, et se rend compte d’une erreur de saisie dans l’un des champs (nom, prénom, date de naissance). Alors, il se retrouve dans l’incapacité de modifier ces champs, puisqu'ils deviennent grisés une fois l'étape titulaire est validée.
{panel}

{panel:bgColor=#deebff}
*Besoin :* En tant qu’utilisateur de SEL, je souhaite pouvoir modifier les informations client(nom, prénom, date de naissance) après validation de l'étape titulaire pour tous les produits.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :* 

* Client sans passe et sans contrat
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|Ref 1|Fonctionnel|Modifier les informations client porteur (nom, prénom, date de naissance) après validation de l'étape titulaire depuis SEL pour tous les produits.|
|Ref 2|Technique|Créer un WS pour pouvoir modifier les informations client|",0,2
nan,0,1
nan,0,2
nan,0,1
"FP739 - Gestion des opt in / opt out des mineurs ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Nouveau wording sollicitation IHMC*
{panel}|
|*ÉTANT DONNE QUE*
je me rends sur un compte client depuis l’IHMC|
|*QUAND*
J’observe les cases à cocher de sollicitations|
|*ALORS*
je constate que les libellés ont bien été modifiés conformément à la demande de SSI-DP| {panel:bgColor=#e3fcef}
*Contexte* : 

Le service SSI-DP souhaite modifier les phrases concernant l’acceptation des sollicitations via l’IHMC.
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

En tant que RSSI, je veux que les case Opt-in et Opt-out soient modifiées sur l’IHMC afin d’être plus clair.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|SIG-11862_1|Fonctionelle|L’opt-in de préférence de communication commerciale doit être présenté sur l’IHMC avec la phrase : 
“J’accepte de recevoir par email et/ou SMS des offres et informations commerciales de la part des entreprises de transports en commun d'Île-de-France, de leurs partenaires, et de la part d'Île-de-France Mobilités”|
|SIG-11862_2|Fonctionnelle|L'opt-out de préférence de communication institutionnelle doit être présenté sur l’IHMC avec la phrase : 
“Je ne souhaite pas recevoir par mail et/ou SMS, de la part d'Île-de-France Mobilités, d’informations relatives aux actualités du réseau ou aux nouveaux projets et services de transports et de mobilité en Île-de-France”|",0,1
nan,0,1
"FP1054 - Evolutions iR C24 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
* contrat iR dont le 9ème (dernier) prélèvement est revenu en impayé (le retour d’impayé enregistre un 10ème prélèvement à venir)
* génération des prélèvement (le 10ème) et passage de la dette à 0
* régularisation par le client de la dette en CB (la dette qui a été prélevée, cela va créer un solde en faveur du client sur le contrat)|
|*QUAND*
on enregistre le retour d’impayé du 10ème prélèvement|
|*ALORS*
Le contrat passe à Actif car le solde est revenu à 0 (le montant de l'impayé vient compenser le solde en faveur du client sur le contrat)|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*
* contrat iR dont le 9ème (dernier) prélèvement est revenu en impayé (pour motif Domiciliation invalide, le retour d’impayé enregistre un 10ème prélèvement à venir)
* régularisation de la dette en CB par le client, le solde du contrat est à 0|
|*QUAND*
* génération des prélèvement (le 10ème) 
{panel:bgColor=#eae6ff}
Avant l'évolution, il y a enregistrement d’un événement de “Prélèvement non effectué avec mise en retard” car la domiciliation est invalide
{panel}|
|*ALORS*
le contrat passe Actif|
|{panel:bgColor=#e3fcef}
*Scénario 3  :*
{panel}|
|*ÉTANT DONNE QUE*
* contrat iR dont le 9ème (dernier) prélèvement est revenu en impayé (pour motif *différent de* Domiciliation invalide, le retour d’impayé enregistre un 10ème prélèvement à venir)
* génération des prélèvement (le 10ème) 
* on enregistre le retour d’impayé du 10ème prélèvement → Le contrat passe à l'état retard et un tâche en attente de mise en contentieux est postée
* on enregistre un geste commercial équivalent à la dette du contrat|
|*QUAND*
La mise en contentieux est réalisée|
|*ALORS*
le contrat passe Actif| {panel:bgColor=#e3fcef}
*Contexte* : 

Lorsqu’on enregistre un retour en impayé sur un contrat iR pour le dernier prélèvement, un prélèvement supplémentaire est ajouté pour permettre de tentative supplémentaire.

Suite à cette nouvelle tentative le contrat reste à l’état impayé.  En effet il faut conserver cet état pour pouvoir passer le contrat à l'état Retard si le prélèvement revient en impayé encore une fois

Si le retour du dernier prélèvement (alors que le contrat est encore en impayé) revient en erreur (exemple pour une domiciliation bancaire invalide/ changement de RIB par la banque) alors le contrat passe en retard puis en contentieux.

Le problème intervient si le client vient régulariser se dette avant le retour de l’impayé de la banque. En effet le contrat passera en retard puis contentieux (60 jours après) alors qu’il n’a plus de dette 
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

Un contrat qui a un solde nul (ou en sa faveur) ne doit plus pouvoir passer à l'état Retard ou Contentieux
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

!image-20240202-165737.png|width=100%!

crédits schémas [iR - Cycle de vie contrats commerciaux - Documentation Asset - Confluence (atlassian.net)|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1746149948/iR+-+Cycle+de+vie+contrats+commerciaux]

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|Ref 1|Fonctionnelle|Lors de l’enregistrement du retour en impayé du prélèvement (ACT-51), si le solde du contrat est nul ou en faveur du client, l'état du contrat doit être passé à Actif|
|Ref 2|Fonctionnelle|En cas de passage en contentieux d’un contrat commercial (BATCH-CON-610), si le solde du contrat est nul ou en faveur du client, le contrat doit passer à l'état Actif|
|Ref 3|Fonctionnelle|En cas de prélèvement (ACT-45), si le motif “Domiciliation bancaire invalide” est levé mais que le montant du prélèvement est nul ou en faveur du client alors le contrat doit passer à Actif|",0,2
"FP1085 - Petits sujets techniques SIG S1 2024 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : 
{panel}

{panel:bgColor=#deebff}
*Besoin* : Remplacement des EJB Module Contrat 5
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Type*||*Exigences*||
|Technique|Remplacement des EJB Module Contrat 5|",0,2
"FP733 - Filiale - Recouvrement ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
je suis un client avec un contrat NA, iR ou NL+ avec une dette et éligible à la clôture|
|*QUAND*
le traitement BATCH-FIN-590 est exécuté avec le paramètre d’exclusion des contrat en dette à True|
|*ALORS*
le contrat du client n’est pas clôturé|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*
je suis un client avec un contrat NA, iR ou NL+ avec une dette et éligible à la clôture|
|*QUAND*
le traitement BATCH-FIN-590 est exécuté avec le paramètre d’exclusion des contrat en dette à False|
|*ALORS*
le contrat du client est clôturé|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
je suis un client avec un contrat NA, iR ou NL+ sans dette et éligible à la clôture|
|*QUAND*
le traitement BATCH-FIN-590 est exécuté avec le paramètre d’exclusion des contrat en dette à True|
|*ALORS*
le contrat du client est clôturé|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
je suis un client avec un contrat NA, iR ou NL+ sans dette et éligible à la clôture|
|*QUAND*
le traitement BATCH-FIN-590 est exécuté avec le paramètre d’exclusion des contrat en dette à False|
|*ALORS*
le contrat du client est clôturé|
|{panel:bgColor=#deebff}
*Scénario 5 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
je suis un client avec un contrat NA, iR ou NL+ avec un profit et éligible à la clôture|
|*QUAND*
le traitement BATCH-FIN-590 est exécuté avec le paramètre d’exclusion des contrat en dette à True|
|*ALORS*
le contrat du client est clôturé| {panel:bgColor=#e3fcef}
*Contexte* : 

Dans le cadre de la filiale, la procédure de recouvrement forcé a été mise en place afin de ne plus abandonner de dette aux clients.

Pour cela une série de traitements a été développée permettant de gérer un nouvel état de contrat et de transférer la dette au comptable public 

Pour autant, certains contrats ne sont pas passés en recouvrement selon l'état du client payeur ou selon le montant de la dette sur le contrat.
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

Modifier le traitement de clôture des contrats (BATCH-FIN-590) pour avoir la possibilité d’exclure les contrats avec une dette  
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|Ref 1|Fonctionnelle|Exclure les contrats éligible à la clôture qui présentent une dette|
|Ref 2|Fonctionnelle|Rendre cette exclusion paramétrable en entrée de batch (prévoir un fonctionnement par défaut  si le booléen n’est pas précisé en entrée du traitement)|",0,1
"FP875 - Sujet metier SIG 2023 S2 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE* je suis un testeur|
|*QUAND* j’effectue une résiliation gestionnaire sur un client NA avec un passe en cours de fabrication suite à un P/V|
|*ALORS* le contrat est bien résilié gestionnaire
*ET* le nouveau passe est bloqué|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE* je suis un testeur|
|*QUAND* j’effectue une résiliation gestionnaire sur un client NA avec un passe en cours de fabrication suite à un renouvellement de passe en fin de vie|
|*ALORS* le contrat est bien résilié gestionnaire
*ET* le nouveau passe est bloqué| {panel:bgColor=#e3fcef}
*Contexte* : 

Lorsqu’un client NA effectue un acte SAV de P/V via SEL ou renouvelle son passe en fin de vie puis un gestionnaire derrière effectue une résiliation gestionnaire sur son contrat (avant la personnalisation du nouveau passe).

Le contrat est bien résilié mais le nouveau passe est fabriqué avec un droit Actif ce qui permet au client de continuer à voyager sans problème.

L’objectif de ce ticket est d’effectuer un correctif SIG pour ne plus avoir cette anomalie : 

[https://comutitres.atlassian.net/browse/SIG-12091|https://comutitres.atlassian.net/browse/SIG-12091|smart-link] 
{panel}

{panel:bgColor=#deebff}
*Besoin* : En tant qu'ESI, je souhaite que, si une résiliation gestionnaire s’effectue sur un client NA (avec un acte SAV de P/V en cours, ou un renouvellement de passe en fin de vie), et que le nouveau passe est en cours de personnalisation, que le droit de transport lié au contrat de ce client soit à l'état opposé
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|Ref 1|Fonctionnelle|Passer les droits au transports à Opposé pour les contrats résilier gestionnaire avec un passe  Actif|",0,1
nan,0,1
"FP500 - Plan de correction 2021 ||+Cas d'utilisation+||
|{panel}
*Scénario 1 : Affichage du document à partir de* *Evènements*{panel}|
|*ÉTANT DONNE QUE* 
 * Je suis *un utilisateur habilité à consulter les document en attente de suppression*|
|*QUAND* 
 * J'effectue une demande de suppression des données personnelles. La demande de suppression des données d'un client est approuvée.
 * Je vais consulter les évènements sur la fiche du client.|
|*ALORS*
 * Je retrouve l'évènement de Suppression des données personnelles effectuée
 * La référence du ou des documents supprimés est bien indiquée dans le champs Référence Documents
 * Le champs est bien cliquable et affiche le document quand je clique dessus.| {panel:bgColor=#e3fcef}
*Contexte :*

Un client peut demander la suppression de  ses documents conformément à la loi du RGPD. Si la demande est jugée recevable, les données du client seront supprimées du SIG. En revanche, les documents restent archivés pendant 30 jours et accessibles par les administrateurs avant la suppression définitive.
{panel}
{panel:bgColor=#deebff}
*Besoin :*

En tant que membre du SC, je souhaite que les documents qui ont fait l'objet d'une demande de suppression de données personnelles soient indiqués dans le détail de l'évènement journalisé afin de pouvoir mieux répondre aux questions du client.

Étapes à suivre:
 * Je vais sur la fiche du client.
 * Je clique sur Evénements.
 * Je clique sur le Libellé Suppression des données personnelles effectuées.
 * *Rajouter la référence*  du document dans le champ Références Documents. Ce champ doit être cliquable.
 * Au clic sur cette référence, le document est affiché pour les utilisateurs habilités.{panel}
h2. *Exigences :*
||Référence||Type||Exigences||
|SIG-6702-001|Fonctionnelle|La référence du document doit être ajoutée dans le champ Références Documents. Cette référence doit être cliquable|
|SIG-6702-002|Fonctionnelle|Au clic sur la référence, le document s'affiche|",0,1
nan,0,2
nan,0,2
"FP920 - Ma Mobilité 1.2 MVP ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : exécution du batch de nettoyage*
{panel}|
|*ÉTANT DONNE QUE*
Je suis l’exploitant du SIG|
|*QUAND*
J’exécute le batch de nettoyage des données clients|
|*ALORS*
* Le batch nettoie les données selon les règles de l’exigence 12029_002.
* Le batch génère un fichier contenant les clients à modifier.
* Le batch génère un compte-rendu.| {panel:bgColor=#e3fcef}
*Contexte* : 

Le projet Ma Mobilité lot 1.2 concerne les adaptations des assets SIG et APP à la version R5 du SIS et de la brique Tap2Use permettant de gérer les comptes IDFM Connect, ce qui entraine des changements pour l’asset APP (qui doit discuter avec SIS et non plus IDFM Connect) ainsi que l’asset SIG car les règles de gestion concernant les données des clients appairés évoluent.

Une étude a été réalisée [https://comutitres.atlassian.net/wiki/spaces/EP/pages/2843804246/MC+SIG-11405+Macro-chiffrage+tude+MM1.2+MVP|https://comutitres.atlassian.net/wiki/spaces/EP/pages/2843804246/MC+SIG-11405+Macro-chiffrage+tude+MM1.2+MVP|smart-link] afin d’identifier les impacts APP et SIG liés au MVP. Un nettoyage des données clients (nom, prénom et civilité) est notamment nécessaire afin de véhiculer des données conformes dans le processus de synchronisation entre SIG et SIS, via APP.
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

*En tant qu’ESI, je veux pouvoir nettoyer les données clients extraites du SIG afin de pouvoir procéder à une mise à jour ultérieure en base de données.*

Le besoin consiste à créer un batch de nettoyage des données extraites par le batch créé dans la [https://comutitres.atlassian.net/browse/SIG-12028|https://comutitres.atlassian.net/browse/SIG-12028|smart-link].
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : Création du batch d’extraction de la [https://comutitres.atlassian.net/browse/SIG-12028|https://comutitres.atlassian.net/browse/SIG-12028|smart-link] 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|12029_001|Fonctionnel|Un batch permettant de mettre à jour les données issues du batch créé dans la [https://comutitres.atlassian.net/browse/SIG-12028|https://comutitres.atlassian.net/browse/SIG-12028|smart-link] doit être créé.|
|12029_002|Fonctionnel|Ce batch prendra en entrée le fichier créé par le batch de la [https://comutitres.atlassian.net/browse/SIG-12028|https://comutitres.atlassian.net/browse/SIG-12028|smart-link]|
|12029_003|Fonctionnel|Le batch nettoiera les données prénom, nom, civilité et numéro de mobile selon les règles suivantes : 
* *Prénom et Nom* :
** Pas d’espace en début et fin de chaîne, autour d’un tiret ou apostrophe
** Pas plus d’un espace à la suite
** Pas de caractères autres que ceux de l’alphabet SAUF : espace, tiret et apostrophe
** Pas de majuscules accentuées 
* *Civilité*
** Les seules valeurs autorisées sont 1, 2 ou NULL : toute valeur différente (0, 3 ou 9 par exemple) sera transformée en NULL 
* *Numéro de mobile*
** Les seules valeurs autorisées sont les chaînes numériques de 10 chiffres commençant par 06 ou 07, le reste sera supprimé.
_Note : les points présents dans les noms ou prénoms seront simplement supprimés (pas de remplacement)_|
|12029_004|Fonctionnel|En sortie, le batch retournera un fichier contenant les clients à modifier, avec les données nettoyées.|
|12029_005|Fonctionnel|Le batch retournera un CR détaillé.|
|12029_006|Performance|Le traitement devra être optimisé afin d'être le plus performant possible.|",0,2
nan,0,1
nan,0,2
nan,0,1
nan,0,1
nan,0,2
nan,0,1
nan,0,1
"FP741 - Filiale - Gestes Co ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Enregistrer un remboursement NL+*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un agent 3T|
|*QUAND* 
je réalise un remboursement pour un client NL+|
|*ALORS*
On doit avoir un mouvement financier avec le montant de remboursement| {panel:bgColor=#e3fcef}
*Contexte* : Dans le cadre de la filialisation de Comutitres par IDFM, Un certain nombre d’actions sont à mettre en place pour se conformer à la réglementation légale liée à la filiale.

Parmi les actions demandées, c’est de faire la paramétrage événementiel nécessaire pour la gestion des remboursements pour le produit NL+ .
{panel}

{panel:bgColor=#deebff}
*Besoin* : Création du paramétrage événementiel pour la gestion de remboursement pour le produit NL+
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : la liste des motifs dans l’US 

[https://comutitres.atlassian.net/browse/SIG-9496|https://comutitres.atlassian.net/browse/SIG-9496|smart-link]
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|Ref 1|Paramétrage|Action NL+ : Enregistrer un remboursement|
|Ref 2|Paramétrage|Événements : un événement par motif de remboursement NL+ (lister dans [https://comutitres.atlassian.net/browse/SIG-9496|https://comutitres.atlassian.net/browse/SIG-9496|smart-link] )
*(limiter le nombre d'événements par rapport aux CRE à alimenter)*|
|Ref 3|Paramétrage|Le mouvement financier pour le remboursement est le mouvement 56 “remboursement accordé”|
|Ref 4|Fonctionnel|générer un mouvement financier avec le montant saisi sur l’IHMC|",0,1
nan,0,1
"FP867 - Petits sujets techniques SIG 2023 S2 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : Dans le cadre de la modernisation SIG, nous procédons à la refonte du socle batch. Ce batch [BATCH-PASSE-610-SIS|https://comutitres.atlassian.net/wiki/spaces/DA/pages/2782560257/BATCH-PASSE-610-SIS+-+G+n+ration+du+fichier+liste+noire+SIS] permet de générer un fichier de liste noire. Il contient l'intégralité des passes et droits au transport opposés et non périmés à la date de génération de la liste.

*Ce batch est le premier à migrer et qui contient un fichier sortant*
{panel}

{panel:bgColor=#deebff}
*Besoin* : Créer le batch [BATCH-PASSE-610-SIS|https://comutitres.atlassian.net/wiki/spaces/DA/pages/2782560257/BATCH-PASSE-610-SIS+-+G+n+ration+du+fichier+liste+noire+SIS] dans le nouveau socle batch
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : [https://comutitres.atlassian.net/browse/SIG-11781|https://comutitres.atlassian.net/browse/SIG-11781|smart-link]

[https://comutitres.atlassian.net/browse/SIG-12118|https://comutitres.atlassian.net/browse/SIG-12118|smart-link] → exigence 1
{panel}

h2. Exigences : 

||*Type*||*Exigences*||
|Technique|Créer le [BATCH-PASSE-610-SIS|https://comutitres.atlassian.net/wiki/spaces/DA/pages/2782560257/BATCH-PASSE-610-SIS+-+G+n+ration+du+fichier+liste+noire+SIS] dans le nouveau socle batch|
|Fonctionnel|Porter le traitement métier|
|Technique|Annuler la dette technique du [BATCH-PASSE-610-SIS|https://comutitres.atlassian.net/wiki/spaces/DA/pages/2782560257/BATCH-PASSE-610-SIS+-+G+n+ration+du+fichier+liste+noire+SIS]|
|Technique|Appliquer les exigences de l’US [https://comutitres.atlassian.net/browse/SIG-11906|https://comutitres.atlassian.net/browse/SIG-11906|smart-link]|
|Technique|Appliquer les exigences de l’US [https://comutitres.atlassian.net/browse/SIG-11907|https://comutitres.atlassian.net/browse/SIG-11907|smart-link]|
|Technique|Pour tous les batch du nouveau socle batch rendre obligatoire le suffixe (valeur du suffixe ne peut pas être nulle)|",0,2
"FP410 - Integration portail de mobilite ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Appairage d’un compte sans date de naissance*
{panel}|
|*ÉTANT DONNE QUE*               
Je suis un conseiller CRC|
|*QUAND*  
Je réalise l’appairage pour un client SIG sans date de naissance|
|*ALORS*  
L’appairage n’est pas autorisé et un message m’en informe.| {panel:bgColor=#e3fcef}
*Contexte :*

 Dans le cadre d’un appairage en SAV, le client n’ayant pas de date de naissance dans le SIG peut être appairé alors qu’n appairage classique ne le permet pas.
{panel}

{panel:bgColor=#deebff}
*Besoin :*

*En tant que conseiller CRC, je souhaite que la date de naissance du client soit un élément obligatoire afin de pouvoir appairer un client.*

L’objet de cette US consiste à bloquer l’appairage d’un client si celui-ci ne possède pas de date de naissance dans le SIG.

 
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

  N/A
{panel}

h2. *Exigences* : 

 

||Référence||Type||Exigences||
|7627_001|Fonctionnelle|L'appairage SAV d'un compte pour un client sans date de naissance n’est pas autorisé|
|7627_002|Fonctionnelle|Un message informatif détaillé est affiché au conseiller tentant de réaliser un tel appairage.|",0,1
"FP866 - Petits sujets techniques SIG 2023 S1 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Batch PPT-BATCH-FIN-730 terminé en succès*
{panel}|
|*ÉTANT DONNE QUE*
Le batch PP-FIN-730 s’est lancé et est terminé sans aucune erreur|
|*QUAND*
je cherche les logs associés à cette execution|
|*ALORS*
le fichier LogCR.txt affiche un texte de la forme : 
{noformat}{
    ""Compte-rendu"": {
        ""entete"": {
            ""ref-batch"": ""BATCH-FIN-730"",
            ""libelle-batch"": ""Contrôle intégration de mobilités consolidées"",
            ""param"": ""$1 $2"",
            ""date-heure-lancement"": ""jj/mm/aaaa HH:MM:SS"",
            ""numero-echange"": N,
            ""numero-lu"": N
        },
        ""resultat"": {
            ""taux-reussite"": 100,
            ""date-heure-fin"": ""jj/mm/aaaa HH:MM:SS"",
            ""nb-enreg-traites"": 1,
            ""nb-rejet"": 0,
            ""code-retour"": 2
        }
    }
}{noformat}|
|{panel:bgColor=#e3fcef}
*Scénario 2 : Batch PPT-BATCH-FIN-730 terminé en échec*
{panel}|
|*ÉTANT DONNE QUE*
Le batch PP-FIN-730 s’est lancé et est terminé avec une erreur|
|*QUAND*
je cherche les logs associés à cette execution|
|*ALORS*
le fichier LogCR.txt affiche un texte de la forme : 
{noformat}{
    ""Compte-rendu"": {
        ""entete"": {
            ""ref-batch"": ""BATCH-FIN-730"",
            ""libelle-batch"": ""Contrôle intégration de mobilités consolidées"",
            ""param"": ""$1 $2"",
            ""date-heure-lancement"": ""jj/mm/aaaa HH:MM:SS"",
            ""numero-echange"": N,
            ""numero-lu"": N
        },
        ""resultat"": {
            ""taux-reussite"": 0,
            ""date-heure-fin"": ""jj/mm/aaaa HH:MM:SS"",
            ""nb-enreg-traites"": 1,
            ""nb-rejet"": 1,
            ""code-retour"": 3
        }
    }
}{noformat}|
|{panel:bgColor=#e3fcef}
*Scénario 3 : Batch PPT-BATCH-FIN-730 n’a pas pu être lancé → TODO saboter les paramètres d’entrés, supprimer l’URL weblogic*
{panel}|
|*ÉTANT DONNE QUE*
Le batch PP-FIN-730 n’a pas pu être lancé|
|*QUAND*
je cherche les logs associés à cette execution|
|*ALORS*
le fichier LogCR.txt affiche un texte de la forme : 
{noformat}{
    ""Compte-rendu"": {
        ""entete"": {
            ""ref-batch"": ""BATCH-FIN-730"",
            ""libelle-batch"": ""Contrôle intégration de mobilités consolidées"",
            ""param"": ""$1 $2"",
            ""date-heure-lancement"": ""jj/mm/aaaa HH:MM:SS"",
            ""numero-echange"": N,
            ""numero-lu"": N
        },
        ""resultat"": {
            ""taux-reussite"": 100,
            ""date-heure-fin"": ""jj/mm/aaaa HH:MM:SS"",
            ""nb-enreg-traites"": 0,
            ""nb-rejet"": 0,
            ""code-retour"": 5
        }
    }
}{noformat}|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) : Execution du batch PPT-BATCH-FIN-730*
{panel}|
|*ÉTANT DONNE QUE*
Je souhaite executer le PPT-BATCH-FIN-730|
|*QUAND*
je lance le batch|
|*ALORS*
* L’execution se termine 
* le batch peut écrire des logs CR dans le répertoire prévu à cet effet| {panel:bgColor=#e3fcef}
*Contexte* : Les logs applicatifs des batchs comptent deux formats : .txt et .xml

Pour les besoins ESI, le format .json est plus intéressant que le format .xml. Ces logs ne sont lu que par des machines mais les contenus d’entete et de fin doivent être similaires aux logCR.txt. 

Pour commencer cette refonte du socle Batch, le batch PPT-BATCH-FIN-730 a été choisi comme premier jet de refonte, hors il ne génère pas de log.xml nous allons donc créer ce premier logCR.json pour l’occasion. 

h3. Structure du début


  ""Compte-rendu"": {
    ""entete"": {
      ""ref-batch"": ""*BATCH-XXX-NNN*"",
      ""libelle-batch"": ""*[description courte du batch]*"",
      ""param"": ""*$1 $2*"",
      ""date-heure-lancement"": ""*jj/mm/aaaa HH:MM:SS*"",
      ""numero-echange"": *N*,
      ""numero-lu"": *N*
    },

h3. Structure pour le cartouche de fin :


    ""resultat"": {
      ""taux-reussite"": *F*,
      ""date-heure-fin"": ""*jj/mm/aaaa HH:MM:SS*"",
      ""nb-enreg-traites"": *N*,
      ""nb-rejet"": *N*,
      ""code-retour"": ""*CODE RETOUR*""
    }
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

En tant qu’ingénieur de production de SIG, je veux que les cartouches d’entêtes et de fin de Log CR JSON soient harmonisés pour retrouver les mêmes informations sur les batch du nouveau socle afin de faciliter le suivi de la production.

En tant qu’ingénieur de production de SIG, je veux que les cartouches d’entêtes et de fin de Log CR JSON contiennent les informations nécessaire afin de pouvoir automatiser la remonté d’informations sur les traitements des batchs et améliorer le suivi de production
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Type*||*Exigences*||
|Fonctionnel|Le fichier de logCR.json doit avoir le format suivant : 
{noformat}{
    ""Compte-rendu"": {
        ""entete"": {
            ""ref-batch"": ""BATCH-XXX-NNN"",
            ""libelle-batch"": ""[description courte du batch]"",
            ""param"": ""$1 $2"",
            ""date-heure-lancement"": ""jj/mm/aaaa HH:MM:SS"",
            ""numero-echange"": N,
            ""numero-lu"": N
        },        
        ""resultat"": {
            ""taux-reussite"": F,
            ""date-heure-fin"": ""jj/mm/aaaa HH:MM:SS"",
            ""nb-element-a-traite"": A,
            ""nb-enreg-traites"": B,
            ""nb-rejet"": C+D,
            ""nb-warn"": E,
            ""code-retour"": ""CODE RETOUR""
        }
    }{noformat}|
|Technique|Produire un fichier log sous format JSON|
|Fonctionnel|Nommage du fichier de log selon les cas suivants : 
# Si traitement de fichier en entrée du batch, Alors : *CR_[Nom_Fichier_Entrée]_[Suffixe].json*
# Si pas de fichier en entrée, Alors : *CR_[Nom de log tel que défini dans la classe java]_[Suffixe OU timestamp selon paramétrage de la classe java].json*
# S’il existe un fichier en sortie (exemple : liste verte), Alors : *CR_[Nom_Fichier_Sortie]_[Suffixe].json*|
|Fonctionnel|{{""nb-element-a-traite""}} :  entièreté des éléments présents dans le traitement (cf LogCR.txt variable A : si 10 000 lignes à traiter en BDD, alors A = 10 000)|
|Fonctionnel|{{""nb-enreg-traites"" }}: Le nombre d'éléments sur lesquels mon programme est passé ( cf LogCR.txt variable B : éléments qui génèrent un OK, un KO fonctionnel ou un KO technique)|
|Fonctionnel|{{""nb-rejet""}} :  Elément non pris en compte dans le SIG ( cf LogCR.txt variable C et D : ==> intervention ESI ou Equipe ASSET à tout les coups)
par exemple si fichier entrant : données non intégrée
Un traitement pour lequel SIG ne sait pas ce qui s’est passé (intervention ESI) ou erreur fonctionnelle tracé dans le SIG (anayse Equipe ASSET)
Dans le cas du FIN-730, il s’agirait du non enregistrement de la ligne dans la table du journal d'échange.|
|Fonctionnel|{{""nb-warn""}} :  cf LogCR.txt variable E : warnings|
|{color:#ff5630}Fonctionnel{color}|{{""taux-reussite""}}{color:#ff5630} : Par défaut,{color}{color:#ff5630} *F*{color}{color:#ff5630} = ( [{color}{color:#ff5630}*B*{color}{color:#ff5630} - ({color}{color:#ff5630}*C+D)*{color}{color:#ff5630}] * 100 ) / {color}{color:#ff5630}*A*{color}{color:#ff5630} (c’est un pourcentage){color}
{color:#ff5630}Si {color}{color:#ff5630}*A*{color}{color:#ff5630} = 0 alors {color}{color:#ff5630}*F*{color}{color:#ff5630} = 100%{color}
{color:#ff5630}Si Statut non lancé ou erreur dans le lancement de batch alors {color}{color:#ff5630}*F*{color}{color:#ff5630} = 0%{color}|
|Fonctionnel|{{""code-retour""}} : valeur métrique à retourner 
!image-20230323-174559.png|width=83.33333333333334%!
Source du tableau ici : [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762531587/PPT-BATCH-FIN-501+-+Identification+des+pr+l+vements+Post-Paiement#Code-type-%C3%A9change|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762531587/PPT-BATCH-FIN-501+-+Identification+des+pr+l+vements+Post-Paiement#Code-type-%C3%A9change|smart-link]|
|Fonctionnel|Le fichier doit être toujours généré dans le même répertoire qu’avant (*#SortieCR =* */var/TWS/log/log_cr)*|
|Fonctionnel|Lors d’un problème dans un batch qui n’a pas pu être lancé (par exemple lorsqu’il y a une erreur au niveau des paramètres d’entrée du batch), Il faut tracer l’erreur dans le logScript (appelé aussi Log Shell)|",0,1
"FP1085 - Petits sujets techniques SIG S1 2024 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : Dans le cadre de la modernisation SIG, nous procédons à la refonte du socle batch. Ce batch [AMET-BATCH-CON-100|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762530008/AMET-BATCH-CON-100+-+Traitement+du+fichier+de+demande+de+r+siliation+Am+thyste] permet de traiter le fichier de demande de résiliation en provenance des Conseils Départementaux (fichier n°8) et est exécuté à chaque réception de fichier.

Il effectue 2 traitements suivant la demande :

* il évalue la possibilité de résiliation d'un contrat commercial Améthyste pour chaque client présent dans le fichier et si la résiliation est possible, elle est réalisée.
* il évalue la possibilité de passer le client à l'état « décédé ».

Ce traitement produit systématiquement un fichier de compte-rendu particulier transmis en retour au CD émetteur. Ce fichier est produit dans le répertoire spécifié par la variable *SortieBatch* défini dans le fichier d'initialisation fourni au démarrage du serveur (sig.ini).
{panel}

{panel:bgColor=#deebff}
*Besoin* : Créer le batch [AMET-BATCH-CON-100|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762530008/AMET-BATCH-CON-100+-+Traitement+du+fichier+de+demande+de+r+siliation+Am+thyste] dans le nouveau socle batch
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : [https://comutitres.atlassian.net/browse/SIG-11781|https://comutitres.atlassian.net/browse/SIG-11781|smart-link]

[https://comutitres.atlassian.net/browse/SIG-12118|https://comutitres.atlassian.net/browse/SIG-12118|smart-link] → exigence 1
{panel}

h2. Exigences : 

||*Type*||*Exigences*||
|Technique|Créer le [AMET-BATCH-CON-100|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762530008/AMET-BATCH-CON-100+-+Traitement+du+fichier+de+demande+de+r+siliation+Am+thyste] dans le nouveau socle batch|
|Fonctionnel|Porter le traitement métier|
|Technique|Annuler la dette technique du [AMET-BATCH-CON-100|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762530008/AMET-BATCH-CON-100+-+Traitement+du+fichier+de+demande+de+r+siliation+Am+thyste]|
|Technique|Appliquer les exigences de l’US [https://comutitres.atlassian.net/browse/SIG-11906|https://comutitres.atlassian.net/browse/SIG-11906|smart-link]|
|Technique|Appliquer les exigences de l’US [https://comutitres.atlassian.net/browse/SIG-11907|https://comutitres.atlassian.net/browse/SIG-11907|smart-link]|
|Technique|Pour tous les batch du nouveau socle batch rendre obligatoire le suffixe (valeur du suffixe ne peut pas être nulle)|",0,1
nan,0,1
nan,0,2
nan,0,2
"FP1085 - Petits sujets techniques SIG S1 2024 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : 
{panel}

{panel:bgColor=#deebff}
*Besoin* : Remplacement des EJB Module Contrat 7
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Type*||*Exigences*||
|Technique|Remplacement des EJB Module Contrat 7|",0,2
"FP486 - 2021 SIG - backlog petits sujets orphelins   {panel:bgColor=#e3fcef}
*Contexte :*

Actuellement, chaque équipe (RBB, TRA, CDA) dispose de ses fichiers d'entrée pour les différents batchs. Aucune mutualisation n'est faite. Le partage des fichiers entre les équipes permettrait de faciliter la recette.
{panel}
{panel:bgColor=#deebff}
*Besoin :*

Créer un répertoire BATCH dans Confluence et déposer les exemples de fichiers entrants des batchs dont dispose chaque équipe. De plus, il faudrait préciser le répertoire dans lequel il faut déposer:
 * le fichier d'entrée (pour TRA et RBB)
 * la commande à lancer dans le fichier sh
 * la commande à lancer dans la console bash (pour TRA et RBB).{panel}
{panel:bgColor=#ffcfc1}
*Prérequis :*

  Avoir recensé l'ensemble des fichiers d'entrée dont dispose chaque équipe
{panel}
 ",0,1
"FP875 - Sujet metier SIG 2023 S2 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*ÉTANT DONNE QUE*                                              |
|*QUAND*  |
|*ALORS*  |
|{panel:bgColor=#e3fcef}
*Scénario 2 :*{panel}|
|*ÉTANT DONNE QUE*  |
|*QUAND*  |
|*ALORS*  |
|{panel:bgColor=#ddeeff}
*Scénario 3 (NR) :*{panel}|
|*ÉTANT DONNE QUE*  |
|*QUAND*  |
|*ALORS*  |
|{panel:bgColor=#ddeeff}
*Scénario 4 (NR) :*{panel}|
|*ÉTANT DONNE QUE*  |
|*QUAND*  |
|*ALORS*  | {panel:bgColor=#e3fcef}
*Contexte :*

 La spécification du Modèle Physique de Données du SIG n’existe qu’au format Word et n’a pas évolué depuis la 21.7.
{panel}

{panel:bgColor=#deebff}
*Besoin :*

 *En tant que PO du SIG, je veux pouvoir consulter le MPD sous Confluence afin que toutes les spécifications du SIG soient regroupées.*
{panel}

{panel:bgColor=#ffebe6}
*Prérequis : N/A*
{panel}

h2. *Exigences* :

 

||*Référence*||*Type*||*Exigences*||
|7307_001|Documentaire|Migrer la spécification de Word à Confluence (dernière version connue : 21.7)|
|7307_001|Documentaire|Mettre à jour la spécification avec les évolutions depuis la version SIG 21.7|",0,1
"FP875 - Sujet metier SIG 2023 S2 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 3 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 4 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : Un audit a été réalisé sur l’IHMC concernant le respect des règlementations d’accessibilité RGAA et les conclusions de cet audit ont mis en évidence plusieurs axes d’amélioration pour faire progresser la note d’accessibilité du site.

L’une des évolutions recommandées concerne le contrôle de saisie dans les formulaire au niveau des pages web. En effet même si le caractère obligatoire est globalement respecté, les autres exigences complémentaires telles que la complexité du mot de passe, l’indication des formats attendus, du format textuel et des champs invalides, ne le sont pas.


{panel}

!image-20230912-145554.png|width=903,height=201!

{panel:bgColor=#deebff}
*Besoin* : En tant qu’utilisateur de l’IHMC, je souhaite que soit réalisée une étude pour identifier au niveau des pages web les champs de saisie pour lesquelles les exigences complémentaires sur le contrôle de saisie au niveau de chaque formulaire de saisie ne sont pas utilisés de manière pertinente, afin de planifier l'évolution adéquate à mettre en place pour améliorer la note RGAA du site.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|12952_001|Fonctionnelle|Recenser les champs de saisie au niveau des formulaires|
|12952_002|Fonctionnelle|Pour chaque champ de saisie, vérifier si le caractère obligatoire est respecté|
|12952_003|Fonctionnelle|Pour chaque champ de saisie, vérifier la complexité du password est bien indiqué|
|12952_004|Fonctionnelle|Pour chaque champ de saisie, vérifier si les formats attendus sont bien identifiés|
|12952_005|Fonctionnelle|Proposer un macrochiffrage pour l'évolution à mettre en place|",0,1
nan,0,2
nan,0,1
"FP688 - Interfaces fraude palier 3.1 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE* 
Je suis l’exploitant 
Je reçois un fichier liste d’invalidation de la part du SIS (le code émetteur dans le fichier est 07000)|
|*QUAND* 
Je lance le batch de liste d’invalidation SIS avec le code partenaire 1432|
|*ALORS* 
Les données sont correctement mises à jour dans le SIG.
*ET* un fichier d'acquittement est généré avec un résultat OK (de ce format)
!image-20221004-125508.png|width=518,height=188!
au niveau du répertoire $OUT
et avec un nom = au nom du fichier d’entrée mais avec l’extension .acq|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE* 
Je suis l’exploitant 
Je reçois : 
* un fichier liste d’invalidation de la part de SIS (le code émetteur dans le fichier est 07000)
* un fichier liste d’invalidation de la part des 3T avec les mêmes données que le fichier SIS|
|*QUAND* 
* Je lance le batch de liste d’invalidations 3T avec le fichier d’invalidation 3T.
* Je lance le batch de liste d’invalidations SIS avec le fichier d’invalidation SIS.|
|*ALORS* 
Le batch se lance correctement 
Les données sont mise à jour dans le SIG la première fois avec le batch de liste d’invalidations 3T.
Lors de la 2ème exécution avec le batch SIS, les données SIG ne sont pas modifiées, mais le batch SIS s’exécute correctement, sans erreur applicative.|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE* 
Je suis l’exploitant 
Je reçois un fichier liste de rechargement de la part des 3T (le code émetteur dans le fichier est différent de 07000)|
|*QUAND* 
Je lance le batch de liste d’invalidations 3T BATCH-PASSE-620, avec le code partenaire ad hoc (différent de 1432)|
|*ALORS* 
Le batch se lance correctement 
Les données sont correctement mise à jour dans le SIG.| {panel:bgColor=#e3fcef}
*Contexte* : 

Dans le cadre de la mise en œuvre du SIS, nous avons besoin que le SIG puisse intégrer un nouveau flux de *liste d’invalidations* en provenance du SIS.

Cette liste d’invalidations sera similaire à celle actuellement transmise par les 3T (cf. [https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762531320|https://comutitres.atlassian.net/wiki/spaces/DA/pages/1762531320|smart-link]) , à quelques différences près au niveau des données qui composent ce fichier.

A terme les flux historiques de listes d’invalidations diffusées depuis les 3T => SIG seront décommissionnés et remplacés par ce nouveau flux unique : 3T => SIS => SIG.  

Aussi, suite à l’intégration de cette liste d’invalidations par le SIG, un fichier d’acquittement devra être généré par le SIG et transmis au SIS. 

A noter que le traitement actuel est le BATCH-PASSE-620.  
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

En tant qu’exploitant du SIG, je souhaite disposer d’un nouveau batch afin de pouvoir intégrer les listes d’invalidations envoyées par le SIS.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 

N/A
{panel}

h2. Exigences : 

||Type||Exigences||
|Fonctionnel|Le SIG doit proposer un nouveau batch similaire au BATCH-PASSE-620 permettant d’intégrer une liste d’invalidations en provenance du partenaire SIS (code partenaire SIS = 1432).|
|Fonctionnel|Le format de la liste d’invalidations SIS doit être identique à celui actuel des 3T, à l’exception des exigences qui suivent.|
|Fonctionnel|Le champ “Nombre d’enregistrements” en entête de fichier d’invalidations doit être défini sur une taille de 7 caractères.|
|Fonctionnel|Le champ “RUF” de la ligne d’entête doit être défini sur une taille de 41 caractères.|
|Fonctionnel|Le traitement SIG doit permettre l’intégration de la liste d’invalidations avec un code émetteur SIS = 07000.|
|Fonctionnel|Le champ “code action” dans les lignes de détail, pourra prendre la valeur “04” (= Usurpation d’identité).|
|Fonctionnel|En cas de valeur 04 pour ce champs code action, la ligne en question devra être ignorée par le SIG. Aucune erreur ne devra être remontée.|
|Fonctionnel|Le champ “Zones” dans les lignes de détail, sera valorisé avec 2 espaces pour les produits non zonaux (i.e. Navigo Liberté +).|
|Fonctionnel|Le batch de liste d’invalidations SIS ne doit pas enregistrer les invalidations en double dans le cas où cette information aurait déjà été intégrée via le batch de liste d’invalidations 3T.|
|Fonctionnel|Le nouveau batch ne doit pas générer de nouvelles erreurs dans le CR même si on le lance plusieurs fois pour un même fichier
NB : Cette exigence pourra s’appliquer également à l’ancien batch si besoin selon la solution.|
|Fonctionnel|Suite à l’intégration par le SIG de la liste d’invalidation en provenance du SIS, le SIG doit générer un fichier d’acquittement équivalent à ce qui a été produit pour la liste de rechargement : [https://comutitres.atlassian.net/browse/SIG-8623|https://comutitres.atlassian.net/browse/SIG-8623|smart-link]|
|Fonctionnel|Le nom du fichier d’acquittement doit correspondre au nom du fichier de liste d’invalidations donné en entrée, mais avec l’extension *.acq*. 
Exemple : *TT_XXYYY_AAAAMMJJHHMMSS_NNN.acq*|
|Fonctionnel|le fichier d’acquittement doit comporter les informations suivantes:
* Result ( soit OK, KO ou WARN)
* DateTRT
* NBEnrgRecus
* NBEnrgSansErr
* ErreurFichier|
|Fonctionnel|Le nouveau batch de liste d'invalidations SIS doit contrôler que le fichier donné en entrée respecte ce format *04_07000_**_AAAAMMJJHHMMSS_**_**_NNN_**.dat*
Avec :  
* *AAAAMMJJHHMMSS* : Désigne la date de transmission du fichier d’échange
* *NNN :* Désigne le numéro de séquence 
Et renvoyer un code erreur “Fon001” dans le fichier d’acquittement si ce format n’est pas respecté|
|Fonctionnel|Les codes d’erreurs sont les suivants:
* Fon001: lors de mauvais nommage d’un fichier 
* Fon002 : quand le fichier est illisible
* Fon003 : quand le fichier est non conforme à la structure globale définie 
* Fon004 : quand la valeur d’un champ de l’en-tête est non conforme au type, format ou jeu de valeurs attendues
* {color:#ff5630}-Fon010 : quand le fichier reçu est doublon (il a déjà été importé)-{color}|
|Fonctionnel|Le numéro de séquence dans le nom de fichier (*NNN*) doit être identique a celui inscrit dans l’entête de fichier.|
|Fonctionnel|Le batch ne doit pas pouvoir s'exécuter sur un fichier *X.dat* s'il existe déjà un fichier d’acquittement avec le même nom du fichier *X.acq* dans le répertoire de sortie *$OUT*.|
|Fonctionnel|Le fichier d'acquittement doit être généré dans le répertoire défini par la variable *$OUT* du fichier.ini|",0,2
nan,0,2
"FP425 - Archivage ESI ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
Les tables *A_CLT_REF_PROFIL* , *E_CON_MOBILITES* et *A_CON_AFFECTATION_CONTR_PROFIL* contiennent des données à l'état actif, mais qui sont rattachées a des groupes fonctionnels archivées, supprimées logiquement -ou supprimées physiquement-.|
|*QUAND*
Je lance le script de rattrapage|
|*ALORS*
Les données des ces 3 tables sont au même statut que les données des clients ou contrat auxquels elles sont rattachées.| {panel:bgColor=#e3fcef}
*Contexte* : 

Les tables ci-dessous ont une colonne “ARCHIVE_FLAG” mais elles ne sont pas référencées dans l’arbre d’archivage : E_REF_ARC_ARBRE, et ne peuvent donc pas être traitées :

* A_CLT_REF_PROFIL
* E_CON_MOBILITES
* A_CON_AFFECTATION_CONTR_PROFIL

Une première US a été demandé afin d’inclure ces 3 tables dans les traitement d’archivage : [https://comutitres.atlassian.net/browse/SIG-12034|https://comutitres.atlassian.net/browse/SIG-12034|smart-link] 

Ce ticket vise lui à effectuer le rattrapage de données sur ces 3 tables.
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

En tant qu’exploitant du SIG, je veux un script pour rattraper les données des 3 tables A_CLT_REF_PROFIL, E_CON_MOBILITES et A_CON_AFFECTATION_CONTR_PROFIL afin que les données de ces 3 table soient cohérentes par rapport aux données des clients et contrats dans le SIG.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 

N/A
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|001|Fonctionnel|Je veux un script permettant de rattraper les données de la table “*A_CLT_REF_PROFIL*” en modifiant la colonne archive_flag avec la même valeur (1 ou 2) que la valeur de la colonne archive_flag du client correspondant.|
|002|Fonctionnel|Je veux un script permettant de rattraper les données de la table “*E_CON_MOBILITES*“ en modifiant la colonne archive_flag avec la même valeur (1 ou 2) que la valeur de la colonne archive_flag du contrat correspondant.|
|003|Fonctionnel|Je veux un script permettant de rattraper les données de la table “*A_CON_AFFECTATION_CONTR_PROFIL*“ en modifiant la colonne archive_flag avec la même valeur (1 ou 2) que la valeur de la colonne archive_flag du contrat correspondant.|",0,1
nan,0,2
"FP733 - Filiale - Recouvrement ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
je suis payeur d’un contrat NL+ résilié gestionnaire avec une dette|
|*QUAND*
cela fait 335 jours que mon contrat a été résilié|
|*ALORS*
je reçois un courriel pour m’avertir que mon contrat va passer en recouvrement dans 30 jours|
|{panel:bgColor=#deebff}
*Scénario 2 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
je suis payeur d’un contrat NL+ résilié gestionnaire sans dette|
|*QUAND*
cela fait 335 jours que mon contrat a été résilié|
|*ALORS*
je ne reçois ni courriel ni courrier postal|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
je suis payeur d’un contrat NL+ résilié gestionnaire avec dette|
|*QUAND*
cela fait 336 jours ou plus que mon contrat a été résilié|
|*ALORS*
je ne reçois ni courriel ni courrier postal|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
je suis payeur d’un contrat NL+ résilié gestionnaire avec dette|
|*QUAND*
cela fait 334 jours ou moins que mon contrat a été résilié|
|*ALORS*
je ne reçois ni courriel ni courrier postal| {panel:bgColor=#e3fcef}
*Contexte* : 

Dans le cadre de la mise en place de la filiale, qui a pour vocation à reprendre la gestion de l’ensemble des services billettiques franciliens, il a été décidé de mettre en place le processus de « Recouvrement Forcé ». Il s’agit d’un nouvel état du contrat commercial qui intervient après l’état « Résilié gestionnaire » et sera mis en place au mois juin 2023.  

 Le passage en « Recouvrement Forcé » suit le passage d’un contrat en « Résilié Gestionnaire » en cas de la persistance de la dette due par le Payeur du contrat.
{panel}

{panel:bgColor=#deebff}
*Besoin* : 

Envoyer un courriel au client payeur, 30 jours avant le passage en recouvrement forcé
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|Ref 1|Fonctionnelle|Envoyer un courriel à un client payeur d’un contrat NL+ résilié gestionnaire avec une dette (identification des contrats identique au batch de recouvrement) depuis 335 jours|",0,2
"FP458 - Ameliorations parcours existant suspension SE ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client porteur / payeur d'un contrat NA qui est suspendu depuis 11 mois.|
|*QUAND*
N/A|
|*ALORS*
Je reçois un mail correspondant au template RESPOSTSUSP1, pour m’avertir que celui-ci sera bientôt résilié.|
|{panel:bgColor=#deebff}
*Scénario 2 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un client porteur / payeur d'un contrat NA, qui est suspendu depuis 10 mois|
|*QUAND*
Je fais une reprise de mon contrat|
|*ALORS*
Je ne reçois aucun mail, même après 11 mois.| {panel:bgColor=#e3fcef}
*Contexte :*

Un client Navigo Annuel, qui a été suspendu, est automatiquement résilié au bout de 12 mois si le client ne fait pas de reprise de son contrat. En dehors des CGVU, le client n’est pas averti de cette résiliation automatique de son contrat NA.   
{panel}

{panel:bgColor=#deebff}
*Besoin :*

Envoyer un email de rappel aux clients ayant un contrat NA suspendu depuis bientôt 12 mois pour les prévenir que celui-ci sera résilié bientôt en cas de non reprise. 
{panel}

{panel:bgColor=#ffebe6}
*Prérequis :*

Le template du courriel à envoyer.
{panel}

h2. Exigences :

||Référence||Type||Exigences||
|001|Fonctionnelle|Le SIG doit envoyer automatiquement un email aux clients respectant les conditions suivantes : 
* ayant un contrat NA suspendu depuis au moins 11 mois 
* et dont le payeur du contrat à une adresse mail 
* et n’ayant pas encore reçu ce mail depuis la dernière suspension|
|002|Fonctionnelle|Celui-ci doit correspondre au template “RESPOSTSUSP1”.|
|003|Fonctionnelle|Cet email doit être envoyé au client payeur du contrat.|",0,2
"FP393 - Amélioration de l’IHMC SIG ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un utilisateur de L’IHMC|
|*QUAND*
J’ouvre l'écran événement|
|*ALORS*
Le scroller s’affiche uniquement si le nombre d'évènement atteint la taille de l'écran.|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un utilisateur de L’IHMC|
|*QUAND*
J’ouvre l'écran événement|
|*ALORS*
la pagination est activée seulement si on atteint un nombre important d'événement.|
|{panel:bgColor=#e3fcef}
*Scénario 3  :*
{panel}|
|*ÉTANT DONNE QUE*
Je suis un utilisateur de l’IHMC|
|*QUAND* 
J’ouvre l'écran événement|
|*ALORS*
La fenêtre  de l'écran événement a augmentée de taille| {panel:bgColor=#e3fcef}
*Contexte :*

L’objectif de cette US est : 

# Augmenter la taille de la fenêtre en utilisant la même taille que celle de l'écran document. 
# Augmenter le nombre des événements par page et d’ajouter un ascenseur vertical.
# Activer la pagination seulement si on atteint un nombre important d'événement.
{panel}

{panel:bgColor=#deebff}
*Besoin :*

En tant qu’utilisateur de l’IHMC

Je souhaite que l'écran événement soit affiché avec un ascenseur vertical et que la pagination  soit activée pour un nombre important d'événement .

Afin d’améliorer la visualisation des événements.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis : N/A*
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|001|fonctionnelle|Augmenter la taille de l'écran événement|
|002|fonctionnelle|Ajouter un ascenseur vertical   qui sera affiché si le nombre des événements affichés atteint la taille de la page|
|003|fonctionnelle|Activer la pagination seulement si on atteint un nombre important d'événement.|",0,1
nan,0,1
"FP865 - Petits sujets NL+ 2023 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 : test à faire sur tous les postes des 3T*
{panel}|
|*ÉTANT DONNE QUE* j’ai suspendu un contrat de transport NL+|
|*QUAND* je lis le passe et consulte les droits|
|*ALORS* les droits sont suspendus, le contrat suspendu n’est pas dupliqué| {panel:bgColor=#e3fcef}
*Contexte* : La SNCF nous remonte que plusieurs clients NL+ avec un contrat de transport suspendu continuent à circuler  avec leur forfait NL+
{panel}

{panel:bgColor=#deebff}
*Besoin* : le droit NL+ doit être à l'état suspendu 
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Type*||*Exigences*||
|Technique|Suspendre le droit NL+ lors d’une suspension du contrat de transport avec le forfait NL+|",0,1
nan,0,2
nan,0,2
"FP724 - SIS interface DIS_A_05/DIS_A_06 ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 : Intégration de liste de rechargement issu de SIS avec Résultat OK*
{panel}|
|*ÉTANT DONNE QUE*
 Je suis l’exploitation 
J’ai reçu un fichier de liste de rechargement en provenance de SIS (avec le nom *TT_XXYYY_AAAAMMJJHHMMSS_NNN.dat*)
Que ce fichier est bien formaté avec des données correctes|
|*QUAND* Je lance le BATCH-PASSE-640-V2|
|*ALORS* Le fichier est intégré dans le système
*ET* Un acquittement est généré avec un résultat *OK* (de ce format)
!image-20220404-085536.png|width=50%!
Avec le nom du fichier (*TT_XXYYY_AAAAMMJJHHMMSS_NNN.acq*)|
|{panel:bgColor=#e3fcef}
*Scénario 2 :  Intégration de liste de rechargement issu de SIS en échec* 
{panel}|
|*ÉTANT DONNE QUE* Je suis l’exploitation 
J’ai reçu un fichier de liste de rechargement en provenance de SIS
*ET* que ce dernier ne respecte pas le nommage attendue (exemple : *21_07000_TOTO.dat)*|
|*QUAND* Je lance le BATCH-PASSE-640-V2|
|*ALORS* Le fichier est rejeté par le système
*ET* Un acquittement *21_07000_TOTO.acq* est généré avec un résultat *KO*
!image-20220404-085725.png|width=599,height=347!|
|{panel:bgColor=#e3fcef}
*Scénario 3 : Intégration de liste de rechargement issu de SIS en Warning*
{panel}|
|*ÉTANT DONNE QUE* Je suis l’exploitation
J’ai reçu un fichier de liste de rechargement en provenance de SIS
Que ce fichier est bien formaté mais contient des erreurs sur N enregistrements|
|*QUAND*  Je lance le BATCH-PASSE-640-V2|
|*ALORS* les lignes sans erreurs sont traités et les autres sont rejetés par le système
*ET* Un acquittement est généré avec un résultat *WARN*
!image-20220404-092453.png|width=671,height=293!| {panel:bgColor=#e3fcef}
*Contexte :*  Même contexte de l’US [https://comutitres.atlassian.net/browse/SIG-8613|https://comutitres.atlassian.net/browse/SIG-8613|smart-link] 
{panel}

{panel:bgColor=#deebff}
*Besoin* :

En tant que SIS, je souhaite recevoir un acquittement attestant soit : 

* Le rejet du fichier (*KO*)
* Le traitement de fichier sans erreur (*OK*)
* Le traitement de fichier avec erreur (*WARN*)

afin de pouvoir m'assurer que le flux fonctionne bien quand c’est *OK*, et pouvoir faire les actions nécessaires quand c’est *KO* ou *WARN*
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||Référence||Type||Exigences||
|Ref 1|Fonctionnel|Le nom du fichier d’acquittement doit correspondre au nom du fichier de rechargement donné en entrée, mais avec l’extension *.acq*. 
Exemple : *TT_XXYYY_AAAAMMJJHHMMSS_NNN.acq*|
|Ref 2|Fonctionnel|le fichier d’acquittement doit comporter les informations suivantes:
* Result ( soit OK, KO ou WARN)
* DateTRT
* NBEnrgRecus
* NBEnrgSansErr
* ErreurFichier|
|Ref 3|Fonctionnel|Le nouveau batch doit contrôler que le fichier de liste de rechargement donné en entrée respecte ce format *21_07000_**_AAAAMMJJHHMMSS_**_**_NNN_**.dat*
Avec :  
* *AAAAMMJJHHMMSS* : Désigne  la  date  de transmission du fichier d’échange
*  *NNN :* Désigne le numéro de séquence 
Et renvoyer un code erreur Fon001 dans le fichier d’acquittement si ce format n’est pas respecté|
|Ref 4|Fonctionnel|les codes d’erreurs sont les suivants:
* Fon001: lors de mauvais nommage d’un fichier 
* Fon002 : quand le fichier est illisible
* Fon004 : quand la valeur d’un champ de l’en-tête est non conforme au type, format ou jeu de valeurs attendues|
|Ref 5|Fonctionnel|Numéro de séquence dans le nom de fichier de liste de rechargement *NNN* doit être identique a celui inscrit dans l’entête de fichier|
|Ref 6|Fonctionnel|Le batch ne doit pas pouvoir s'exécuter sur un fichier *X.dat* si il existe un fichier d’acquittement avec le même nom du fichier *X.acq*|
|Ref 7|Fonctionnel|Le fichier d'acquittement doit être généré dans le répertoire défini par la variable *$OUT* du fichier.ini|

*Pour plus d’informations merci de voir le document ci-joint.* ",0,1
"FE1132 - Modification Passes Découverte ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 3 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#ddeeff}
*Scénario 4 (NR) :*{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : IdFM souhaite revoir le design du Navigo Découverte actuel afin d’en simplifier sa gestion logistique (Passe composé d'éléments multiples). Aujourd’hui, le passe Navigo Découverte est composé d' :

* un Passe non personnalisé ;
* une carte cartonnée à personnaliser par le titulaire (photo, nom, prénom) personnel et non cessible ;
* D’un étui plastique permettant de garantir l’association de la carte Navigo Découverte et de la carte cartonnée.

+*ATTENDU IDFM*+

* Utilisation d’un *passe de la gamme existante* ;
** De ne *plus fournir d’étui* ;
** La *personnalisation physique du passe* afin de le rendre nominatif (i.e. avec nom, prénom, photo) ;
** En cas de contrôle de *vérifier que l’identité du porteur correspond bien aux informations* présentes visuellement sur la carte ;
** De s’assurer que les *informations personnelles indiquées sur la carte ne puissent pas être modifiées* (carte non-cessible) ;
** Le *chargement de titres nominatifs* (Navigo Mois, Navigo Semaine, Paris Visite) ;
** De *rester anonyme dans la base de données* d’Ile-de-France Mobilités et des opérateurs de transport (support « déclaratif ») ;
** Le *chargement via tous les canaux disponibles* (automates, canal mobile, guichets…) ;
** Que *l’usage des titres ne soit pas modifié.*

Il a été décidé d’utiliser un passe NMS avec l’ajout de la mention “Découverte” lors de l’impression du passe en agence au lieu du numéro client pour les passe découvertes 
{panel}

{panel:bgColor=#deebff}
*Besoin* :Créer une page supplémentaire dans le SIG, afin de permettre aux agents en guichet de paramétrer l’impression d’un passe découverte directement depuis l’IHM du SIG.

La solution ne doit pas permettre l'enregistrement d'informations personnelles de clients dans les systèmes de Comutitres.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|01|Type 1|Créer une page sur le SIG afin de permettre l’impression du passe découverte avec comme informations ( nom, prénom, Découverte à la place du numéro client)|
|02|Type 2|Purger les données renseigner dans le SIG après validation d'impression|
|03| |Enregistrer le numéro du Passe en bdd|
|04| |Mettre le type de personnalisation (HolderDataCardStatus) à 1H|
|05| |Fournir un macro chiffrage de la solution|",0,1
"FP929 - Modification des frais de remplacement de passe ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE*|
|*QUAND*|
|*ALORS*| {panel:bgColor=#e3fcef}
*Contexte* : Dans le cadre de la modification des montants de frais de remplacement de passe pour le produit IR, nous souhaitons connaître les impacts de ce changement de frais avec une date d’application retro-active (ex: 01/06/2022 à confirmer) pour une date en production le 01/06/2023.

Ce choix de date est du au fait qu’actuellement, le tarif est appliqué selon la date de souscription du client et comme nous souhaitons que ce tarif s’applique pour tous les clients ( comprenant les client C22 et C23)
{panel}

{panel:bgColor=#deebff}
*Besoin* : Faire une étude permettant de confirmer que ce fonctionnement est possible, et d’identifier tous les impacts associés (assets, financiers, reporting…).
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : imagine R
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|01|étude|Avoir une étude pour nous expliquer les impacts de la modification des frais de remplacement de passe avec une date d’application rétro active.|",0,1
"FP750 - Hausse tarifaire ||Cas d'utilisation||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE*
je suis l’exploitant du SIG et que je reçois un fichier de traçage d’envoi d’email|
|*QUAND*
j’importe ce fichier via le traitement|
|*ALORS*
les contrats identifiés dans le fichier ont un nouvel événement journalisé correspondant à la confirmation de l’envoi du contact sortant| {panel:bgColor=#e3fcef}
*Contexte* : Dans le cadre d’une Hausse Tarifaire, une communication est envoyée aux clients pour les avertir du changement de tarif de leur abonnement. Cette communication n’est pas gérée directement depuis le SIG.

Les informations de contacts et le mode de contact sont extraits depuis le SIG par des scripts SQL.

Un prestataire gère alors l’envoi de la communication
{panel}

{panel:bgColor=#deebff}
*Besoin* : Pouvoir tracer les envois effectifs confirmés par le prestataire sur les contrats commerciaux
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

{panel:bgColor=#eae6ff}
Actuellement, lorsque nous avons besoin de journaliser des événements en masse (dans le cas d’une reprise de données en production suite à un incident), il nous faut constituer un fichier csv, le transformer pour qu’il présente le format attendu (CF [https://comutitres.atlassian.net/browse/SIG-1770|https://comutitres.atlassian.net/browse/SIG-1770|smart-link]) puis l’importer en base via le BATCH-EVT-510.

La constitution du fichier en entrée est fastidieuse et limite l’import de données à 10000 lignes à la fois. De plus nous souhaitons réduire la possibilité d’erreur de traitement manuel en réduisant au maximum les actions humaines
{panel}



h2. Exigences : 

||Référence||Type||Exigences||
|Ref 1|Fonc|Deux événements sont à créer (objet Contrat, produit NA) :  
* Contact sortant revalorisation tarifaire par email confirmée
* Contact sortant revalorisation tarifaire par sms confirmée|
|Ref 2|Tech|Le traitement doit prendre en entrée un fichier dont le format est à définir|
|Ref 3|Fonc|Dans les données en entrée du traitement, il faut préciser le type d’objet (client, contrat, passe, contrat cadre)|
|Ref 4|Fonc|Dans les données en entrée du traitement, il faut préciser le code de l'événement à journaliser|
|Ref 5|Fonc|Dans les données en entrée du traitement il faut préciser le code produit (0 en cas d’objet de type Client)|
|Ref 6|Fonc|On peut ajouter un commentaire manuel paramétrable (identique pour tous les contrats d’un même fichier)|
|Ref 7|Fonc|L'événement est journalisé sur tous les objets dont les références sont présentes dans le fichier|
|Ref 8|Fonc|Une log fonctionnelle indique le résultat du traitement : 
* Nombre de lignes présentes/Nombre de ligne traitées Ok/Nombre de lignes Ko
* Erreurs sur les problématiques liées aux références d’objet/type d’objet/produit
* Erreurs sur les références non trouvées
* Code événement inconnu
* …|

{panel:bgColor=#fffae6}
Le format du fichier d’entrée est à préciser (TXT, CSV, autre) ainsi que les données présentes. A noter que le prestataire dispose des informations suivantes fournies lors de l’extraction des clients à contacter : 

* REF_CONTRAT
* DATE_DE_DEBUT_DE_VALIDITE
* DATE_DE_FIN_DE_VALIDITE
* ETAT_CONTRAT
* REF_PORTEUR
* CIVILITE_PORTEUR
* NOM_PORTEUR
* PRENOM_PORTEUR
* MAIL_PORTEUR
* PORTABLE_PORTEUR
* TEL_DOMICILE_PORTEUR
* REF_PAYEUR
* CIVILITE_PAYEUR
* NOM_PAYEUR
* PRENOM_PAYEUR
* MAIL_PAYEUR
* PORTABLE_PAYEUR
* TEL_DOMICILE_PAYEUR
* EVENEMENT
* DATE_EVENEMENT
* ZVA1 (date de changement de tarif du contrat)
* ZVA2 (zone de départ)
* ZVA3 (zone d’arrivée)
* ZVA4 (tarif avant)
* ZVA5 (tarif après)
* ZVA6 (date de début de validité du contrat commercial)
* TEST_MAIL_1
* VALID_EMAIL
* TEST_MOBILE
* CANAL
* CODE_ACTION
* ID_EVENEMENT_ENREGISTRE


{panel}

{panel:bgColor=#deebff}
Le fonctionnement demandé correspond au fonctionnement du BATCH-EVT-510 à la différence près qu’on veut pouvoir importer de grosses volumétries et que le code de l'événement est paramétrable 

Le fichier en entrée doit être plus simple à construire 
{panel}",0,1
nan,0,2
nan,0,1
nan,0,1
"FP875 - Sujet metier SIG 2023 S2 ||*Cas d'utilisation*||
|{panel:bgColor=#e3fcef}
*Scénario 1 :*
{panel}|
|*ÉTANT DONNE QUE* je suis un utilisateur de l’IHMC,|
|*QUAND* je suis sur la page *IHMC-CON-200 - Demander changement de zones* ,|
|*ALORS* chaque champ de formulaire doit avoir une étiquette et être rattaché au bon bloc|
|{panel:bgColor=#e3fcef}
*Scénario 2 :*
{panel}|
|*ÉTANT DONNE QUE*  je suis un utilisateur de l’IHMC,|
|*QUAND* je suis sur la page *IHMC-CON-280 - Affecter un contrat tiers payant*|
|*ALORS* chaque champ de formulaire doit avoir une étiquette et être rattaché au bon bloc|
|{panel:bgColor=#deebff}
*Scénario 3 (NR) :*
{panel}|
|*ÉTANT DONNE QUE* je suis un utilisateur de l’IHMC,|
|*QUAND* je suis sur la page *IHMC-CON-020 - Consulter un contrat commercial*|
|*ALORS* chaque champ de formulaire doit avoir une étiquette et être rattaché au bon bloc|
|{panel:bgColor=#deebff}
*Scénario 4 (NR) :*
{panel}|
|*ÉTANT DONNE QUE* je suis un utilisateur de l’IHMC,|
|*QUAND* je suis sur la page *IHMC-CON-250 - Demander la suspension d'un contrat commercial*|
|*ALORS* chaque champ de formulaire doit avoir une étiquette et être rattaché au bon bloc| {panel:bgColor=#e3fcef}
*Contexte* : Un audit a été réalisé sur l’IHMC concernant le respect des règlementations d’accessibilité RGAA et les conclusions de cet audit ont mis en évidence plusieurs axes d’amélioration pour faire progresser la note d’accessibilité du site.

L’une des évolutions recommandées concerne la présence d’une étiquette sur chaque champ de formulaire. En effet on remarque que ces étiquettes sont souvent absentes ou que le libellé n’est pas techniquement bien rattaché au champ correspondant. Une étude [https://comutitres.atlassian.net/browse/SIG-12951|https://comutitres.atlassian.net/browse/SIG-12951|smart-link] a donc été réalisée pour déterminer les pages impactées ainsi qu’une solution pour corriger le problème. La présente US a pour but de mettre en œuvre cette solution.
{panel}

{panel:bgColor=#deebff}
*Besoin* : En tant qu’utilisateur de l’IHMC, je souhaite que soit ajoutés des labels pour les champs des formulaires et que les labels des champs mal renseignés soient corrigés, afin d’améliorer la note RGAA du site.
{panel}

{panel:bgColor=#ffebe6}
*Prérequis* : 
{panel}

h2. Exigences : 

||*Référence*||*Type*||*Exigences*||
|13225_1|Fonctionnelle|Pour chacune des pages de l’IHMC ci-dessous, il faut remplacer lorsqu’elles sont présentes, les balises <div> liées aux champs de formulaires par des <label>|
|13225_2|Fonctionnelle|Pour chacune des pages de l’IHMC ci-dessous, s’il n’y a ni de balise <div>, ni de balise <label> rattachée à un champ de formulaire, alors il faut rajouter une balise <label>|
|13225_3|Fonctionnelle|Pour chacune des pages de l’IHMC ci-dessous, pour chaque balise <label> présente ou nouvellement ajoutée, il faut ajouter si elle n’est pas présente, un attribut propriété ID “for” pour la rattacher au champ de formulaire adéquat|

Pages IHMC concernées : 

|{color:#ff5630}IHMC-CON-001 - Rechercher un contrat commercial{color}|
|{color:#ff5630}IHMC-CON-002 - Recherche avancée un contrat commercial{color}|
|{color:#ff5630}IHMC-CON-105 - Saisir un contrat commercial{color}|
|{color:#ff5630}IHMC-CON-106 - Saisir un contrat commercial{color}|
|{color:#ff5630}IHMC-CON-120 - Changer de porteur{color}|
|{color:#ff5630}IHMC-CON-130 - Reconduire un contrat commercial{color}|
|{color:#ff5630}IHMC-CON-150 - Reprendre un contrat de transport{color}|
|{color:#ff5630}IHMC-CON-200 - Demander changement de zones{color}|
|{color:#ff5630}IHMC-CON-220 - Demander la résiliation du contrat commercial{color}|
|{color:#ff5630}IHMC-CON-230 - Enregistrer la résiliation du contrat commercial{color}|
|IHMC-CON-240 - Résilier un contrat commercial à l'initiative de Comutitres|
|IHMC-CON-242 - Résilier un contrat commercial à l'initiative du gestionnaire|
|IHMC-CON-244 - Résilier un contrat commercial à l'initiative d'un transporteur|
|IHMC-CON-280 - Affecter un contrat tiers payant|
|IHMC-CON-285 - Annuler l'affectation  d'un contrat tiers payant|
|IHMC-CON-290 - Saisie d'une réduction|
|IHMC-CON-291 - Demander une réduction|
|IHMC-CON-300 - réévaluer subvention|
|IHMC-CON-305 - Enregistrer la réponse à une subvention|
|IHMC-CON-320 - Suspendre un contrat commercial non reconduit|
|IHMC-CON-321 - Clôturer un contrat commercial|
|IHMC-CON-330 - Changer de payeur|
|IHMC-CON-335 - Changer de domiciliation bancaire|
|IHMC-CON-340 - Changer de mode de paiement|
|IHMC-CON-380 - Enregistrer une demande de remboursement|
|IHMC-CON-385 - Enregistrer un geste commercial|
|IHMC-CON-390 - Demander un remboursement|
|IHMC-CON-405 - Saisie d'un paiement comptant|
|IHMC-CON-410- Enregistrer un encaissement comptant hors opération vente|
|IHMC-CON-415- Enregistrer un paiement comptant invalide|
|IHMC-CON-420- Enregistrer un impayé|
|IHMC-CON-430- Enregistrer un rejet de virement|
|IHMC-CON-441- Annuler une régularisation financière|
|IHMC-CON-445- Enregistrer une réclamation|
|IHMC-CON-490- Ajout d'une action manuelle sur un contrat commercial|
|IHMC-CON-500- édition manuelle d'un courrier pour un contrat commercial|

En {color:#ff5630}rouge{color} le pages à tester",0,2
nan,0,1
